(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com
 * @author stewdio / http://stewd.io
 */

THREE.ViveController = function ( id ) {

	THREE.Object3D.call( this );

	var scope = this;
	var gamepad;

	var axes = [ 0, 0 ];
	var thumbpadIsPressed = false;
	var triggerIsPressed = false;
	var gripsArePressed = false;
	var menuIsPressed = false;

	function findGamepad( id ) {

		// Iterate across gamepads as Vive Controllers may not be
		// in position 0 and 1.

		var gamepads = navigator.getGamepads();

		for ( var i = 0, j = 0; i < 4; i ++ ) {

			var gamepad = gamepads[ i ];

			if ( gamepad && gamepad.id === 'OpenVR Gamepad' ) {

				if ( j === id ) return gamepad;

				j ++;

			}

		}

	}

	this.matrixAutoUpdate = false;
	this.standingMatrix = new THREE.Matrix4();

	this.getGamepad = function () {

		return gamepad;

	};

	this.getButtonState = function ( button ) {

		if ( button === 'thumbpad' ) return thumbpadIsPressed;
		if ( button === 'trigger' ) return triggerIsPressed;
		if ( button === 'grips' ) return gripsArePressed;
		if ( button === 'menu' ) return menuIsPressed;

	};

	this.update = function () {

		gamepad = findGamepad( id );

		if ( gamepad !== undefined && gamepad.pose !== null ) {

			//  Position and orientation.

			var pose = gamepad.pose;

			if ( pose.position !== null ) scope.position.fromArray( pose.position );
			if ( pose.orientation !== null ) scope.quaternion.fromArray( pose.orientation );
			scope.matrix.compose( scope.position, scope.quaternion, scope.scale );
			scope.matrix.multiplyMatrices( scope.standingMatrix, scope.matrix );
			scope.matrixWorldNeedsUpdate = true;
			scope.visible = true;

			//  Thumbpad and Buttons.

			if ( axes[ 0 ] !== gamepad.axes[ 0 ] || axes[ 1 ] !== gamepad.axes[ 1 ] ) {

				axes[ 0 ] = gamepad.axes[ 0 ]; //  X axis: -1 = Left, +1 = Right.
				axes[ 1 ] = gamepad.axes[ 1 ]; //  Y axis: -1 = Bottom, +1 = Top.
				scope.dispatchEvent( { type: 'axischanged', axes: axes } );

			}

			if ( thumbpadIsPressed !== gamepad.buttons[ 0 ].pressed ) {

				thumbpadIsPressed = gamepad.buttons[ 0 ].pressed;
				scope.dispatchEvent( { type: thumbpadIsPressed ? 'thumbpaddown' : 'thumbpadup' } );

			}

			if ( triggerIsPressed !== gamepad.buttons[ 1 ].pressed ) {

				triggerIsPressed = gamepad.buttons[ 1 ].pressed;
				scope.dispatchEvent( { type: triggerIsPressed ? 'triggerdown' : 'triggerup' } );

			}

			if ( gripsArePressed !== gamepad.buttons[ 2 ].pressed ) {

				gripsArePressed = gamepad.buttons[ 2 ].pressed;
				scope.dispatchEvent( { type: gripsArePressed ? 'gripsdown' : 'gripsup' } );

			}

			if ( menuIsPressed !== gamepad.buttons[ 3 ].pressed ) {

				menuIsPressed = gamepad.buttons[ 3 ].pressed;
				scope.dispatchEvent( { type: menuIsPressed ? 'menudown' : 'menuup' } );

			}

		} else {

			scope.visible = false;

		}

	};

};

THREE.ViveController.prototype = Object.create( THREE.Object3D.prototype );
THREE.ViveController.prototype.constructor = THREE.ViveController;

},{}],2:[function(require,module,exports){
/**
 * @author dmarcos / https://github.com/dmarcos
 * @author mrdoob / http://mrdoob.com
 */

THREE.VRControls = function ( object, onError ) {

	var scope = this;

	var vrDisplay, vrDisplays;

	var standingMatrix = new THREE.Matrix4();

	var frameData = null;
	if ( 'VRFrameData' in window ) {
		frameData = new VRFrameData();
	}

	function gotVRDisplays( displays ) {

		vrDisplays = displays;

		if ( displays.length > 0 ) {

			vrDisplay = displays[ 0 ];

		} else {

			if ( onError ) onError( 'VR input not available.' );

		}

	}

	if ( navigator.getVRDisplays ) {

		navigator.getVRDisplays().then( gotVRDisplays );

	}

	// the Rift SDK returns the position in meters
	// this scale factor allows the user to define how meters
	// are converted to scene units.

	this.scale = 1;

	// If true will use "standing space" coordinate system where y=0 is the
	// floor and x=0, z=0 is the center of the room.
	this.standing = false;

	// Distance from the users eyes to the floor in meters. Used when
	// standing=true but the VRDisplay doesn't provide stageParameters.
	this.userHeight = 1.6;

	this.getVRDisplay = function () {

		return vrDisplay;

	};

	this.getVRDisplays = function () {

		return vrDisplays;

	};

	this.getStandingMatrix = function () {

		return standingMatrix;

	};

	this.update = function () {

		if ( vrDisplay ) {

			var pose;

			if ( vrDisplay.getFrameData ) {

				vrDisplay.getFrameData( frameData );
				pose = frameData.pose;

			} else if ( vrDisplay.getPose ) {

				pose = vrDisplay.getPose();

			}

			if ( pose.orientation !== null ) {

				object.quaternion.fromArray( pose.orientation );

			}

			if ( pose.position !== null ) {

				object.position.fromArray( pose.position );

			} else {

				object.position.set( 0, 0, 0 );

			}

			if ( this.standing ) {

				if ( vrDisplay.stageParameters ) {

					object.updateMatrix();

					standingMatrix.fromArray( vrDisplay.stageParameters.sittingToStandingTransform );
					object.applyMatrix( standingMatrix );

				} else {

					object.position.setY( object.position.y + this.userHeight );

				}

			}

			object.position.multiplyScalar( scope.scale );

		}

	};

	this.resetPose = function () {

		if ( vrDisplay ) {

			vrDisplay.resetPose();

		}

	};

	this.resetSensor = function () {

		console.warn( 'THREE.VRControls: .resetSensor() is now .resetPose().' );
		this.resetPose();

	};

	this.zeroSensor = function () {

		console.warn( 'THREE.VRControls: .zeroSensor() is now .resetPose().' );
		this.resetPose();

	};

	this.dispose = function () {

		vrDisplay = null;

	};

};

},{}],3:[function(require,module,exports){
/**
 * @author dmarcos / https://github.com/dmarcos
 * @author mrdoob / http://mrdoob.com
 *
 * WebVR Spec: http://mozvr.github.io/webvr-spec/webvr.html
 *
 * Firefox: http://mozvr.com/downloads/
 * Chromium: https://webvr.info/get-chrome
 *
 */

THREE.VREffect = function ( renderer, onError ) {

	var vrDisplay, vrDisplays;
	var eyeTranslationL = new THREE.Vector3();
	var eyeTranslationR = new THREE.Vector3();
	var renderRectL, renderRectR;

	var frameData = null;
	if ( 'VRFrameData' in window ) {

		frameData = new VRFrameData();

	}

	function gotVRDisplays( displays ) {

		vrDisplays = displays;

		if ( displays.length > 0 ) {

			vrDisplay = displays[ 0 ];

		} else {

			if ( onError ) onError( 'HMD not available' );

		}

	}

	if ( navigator.getVRDisplays ) {

		navigator.getVRDisplays().then( gotVRDisplays );

	}

	//

	this.isPresenting = false;
	this.scale = 1;

	var scope = this;

	var rendererSize = renderer.getSize();
	var rendererUpdateStyle = false;
	var rendererPixelRatio = renderer.getPixelRatio();

	this.getVRDisplay = function () {

		return vrDisplay;

	};

	this.getVRDisplays = function () {

		return vrDisplays;

	};

	this.setSize = function ( width, height, updateStyle ) {

		rendererSize = { width: width, height: height };
		rendererUpdateStyle = updateStyle;

		if ( scope.isPresenting ) {

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			renderer.setPixelRatio( 1 );
			renderer.setSize( eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false );

		} else {

			renderer.setPixelRatio( rendererPixelRatio );
			renderer.setSize( width, height, updateStyle );

		}

	};

	// fullscreen

	var canvas = renderer.domElement;
	var requestFullscreen;
	var exitFullscreen;
	var fullscreenElement;
	var leftBounds = [ 0.0, 0.0, 0.5, 1.0 ];
	var rightBounds = [ 0.5, 0.0, 0.5, 1.0 ];

	function onFullscreenChange() {

		var wasPresenting = scope.isPresenting;
		scope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;

		if ( scope.isPresenting ) {

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			var eyeWidth = eyeParamsL.renderWidth;
			var eyeHeight = eyeParamsL.renderHeight;

			var layers = vrDisplay.getLayers();
			if ( layers.length ) {

				var layer = layers[0];

				leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : [ 0.0, 0.0, 0.5, 1.0 ];
				rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : [ 0.5, 0.0, 0.5, 1.0 ];

			}

			if ( !wasPresenting ) {

				rendererPixelRatio = renderer.getPixelRatio();
				rendererSize = renderer.getSize();

				renderer.setPixelRatio( 1 );
				renderer.setSize( eyeWidth * 2, eyeHeight, false );

			}

		} else if ( wasPresenting ) {

			renderer.setPixelRatio( rendererPixelRatio );
			renderer.setSize( rendererSize.width, rendererSize.height, rendererUpdateStyle );

		}

	}

	window.addEventListener( 'vrdisplaypresentchange', onFullscreenChange, false );

	this.setFullScreen = function ( boolean ) {

		return new Promise( function ( resolve, reject ) {

			if ( vrDisplay === undefined ) {

				reject( new Error( 'No VR hardware found.' ) );
				return;

			}

			if ( scope.isPresenting === boolean ) {

				resolve();
				return;

			}

			if ( boolean ) {

				resolve( vrDisplay.requestPresent( [ { source: canvas } ] ) );

			} else {

				resolve( vrDisplay.exitPresent() );

			}

		} );

	};

	this.requestPresent = function () {

		return this.setFullScreen( true );

	};

	this.exitPresent = function () {

		return this.setFullScreen( false );

	};

	this.requestAnimationFrame = function ( f ) {

		if ( vrDisplay !== undefined ) {

			return vrDisplay.requestAnimationFrame( f );

		} else {

			return window.requestAnimationFrame( f );

		}

	};

	this.cancelAnimationFrame = function ( h ) {

		if ( vrDisplay !== undefined ) {

			vrDisplay.cancelAnimationFrame( h );

		} else {

			window.cancelAnimationFrame( h );

		}

	};

	this.submitFrame = function () {

		if ( vrDisplay !== undefined && scope.isPresenting ) {

			vrDisplay.submitFrame();

		}

	};

	this.autoSubmitFrame = true;

	// render

	var cameraL = new THREE.PerspectiveCamera();
	cameraL.layers.enable( 1 );

	var cameraR = new THREE.PerspectiveCamera();
	cameraR.layers.enable( 2 );

	this.render = function ( scene, camera, renderTarget, forceClear ) {

		if ( vrDisplay && scope.isPresenting ) {

			var autoUpdate = scene.autoUpdate;

			if ( autoUpdate ) {

				scene.updateMatrixWorld();
				scene.autoUpdate = false;

			}

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			var eyeParamsR = vrDisplay.getEyeParameters( 'right' );

			eyeTranslationL.fromArray( eyeParamsL.offset );
			eyeTranslationR.fromArray( eyeParamsR.offset );

			if ( Array.isArray( scene ) ) {

				console.warn( 'THREE.VREffect.render() no longer supports arrays. Use object.layers instead.' );
				scene = scene[ 0 ];

			}

			// When rendering we don't care what the recommended size is, only what the actual size
			// of the backbuffer is.
			var size = renderer.getSize();
			renderRectL = {
				x: Math.round( size.width * leftBounds[ 0 ] ),
				y: Math.round( size.height * leftBounds[ 1 ] ),
				width: Math.round( size.width * leftBounds[ 2 ] ),
				height:  Math.round(size.height * leftBounds[ 3 ] )
			};
			renderRectR = {
				x: Math.round( size.width * rightBounds[ 0 ] ),
				y: Math.round( size.height * rightBounds[ 1 ] ),
				width: Math.round( size.width * rightBounds[ 2 ] ),
				height:  Math.round(size.height * rightBounds[ 3 ] )
			};

			if ( renderTarget ) {

				renderer.setRenderTarget( renderTarget );
				renderTarget.scissorTest = true;

			} else  {

				renderer.setScissorTest( true );

			}

			if ( renderer.autoClear || forceClear ) renderer.clear();

			if ( camera.parent === null ) camera.updateMatrixWorld();

			camera.matrixWorld.decompose( cameraL.position, cameraL.quaternion, cameraL.scale );
			camera.matrixWorld.decompose( cameraR.position, cameraR.quaternion, cameraR.scale );

			var scale = this.scale;
			cameraL.translateOnAxis( eyeTranslationL, scale );
			cameraR.translateOnAxis( eyeTranslationR, scale );

			if ( vrDisplay.getFrameData ) {

				vrDisplay.depthNear = camera.near;
				vrDisplay.depthFar = camera.far;

				vrDisplay.getFrameData( frameData );

				cameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;
				cameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;

			} else {

				cameraL.projectionMatrix = fovToProjection( eyeParamsL.fieldOfView, true, camera.near, camera.far );
				cameraR.projectionMatrix = fovToProjection( eyeParamsR.fieldOfView, true, camera.near, camera.far );

				
			}

			// render left eye
			if ( renderTarget ) {

				renderTarget.viewport.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );
				renderTarget.scissor.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );

			} else {

				renderer.setViewport( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );
				renderer.setScissor( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );

			}
			renderer.render( scene, cameraL, renderTarget, forceClear );

			// render right eye
			if ( renderTarget ) {

				renderTarget.viewport.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );
				renderTarget.scissor.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );

			} else {

				renderer.setViewport( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );
				renderer.setScissor( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );

			}
			renderer.render( scene, cameraR, renderTarget, forceClear );

			if ( renderTarget ) {

				renderTarget.viewport.set( 0, 0, size.width, size.height );
				renderTarget.scissor.set( 0, 0, size.width, size.height );
				renderTarget.scissorTest = false;
				renderer.setRenderTarget( null );

			} else {

				renderer.setScissorTest( false );

			}

			if ( autoUpdate ) {

				scene.autoUpdate = true;

			}

			if ( scope.autoSubmitFrame ) {

				scope.submitFrame();

			}

			return;

		}

		// Regular render mode if not HMD

		renderer.render( scene, camera, renderTarget, forceClear );

	};

	//

	function fovToNDCScaleOffset( fov ) {

		var pxscale = 2.0 / ( fov.leftTan + fov.rightTan );
		var pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;
		var pyscale = 2.0 / ( fov.upTan + fov.downTan );
		var pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;
		return { scale: [ pxscale, pyscale ], offset: [ pxoffset, pyoffset ] };

	}

	function fovPortToProjection( fov, rightHanded, zNear, zFar ) {

		rightHanded = rightHanded === undefined ? true : rightHanded;
		zNear = zNear === undefined ? 0.01 : zNear;
		zFar = zFar === undefined ? 10000.0 : zFar;

		var handednessScale = rightHanded ? - 1.0 : 1.0;

		// start with an identity matrix
		var mobj = new THREE.Matrix4();
		var m = mobj.elements;

		// and with scale/offset info for normalized device coords
		var scaleAndOffset = fovToNDCScaleOffset( fov );

		// X result, map clip edges to [-w,+w]
		m[ 0 * 4 + 0 ] = scaleAndOffset.scale[ 0 ];
		m[ 0 * 4 + 1 ] = 0.0;
		m[ 0 * 4 + 2 ] = scaleAndOffset.offset[ 0 ] * handednessScale;
		m[ 0 * 4 + 3 ] = 0.0;

		// Y result, map clip edges to [-w,+w]
		// Y offset is negated because this proj matrix transforms from world coords with Y=up,
		// but the NDC scaling has Y=down (thanks D3D?)
		m[ 1 * 4 + 0 ] = 0.0;
		m[ 1 * 4 + 1 ] = scaleAndOffset.scale[ 1 ];
		m[ 1 * 4 + 2 ] = - scaleAndOffset.offset[ 1 ] * handednessScale;
		m[ 1 * 4 + 3 ] = 0.0;

		// Z result (up to the app)
		m[ 2 * 4 + 0 ] = 0.0;
		m[ 2 * 4 + 1 ] = 0.0;
		m[ 2 * 4 + 2 ] = zFar / ( zNear - zFar ) * - handednessScale;
		m[ 2 * 4 + 3 ] = ( zFar * zNear ) / ( zNear - zFar );

		// W result (= Z in)
		m[ 3 * 4 + 0 ] = 0.0;
		m[ 3 * 4 + 1 ] = 0.0;
		m[ 3 * 4 + 2 ] = handednessScale;
		m[ 3 * 4 + 3 ] = 0.0;

		mobj.transpose();

		return mobj;

	}

	function fovToProjection( fov, rightHanded, zNear, zFar ) {

		var DEG2RAD = Math.PI / 180.0;

		var fovPort = {
			upTan: Math.tan( fov.upDegrees * DEG2RAD ),
			downTan: Math.tan( fov.downDegrees * DEG2RAD ),
			leftTan: Math.tan( fov.leftDegrees * DEG2RAD ),
			rightTan: Math.tan( fov.rightDegrees * DEG2RAD )
		};

		return fovPortToProjection( fovPort, rightHanded, zNear, zFar );

	}

};

},{}],4:[function(require,module,exports){
(function (global){
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.WebVRManager = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
/*
 * Copyright 2015 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var Emitter = _dereq_('./emitter.js');
var Modes = _dereq_('./modes.js');
var Util = _dereq_('./util.js');

/**
 * Everything having to do with the WebVR button.
 * Emits a 'click' event when it's clicked.
 */
function ButtonManager(opt_root) {
  var root = opt_root || document.body;
  this.loadIcons_();

  // Make the fullscreen button.
  var fsButton = this.createButton();
  fsButton.src = this.ICONS.fullscreen;
  fsButton.title = 'Fullscreen mode';
  var s = fsButton.style;
  s.bottom = 0;
  s.right = 0;
  fsButton.addEventListener('click', this.createClickHandler_('fs'));
  root.appendChild(fsButton);
  this.fsButton = fsButton;

  // Make the VR button.
  var vrButton = this.createButton();
  vrButton.src = this.ICONS.cardboard;
  vrButton.title = 'Virtual reality mode';
  var s = vrButton.style;
  s.bottom = 0;
  s.right = '48px';
  vrButton.addEventListener('click', this.createClickHandler_('vr'));
  root.appendChild(vrButton);
  this.vrButton = vrButton;

  this.isVisible = true;

}
ButtonManager.prototype = new Emitter();

ButtonManager.prototype.createButton = function() {
  var button = document.createElement('img');
  button.className = 'webvr-button';
  var s = button.style;
  s.position = 'absolute';
  s.width = '24px'
  s.height = '24px';
  s.backgroundSize = 'cover';
  s.backgroundColor = 'transparent';
  s.border = 0;
  s.userSelect = 'none';
  s.webkitUserSelect = 'none';
  s.MozUserSelect = 'none';
  s.cursor = 'pointer';
  s.padding = '12px';
  s.zIndex = 1;
  s.display = 'none';
  s.boxSizing = 'content-box';

  // Prevent button from being selected and dragged.
  button.draggable = false;
  button.addEventListener('dragstart', function(e) {
    e.preventDefault();
  });

  // Style it on hover.
  button.addEventListener('mouseenter', function(e) {
    s.filter = s.webkitFilter = 'drop-shadow(0 0 5px rgba(255,255,255,1))';
  });
  button.addEventListener('mouseleave', function(e) {
    s.filter = s.webkitFilter = '';
  });
  return button;
};

ButtonManager.prototype.setMode = function(mode, isVRCompatible) {
  isVRCompatible = isVRCompatible || WebVRConfig.FORCE_ENABLE_VR;
  if (!this.isVisible) {
    return;
  }
  switch (mode) {
    case Modes.NORMAL:
      this.fsButton.style.display = 'block';
      this.fsButton.src = this.ICONS.fullscreen;
      this.vrButton.style.display = (isVRCompatible ? 'block' : 'none');
      break;
    case Modes.MAGIC_WINDOW:
      this.fsButton.style.display = 'block';
      this.fsButton.src = this.ICONS.exitFullscreen;
      this.vrButton.style.display = 'none';
      break;
    case Modes.VR:
      this.fsButton.style.display = 'none';
      this.vrButton.style.display = 'none';
      break;
  }

  // Hack for Safari Mac/iOS to force relayout (svg-specific issue)
  // http://goo.gl/hjgR6r
  var oldValue = this.fsButton.style.display;
  this.fsButton.style.display = 'inline-block';
  this.fsButton.offsetHeight;
  this.fsButton.style.display = oldValue;
};

ButtonManager.prototype.setVisibility = function(isVisible) {
  this.isVisible = isVisible;
  this.fsButton.style.display = isVisible ? 'block' : 'none';
  this.vrButton.style.display = isVisible ? 'block' : 'none';
};

ButtonManager.prototype.createClickHandler_ = function(eventName) {
  return function(e) {
    e.stopPropagation();
    e.preventDefault();
    this.emit(eventName);
  }.bind(this);
};

ButtonManager.prototype.loadIcons_ = function() {
  // Preload some hard-coded SVG.
  this.ICONS = {};
  this.ICONS.cardboard = Util.base64('image/svg+xml', 'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMjAuNzQgNkgzLjIxQzIuNTUgNiAyIDYuNTcgMiA3LjI4djEwLjQ0YzAgLjcuNTUgMS4yOCAxLjIzIDEuMjhoNC43OWMuNTIgMCAuOTYtLjMzIDEuMTQtLjc5bDEuNC0zLjQ4Yy4yMy0uNTkuNzktMS4wMSAxLjQ0LTEuMDFzMS4yMS40MiAxLjQ1IDEuMDFsMS4zOSAzLjQ4Yy4xOS40Ni42My43OSAxLjExLjc5aDQuNzljLjcxIDAgMS4yNi0uNTcgMS4yNi0xLjI4VjcuMjhjMC0uNy0uNTUtMS4yOC0xLjI2LTEuMjh6TTcuNSAxNC42MmMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTMgMS4xOCAwIDIuMTIuOTYgMi4xMiAyLjEzcy0uOTUgMi4xMi0yLjEyIDIuMTJ6bTkgMGMtMS4xNyAwLTIuMTMtLjk1LTIuMTMtMi4xMiAwLTEuMTcuOTYtMi4xMyAyLjEzLTIuMTNzMi4xMi45NiAyLjEyIDIuMTMtLjk1IDIuMTItMi4xMiAyLjEyeiIvPgogICAgPHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgwVjB6Ii8+Cjwvc3ZnPgo=');
  this.ICONS.fullscreen = Util.base64('image/svg+xml', 'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNyAxNEg1djVoNXYtMkg3di0zem0tMi00aDJWN2gzVjVINXY1em0xMiA3aC0zdjJoNXYtNWgtMnYzek0xNCA1djJoM3YzaDJWNWgtNXoiLz4KPC9zdmc+Cg==');
  this.ICONS.exitFullscreen = Util.base64('image/svg+xml', 'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNNSAxNmgzdjNoMnYtNUg1djJ6bTMtOEg1djJoNVY1SDh2M3ptNiAxMWgydi0zaDN2LTJoLTV2NXptMi0xMVY1aC0ydjVoNVY4aC0zeiIvPgo8L3N2Zz4K');
  this.ICONS.settings = Util.base64('image/svg+xml', 'PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNHB4IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iI0ZGRkZGRiI+CiAgICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgICA8cGF0aCBkPSJNMTkuNDMgMTIuOThjLjA0LS4zMi4wNy0uNjQuMDctLjk4cy0uMDMtLjY2LS4wNy0uOThsMi4xMS0xLjY1Yy4xOS0uMTUuMjQtLjQyLjEyLS42NGwtMi0zLjQ2Yy0uMTItLjIyLS4zOS0uMy0uNjEtLjIybC0yLjQ5IDFjLS41Mi0uNC0xLjA4LS43My0xLjY5LS45OGwtLjM4LTIuNjVDMTQuNDYgMi4xOCAxNC4yNSAyIDE0IDJoLTRjLS4yNSAwLS40Ni4xOC0uNDkuNDJsLS4zOCAyLjY1Yy0uNjEuMjUtMS4xNy41OS0xLjY5Ljk4bC0yLjQ5LTFjLS4yMy0uMDktLjQ5IDAtLjYxLjIybC0yIDMuNDZjLS4xMy4yMi0uMDcuNDkuMTIuNjRsMi4xMSAxLjY1Yy0uMDQuMzItLjA3LjY1LS4wNy45OHMuMDMuNjYuMDcuOThsLTIuMTEgMS42NWMtLjE5LjE1LS4yNC40Mi0uMTIuNjRsMiAzLjQ2Yy4xMi4yMi4zOS4zLjYxLjIybDIuNDktMWMuNTIuNCAxLjA4LjczIDEuNjkuOThsLjM4IDIuNjVjLjAzLjI0LjI0LjQyLjQ5LjQyaDRjLjI1IDAgLjQ2LS4xOC40OS0uNDJsLjM4LTIuNjVjLjYxLS4yNSAxLjE3LS41OSAxLjY5LS45OGwyLjQ5IDFjLjIzLjA5LjQ5IDAgLjYxLS4yMmwyLTMuNDZjLjEyLS4yMi4wNy0uNDktLjEyLS42NGwtMi4xMS0xLjY1ek0xMiAxNS41Yy0xLjkzIDAtMy41LTEuNTctMy41LTMuNXMxLjU3LTMuNSAzLjUtMy41IDMuNSAxLjU3IDMuNSAzLjUtMS41NyAzLjUtMy41IDMuNXoiLz4KPC9zdmc+Cg==');
};

module.exports = ButtonManager;

},{"./emitter.js":2,"./modes.js":3,"./util.js":4}],2:[function(_dereq_,module,exports){
/*
 * Copyright 2015 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

function Emitter() {
  this.callbacks = {};
}

Emitter.prototype.emit = function(eventName) {
  var callbacks = this.callbacks[eventName];
  if (!callbacks) {
    //console.log('No valid callback specified.');
    return;
  }
  var args = [].slice.call(arguments);
  // Eliminate the first param (the callback).
  args.shift();
  for (var i = 0; i < callbacks.length; i++) {
    callbacks[i].apply(this, args);
  }
};

Emitter.prototype.on = function(eventName, callback) {
  if (eventName in this.callbacks) {
    this.callbacks[eventName].push(callback);
  } else {
    this.callbacks[eventName] = [callback];
  }
};

module.exports = Emitter;

},{}],3:[function(_dereq_,module,exports){
/*
 * Copyright 2015 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var Modes = {
  UNKNOWN: 0,
  // Not fullscreen, just tracking.
  NORMAL: 1,
  // Magic window immersive mode.
  MAGIC_WINDOW: 2,
  // Full screen split screen VR mode.
  VR: 3,
};

module.exports = Modes;

},{}],4:[function(_dereq_,module,exports){
/*
 * Copyright 2015 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var Util = {};

Util.base64 = function(mimeType, base64) {
  return 'data:' + mimeType + ';base64,' + base64;
};

Util.isMobile = function() {
  var check = false;
  (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
  return check;
};

Util.isFirefox = function() {
  return /firefox/i.test(navigator.userAgent);
};

Util.isIOS = function() {
  return /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
};

Util.isIFrame = function() {
  try {
    return window.self !== window.top;
  } catch (e) {
    return true;
  }
};

Util.appendQueryParameter = function(url, key, value) {
  // Determine delimiter based on if the URL already GET parameters in it.
  var delimiter = (url.indexOf('?') < 0 ? '?' : '&');
  url += delimiter + key + '=' + value;
  return url;
};

// From http://goo.gl/4WX3tg
Util.getQueryParameter = function(name) {
  var name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
  var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
      results = regex.exec(location.search);
  return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
};

Util.isLandscapeMode = function() {
  return (window.orientation == 90 || window.orientation == -90);
};

Util.getScreenWidth = function() {
  return Math.max(window.screen.width, window.screen.height) *
      window.devicePixelRatio;
};

Util.getScreenHeight = function() {
  return Math.min(window.screen.width, window.screen.height) *
      window.devicePixelRatio;
};

module.exports = Util;

},{}],5:[function(_dereq_,module,exports){
/*
 * Copyright 2015 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

var ButtonManager = _dereq_('./button-manager.js');
var Emitter = _dereq_('./emitter.js');
var Modes = _dereq_('./modes.js');
var Util = _dereq_('./util.js');

/**
 * Helper for getting in and out of VR mode.
 */
function WebVRManager(renderer, effect, params) {
  this.params = params || {};

  this.mode = Modes.UNKNOWN;

  // Set option to hide the button.
  this.hideButton = this.params.hideButton || false;
  // Whether or not the FOV should be distorted or un-distorted. By default, it
  // should be distorted, but in the case of vertex shader based distortion,
  // ensure that we use undistorted parameters.
  this.predistorted = !!this.params.predistorted;

  // Save the THREE.js renderer and effect for later.
  this.renderer = renderer;
  this.effect = effect;
  var polyfillWrapper = document.querySelector('.webvr-polyfill-fullscreen-wrapper');
  this.button = new ButtonManager(polyfillWrapper);

  this.isFullscreenDisabled = !!Util.getQueryParameter('no_fullscreen');
  this.startMode = Modes.NORMAL;
  var startModeParam = parseInt(Util.getQueryParameter('start_mode'));
  if (!isNaN(startModeParam)) {
    this.startMode = startModeParam;
  }

  if (this.hideButton) {
    this.button.setVisibility(false);
  }

  // Check if the browser is compatible with WebVR.
  this.getDeviceByType_(VRDisplay).then(function(hmd) {
    this.hmd = hmd;

    // Only enable VR mode if there's a VR device attached or we are running the
    // polyfill on mobile.
    if (!this.isVRCompatibleOverride) {
      this.isVRCompatible =  !hmd.isPolyfilled || Util.isMobile();
    }

    switch (this.startMode) {
      case Modes.MAGIC_WINDOW:
        this.setMode_(Modes.MAGIC_WINDOW);
        break;
      case Modes.VR:
        this.enterVRMode_();
        this.setMode_(Modes.VR);
        break;
      default:
        this.setMode_(Modes.NORMAL);
    }

    this.emit('initialized');
  }.bind(this));

  // Hook up button listeners.
  this.button.on('fs', this.onFSClick_.bind(this));
  this.button.on('vr', this.onVRClick_.bind(this));

  // Bind to fullscreen events.
  document.addEventListener('webkitfullscreenchange',
      this.onFullscreenChange_.bind(this));
  document.addEventListener('mozfullscreenchange',
      this.onFullscreenChange_.bind(this));
  document.addEventListener('msfullscreenchange',
      this.onFullscreenChange_.bind(this));

  // Bind to VR* specific events.
  window.addEventListener('vrdisplaypresentchange',
      this.onVRDisplayPresentChange_.bind(this));
  window.addEventListener('vrdisplaydeviceparamschange',
      this.onVRDisplayDeviceParamsChange_.bind(this));
}

WebVRManager.prototype = new Emitter();

// Expose these values externally.
WebVRManager.Modes = Modes;

WebVRManager.prototype.render = function(scene, camera, timestamp) {
  // Scene may be an array of two scenes, one for each eye.
  if (scene instanceof Array) {
    this.effect.render(scene[0], camera);
  } else {
    this.effect.render(scene, camera);
  }
};

WebVRManager.prototype.setVRCompatibleOverride = function(isVRCompatible) {
  this.isVRCompatible = isVRCompatible;
  this.isVRCompatibleOverride = true;

  // Don't actually change modes, just update the buttons.
  this.button.setMode(this.mode, this.isVRCompatible);
};

WebVRManager.prototype.setFullscreenCallback = function(callback) {
  this.fullscreenCallback = callback;
};

WebVRManager.prototype.setVRCallback = function(callback) {
  this.vrCallback = callback;
};

WebVRManager.prototype.setExitFullscreenCallback = function(callback) {
  this.exitFullscreenCallback = callback;
}

/**
 * Promise returns true if there is at least one HMD device available.
 */
WebVRManager.prototype.getDeviceByType_ = function(type) {
  return new Promise(function(resolve, reject) {
    navigator.getVRDisplays().then(function(displays) {
      // Promise succeeds, but check if there are any displays actually.
      for (var i = 0; i < displays.length; i++) {
        if (displays[i] instanceof type) {
          resolve(displays[i]);
          break;
        }
      }
      resolve(null);
    }, function() {
      // No displays are found.
      resolve(null);
    });
  });
};

/**
 * Helper for entering VR mode.
 */
WebVRManager.prototype.enterVRMode_ = function() {
  this.hmd.requestPresent([{
    source: this.renderer.domElement,
    predistorted: this.predistorted
  }]);
};

WebVRManager.prototype.setMode_ = function(mode) {
  var oldMode = this.mode;
  if (mode == this.mode) {
    console.warn('Not changing modes, already in %s', mode);
    return;
  }
  // console.log('Mode change: %s => %s', this.mode, mode);
  this.mode = mode;
  this.button.setMode(mode, this.isVRCompatible);

  // Emit an event indicating the mode changed.
  this.emit('modechange', mode, oldMode);
};

/**
 * Main button was clicked.
 */
WebVRManager.prototype.onFSClick_ = function() {
  switch (this.mode) {
    case Modes.NORMAL:
      // TODO: Remove this hack if/when iOS gets real fullscreen mode.
      // If this is an iframe on iOS, break out and open in no_fullscreen mode.
      if (Util.isIOS() && Util.isIFrame()) {
        if (this.fullscreenCallback) {
          this.fullscreenCallback();
        } else {
          var url = window.location.href;
          url = Util.appendQueryParameter(url, 'no_fullscreen', 'true');
          url = Util.appendQueryParameter(url, 'start_mode', Modes.MAGIC_WINDOW);
          top.location.href = url;
          return;
        }
      }
      this.setMode_(Modes.MAGIC_WINDOW);
      this.requestFullscreen_();
      break;
    case Modes.MAGIC_WINDOW:
      if (this.isFullscreenDisabled) {
        window.history.back();
        return;
      }
      if (this.exitFullscreenCallback) {
        this.exitFullscreenCallback();
      }
      this.setMode_(Modes.NORMAL);
      this.exitFullscreen_();
      break;
  }
};

/**
 * The VR button was clicked.
 */
WebVRManager.prototype.onVRClick_ = function() {
  // TODO: Remove this hack when iOS has fullscreen mode.
  // If this is an iframe on iOS, break out and open in no_fullscreen mode.
  if (this.mode == Modes.NORMAL && Util.isIOS() && Util.isIFrame()) {
    if (this.vrCallback) {
      this.vrCallback();
    } else {
      var url = window.location.href;
      url = Util.appendQueryParameter(url, 'no_fullscreen', 'true');
      url = Util.appendQueryParameter(url, 'start_mode', Modes.VR);
      top.location.href = url;
      return;
    }
  }
  this.enterVRMode_();
};

WebVRManager.prototype.requestFullscreen_ = function() {
  var canvas = document.body;
  //var canvas = this.renderer.domElement;
  if (canvas.requestFullscreen) {
    canvas.requestFullscreen();
  } else if (canvas.mozRequestFullScreen) {
    canvas.mozRequestFullScreen();
  } else if (canvas.webkitRequestFullscreen) {
    canvas.webkitRequestFullscreen();
  } else if (canvas.msRequestFullscreen) {
    canvas.msRequestFullscreen();
  }
};

WebVRManager.prototype.exitFullscreen_ = function() {
  if (document.exitFullscreen) {
    document.exitFullscreen();
  } else if (document.mozCancelFullScreen) {
    document.mozCancelFullScreen();
  } else if (document.webkitExitFullscreen) {
    document.webkitExitFullscreen();
  } else if (document.msExitFullscreen) {
    document.msExitFullscreen();
  }
};

WebVRManager.prototype.onVRDisplayPresentChange_ = function(e) {
  console.log('onVRDisplayPresentChange_', e);
  if (this.hmd.isPresenting) {
    this.setMode_(Modes.VR);
  } else {
    this.setMode_(Modes.NORMAL);
  }
};

WebVRManager.prototype.onVRDisplayDeviceParamsChange_ = function(e) {
  console.log('onVRDisplayDeviceParamsChange_', e);
};

WebVRManager.prototype.onFullscreenChange_ = function(e) {
  // If we leave full-screen, go back to normal mode.
  if (document.webkitFullscreenElement === null ||
      document.mozFullScreenElement === null) {
    this.setMode_(Modes.NORMAL);
  }
};

module.exports = WebVRManager;

},{"./button-manager.js":1,"./emitter.js":2,"./modes.js":3,"./util.js":4}]},{},[5])(5)
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],5:[function(require,module,exports){
(function (global){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _three = (typeof window !== "undefined" ? window['THREE'] : typeof global !== "undefined" ? global['THREE'] : null);

var THREE = _interopRequireWildcard(_three);

var _colors = require('./colors');

var _colors2 = _interopRequireDefault(_colors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var AirPlane = function AirPlane() {
  _classCallCheck(this, AirPlane);

  this.mesh = new THREE.Object3D();

  // Create the cabin
  var geomCockpitTail = new THREE.BoxGeometry(130, 40, 40, 1, 1, 1);
  var matCockpitTail = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });

  // we can access a specific vertex of a shape through
  // the vertices array, and then move its x, y and z property:
  geomCockpitTail.vertices[4].y -= 10;
  geomCockpitTail.vertices[4].z += 20;
  geomCockpitTail.vertices[5].y -= 10;
  geomCockpitTail.vertices[5].z -= 20;
  geomCockpitTail.vertices[6].y += 30;
  geomCockpitTail.vertices[6].z += 20;
  geomCockpitTail.vertices[7].y += 30;
  geomCockpitTail.vertices[7].z -= 20;

  var cockpitTail = new THREE.Mesh(geomCockpitTail, matCockpitTail);
  cockpitTail.castShadow = true;
  cockpitTail.receiveShadow = true;
  cockpitTail.position.set(-75, 0, 0);
  this.mesh.add(cockpitTail);

  var geomCockpit = new THREE.BoxGeometry(40, 40, 40, 1, 1, 1);
  var matCockpit = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var cockpit = new THREE.Mesh(geomCockpit, matCockpit);
  cockpit.castShadow = true;
  cockpit.receiveShadow = true;
  cockpit.position.set(10, 0, 0);
  this.mesh.add(cockpit);

  // Create the engine
  var geomEngine = new THREE.BoxGeometry(20, 40, 40, 1, 1, 1);
  var matEngine = new THREE.MeshPhongMaterial({ color: _colors2.default.white, shading: THREE.FlatShading });
  var engine = new THREE.Mesh(geomEngine, matEngine);
  engine.position.x = 40;
  engine.castShadow = true;
  engine.receiveShadow = true;
  this.mesh.add(engine);

  // Create top wing
  var geomTopWing = new THREE.BoxGeometry(40, 2, 200, 1, 1, 1);
  var matTopWing = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var topWing = new THREE.Mesh(geomTopWing, matTopWing);
  topWing.castShadow = true;
  topWing.receiveShadow = true;
  topWing.position.set(20, 50, 0);
  this.mesh.add(topWing);

  // Create bottom wing
  var geomBottomWing = new THREE.BoxGeometry(40, 2, 200, 1, 1, 1);
  var matBottomWing = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var bottomWing = new THREE.Mesh(geomBottomWing, matBottomWing);
  bottomWing.castShadow = true;
  bottomWing.receiveShadow = true;
  bottomWing.position.set(10, -10, 0);
  this.mesh.add(bottomWing);

  // Wing support 1
  var geomWingSupport = new THREE.BoxGeometry(2, 60, 2, 1, 1, 1);
  var matWingSupport = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var wingSupportLeft = new THREE.Mesh(geomWingSupport, matWingSupport);
  wingSupportLeft.castShadow = true;
  wingSupportLeft.receiveShadow = true;
  wingSupportLeft.position.set(15, 20, -80);
  this.mesh.add(wingSupportLeft);
  var wingSupportRight = new THREE.Mesh(geomWingSupport, matWingSupport);
  wingSupportRight.castShadow = true;
  wingSupportRight.receiveShadow = true;
  wingSupportRight.position.set(15, 20, 80);
  this.mesh.add(wingSupportRight);

  // Create the tail
  var geomTailPlane = new THREE.BoxGeometry(30, 25, 2, 1, 1, 1);
  var matTailPlane = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var tailPlane = new THREE.Mesh(geomTailPlane, matTailPlane);
  tailPlane.position.set(-115, 20, 0);
  tailPlane.castShadow = true;
  tailPlane.receiveShadow = true;
  this.mesh.add(tailPlane);

  // Create the tail wing
  var geomTailWing = new THREE.BoxGeometry(20, 2, 60, 1, 1, 1);
  var matTailWing = new THREE.MeshPhongMaterial({ color: _colors2.default.airplane, shading: THREE.FlatShading });
  var tailWing = new THREE.Mesh(geomTailWing, matTailWing);
  tailWing.castShadow = true;
  tailWing.receiveShadow = true;
  tailWing.position.set(-110, 11, 0);
  this.mesh.add(tailWing);

  // propeller
  var geomPropeller = new THREE.BoxGeometry(20, 10, 10, 1, 1, 1);
  geomPropeller.vertices[4].y -= 5;
  geomPropeller.vertices[4].z += 5;
  geomPropeller.vertices[5].y -= 5;
  geomPropeller.vertices[5].z -= 5;
  geomPropeller.vertices[6].y += 5;
  geomPropeller.vertices[6].z += 5;
  geomPropeller.vertices[7].y += 5;
  geomPropeller.vertices[7].z -= 5;
  var matPropeller = new THREE.MeshPhongMaterial({ color: _colors2.default.brown, shading: THREE.FlatShading });
  this.propeller = new THREE.Mesh(geomPropeller, matPropeller);

  this.propeller.castShadow = true;
  this.propeller.receiveShadow = true;

  var geomBlade = new THREE.BoxGeometry(1, 80, 10, 1, 1, 1);
  var matBlade = new THREE.MeshPhongMaterial({ color: _colors2.default.brownDark, shading: THREE.FlatShading });
  var blade1 = new THREE.Mesh(geomBlade, matBlade);
  blade1.position.set(8, 0, 0);

  blade1.castShadow = true;
  blade1.receiveShadow = true;

  var blade2 = blade1.clone();
  blade2.rotation.x = Math.PI / 2;

  blade2.castShadow = true;
  blade2.receiveShadow = true;

  this.propeller.add(blade1);
  this.propeller.add(blade2);
  this.propeller.position.set(50, 0, 0);
  this.mesh.add(this.propeller);

  // rotate the geometry on the Y axis away from the camera
  this.mesh.applyMatrix(new THREE.Matrix4().makeRotationY(Math.PI / 2));

  // change rotation order to avoid gimbal lock
  this.mesh.rotation.order = 'ZXY';
};

exports.default = AirPlane;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./colors":7}],6:[function(require,module,exports){
(function (global){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _three = (typeof window !== "undefined" ? window['THREE'] : typeof global !== "undefined" ? global['THREE'] : null);

var THREE = _interopRequireWildcard(_three);

var _colors = require('./colors');

var _colors2 = _interopRequireDefault(_colors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Cloud = function Cloud() {
  _classCallCheck(this, Cloud);

  // Create an empty container that will hold the different parts of the cloud
  this.mesh = new THREE.Object3D();

  // create a cube geometry
  // this shape will be duplicated to create the cloud
  // const geom = new THREE.BoxGeometry(20, 20, 20)
  var geom = new THREE.SphereGeometry(20, 6, 6);

  // create a material a simple white material will do the trick
  var mat = new THREE.MeshPhongMaterial({
    color: _colors2.default.white,
    transparent: true,
    opacity: 0.9,
    shading: THREE.FlatShading
  });

  // duplicate the geometry a random number of times
  var nBlocs = 5 + Math.floor(Math.random() * 20);
  for (var i = 0; i < nBlocs; i++) {
    // create the mesh by cloning the geometry
    var m = new THREE.Mesh(geom, mat);

    // set the position and the rotation of each cube randomly
    m.position.x = i * (15 * Math.random());
    m.position.y = Math.random() * 10;
    m.position.z = Math.random() * 20;
    m.rotation.z = Math.random() * Math.PI * 2;
    m.rotation.y = Math.random() * Math.PI * 2;

    // set the size of the cube randomly
    var s = 0.2 + Math.random() * 0.8;
    m.scale.set(s, s, s);

    // allow each cube to cast and to receive shadows
    m.castShadow = true;
    m.receiveShadow = true;

    // add the cube to the container we first created
    this.mesh.add(m);
  }
};

exports.default = Cloud;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./colors":7}],7:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var Colors = {
  airplane: 0xb7d02e,
  white: 0xe8e0e1,
  brown: 0x59332e,
  brownDark: 0x23190f,
  water: 0x006457
};

exports.default = Colors;

},{}],8:[function(require,module,exports){
(function (global){
'use strict';

var _three = (typeof window !== "undefined" ? window['THREE'] : typeof global !== "undefined" ? global['THREE'] : null);

var THREE = _interopRequireWildcard(_three);

var _sky = require('./sky');

var _sky2 = _interopRequireDefault(_sky);

var _airplane = require('./airplane');

var _airplane2 = _interopRequireDefault(_airplane);

var _sea = require('./sea');

var _sea2 = _interopRequireDefault(_sea);

var _VRControls2 = require('VRControls');

var _VRControls3 = _interopRequireDefault(_VRControls2);

var _VREffect2 = require('VREffect');

var _VREffect3 = _interopRequireDefault(_VREffect2);

var _ViveController2 = require('ViveController');

var _ViveController3 = _interopRequireDefault(_ViveController2);

var _webvrBoilerplate = require('webvr-boilerplate');

var _webvrBoilerplate2 = _interopRequireDefault(_webvrBoilerplate);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

// load shimmed plugins - access on THREE namespace
var scene = void 0,
    camera = void 0,
    fieldOfView = void 0,
    aspectRatio = void 0,
    nearPlane = void 0,
    farPlane = void 0,
    HEIGHT = void 0,
    WIDTH = void 0,
    renderer = void 0,
    container = void 0,
    sea = void 0,
    controls = void 0,
    vrcontrols = void 0,
    sky = void 0,
    airplane = void 0,
    effect = void 0,
    manager = void 0,
    dollyCam = void 0,
    viveController = void 0,
    world = void 0;

var turnSpeed = 0;
var compassHeading = 0;

var mouseDragging = false;

var clock = new THREE.Clock();

var planeStartY = 200;
var planeStartZ = 0;
var cameraStartZ = 100;

var GROUND_DIAMETER = 2000;

function createScene() {
  // Get the width and the height of the screen,
  // use them to set up the aspect ratio of the camera
  // and the size of the renderer.
  HEIGHT = window.innerHeight;
  WIDTH = window.innerWidth;

  // Create the scene
  scene = new THREE.Scene();

  // Add a fog effect to the scene using similar color as background
  scene.fog = new THREE.Fog(0xc6cceb, 200, GROUND_DIAMETER / 2);

  // Create the camera
  aspectRatio = WIDTH / HEIGHT;
  fieldOfView = 60;
  nearPlane = 1;
  farPlane = 10000;
  camera = new THREE.PerspectiveCamera(fieldOfView, aspectRatio, nearPlane, farPlane);

  // Create the renderer
  renderer = new THREE.WebGLRenderer({
    // Allow transparency to show the gradient background
    // we defined in the CSS
    alpha: true,
    // Activate the anti-aliasing this is less performant,
    // but, as our project is low-poly based, it should be fine :)
    antialias: true
  });

  // Define the size of the renderer in this case,
  // it will fill the entire screen
  renderer.setSize(WIDTH, HEIGHT);

  // Enable shadow rendering
  renderer.shadowMap.enabled = true;

  // Add the DOM element of the renderer to the
  // container we created in the HTML
  container = document.getElementById('world');
  container.appendChild(renderer.domElement);

  // Listen to the screen: if the user resizes it
  // we have to update the camera and the renderer size
  window.addEventListener('resize', handleWindowResize, false);
}

function handleWindowResize() {
  // update height and width of the renderer and the camera
  HEIGHT = window.innerHeight;
  WIDTH = window.innerWidth;
  effect.setSize(WIDTH, HEIGHT);
  renderer.setSize(WIDTH, HEIGHT);
  camera.aspect = WIDTH / HEIGHT;
  camera.updateProjectionMatrix();
}

function createLights() {
  var hemisphereLight = void 0,
      shadowLight = void 0,
      ambientLight = void 0;

  // A hemisphere light is a gradient colored light
  // the first parameter is the sky color, the second parameter is the ground color,
  // the third parameter is the intensity of the light
  hemisphereLight = new THREE.HemisphereLight(0xe8caf4, 0xbbe8f7, 0.5);

  // A directional light shines from a specific direction.
  // It acts like the sun, that means that all the rays produced are parallel.
  shadowLight = new THREE.DirectionalLight(0xffffff, 0.1);

  // Set the direction of the light
  shadowLight.position.set(-150, GROUND_DIAMETER, 150);

  // Allow shadow casting
  shadowLight.castShadow = true;

  // define the visible area of the projected shadow
  shadowLight.shadow.camera.left = -1000;
  shadowLight.shadow.camera.right = 1000;
  shadowLight.shadow.camera.top = 1000;
  shadowLight.shadow.camera.bottom = -500;
  shadowLight.shadow.camera.near = -1000;
  shadowLight.shadow.camera.far = 1000;
  // debug light
  // scene.add(new THREE.CameraHelper(shadowLight.shadow.camera))

  // define the resolution of the shadow the higher the better,
  // but also the more expensive and less performant
  shadowLight.shadow.mapSize.width = 2048;
  shadowLight.shadow.mapSize.height = 2048;

  // an ambient light modifies the global color of a scene and makes the shadows softer
  ambientLight = new THREE.AmbientLight(0xe8caf4, 0.7);
  // ambientLight = new THREE.AmbientLight(0xaae8f7, 1)
  scene.add(ambientLight);

  // to activate the lights, just add them to the scene
  scene.add(hemisphereLight);
  scene.add(shadowLight);
}

// Instantiate the sea and add it to the scene:
function createSea() {
  sea = new _sea2.default(GROUND_DIAMETER);

  // push it a little bit at the bottom of the scene
  // sea.mesh.position.y = -GROUND_DIAMETER
  sea.mesh.rotation.z = Math.PI / 2;

  // add the mesh of the sea to the scene
  return sea;
}

function createSky() {
  sky = new _sky2.default(GROUND_DIAMETER);
  // sky.mesh.position.y = -GROUND_DIAMETER
  return sky;
}

function createPlane() {
  airplane = new _airplane2.default();
  airplane.mesh.scale.set(0.25, 0.25, 0.25);
  airplane.mesh.position.y = GROUND_DIAMETER + planeStartY;
  airplane.mesh.position.z = planeStartZ;
  scene.add(airplane.mesh);
}

function updateController(controller, id) {
  controller.update();
  if (controller.visible) {
    // here we are converting the Vive controller position
    // to a normalized value varying between -1 and 1;
    // var tx = controller.rotation.z
    // var ty = controller.rotation.x
    var tx = controller.position.x / 0.5;
    var ty = controller.position.y / 0.5;
    mousePos = { x: tx, y: ty, isInteractive: true };
  }
}

function loop(t) {
  if (viveController) {
    // UPDATE CONTROLLER
    updateController(viveController, 0);
  }

  if (controls) {
    controls.update(clock.getDelta());
  }
  if (vrcontrols) {
    vrcontrols.update(clock.getDelta());
  }

  // update the plane on each frame
  updatePlane();

  // move waves
  sea.moveWaves();

  // Rotate world around Y axis - in direction (heading) we are flying
  var worldHeadingMatrix = new THREE.Matrix4();
  worldHeadingMatrix.makeRotationAxis(new THREE.Vector3(0, 1, 0), turnSpeed);

  // World speed rotation matrix
  var worldSpeedMatrix = new THREE.Matrix4();
  worldSpeedMatrix.makeRotationAxis(new THREE.Vector3(1, 0, 0), 0.002);

  // apply rotation matrixes to current world roation and update
  var newWorldMatrix = new THREE.Matrix4();
  newWorldMatrix.multiply(worldHeadingMatrix);
  newWorldMatrix.multiply(worldSpeedMatrix);
  newWorldMatrix.multiply(world.matrix);
  world.matrix = newWorldMatrix;
  world.rotation.setFromRotationMatrix(world.matrix);

  // position camera inside cockpit
  // focus camera on airplane if not in VR mode
  if (manager.mode === _webvrBoilerplate.Modes.NORMAL || manager.mode === _webvrBoilerplate.Modes.UNKNOWN) {
    // camera position is set by controller handler
    dollyCam.lookAt(airplane.mesh.position);
    // Cardboard or VR mode
  } else {
    var _airplane$mesh$positi = airplane.mesh.position;
    var x = _airplane$mesh$positi.x;
    var y = _airplane$mesh$positi.y;
    var z = _airplane$mesh$positi.z;

    dollyCam.position.x = x;
    dollyCam.lookAt(dollyCam.position);
    dollyCam.position.y = y + 10;
    dollyCam.position.z = z + 5;
  }

  // render the scene
  // renderer.render(scene, camera)

  // Render the scene through the manager.
  manager.render(scene, camera, t);

  // call the loop function again
  window.requestAnimationFrame(loop);
}

function updatePlane() {
  var planeAcceleration = 0.025;
  var cameraSpeed = 0.02; // move camera slower than altitude so we see plane dive

  // rotate propeller
  airplane.propeller.rotation.x += 0.3;

  // abort flying controll if dragging camera
  if (mouseDragging) return;

  var MAX_PITCH = Math.PI / 2;
  var MIN_HEIGHT = GROUND_DIAMETER + 20;
  var MAX_HEIGHT = GROUND_DIAMETER + 800;
  var MAX_DELTA = MAX_HEIGHT - MIN_HEIGHT;

  // Modify the plane altitude at each frame by adding a fraction of the remaining distance
  var targetY = normalize(mousePos.y, -0.75, 0.75, MIN_HEIGHT, MAX_HEIGHT); // MIN_HEIGHT should be higher than waves
  var yDelta = targetY - airplane.mesh.position.y;
  airplane.mesh.position.y += yDelta * planeAcceleration;

  // Pitch the plane proportionally to the remaining distance
  var pitchAngle = MAX_PITCH * normalize(yDelta, -MAX_DELTA / 2, MAX_DELTA / 2, -1, 1);
  airplane.mesh.rotation.x += (pitchAngle - airplane.mesh.rotation.x) * 0.05;

  // Roll towards target
  var rollAngle = normalize(mousePos.x, -0.75, 0.75, Math.PI / 4, -Math.PI / 4);
  airplane.mesh.rotation.z = (rollAngle + airplane.mesh.rotation.z) * 0.5;

  // Move camera to follow plane
  var cameraY = normalize(mousePos.y, -0.75, 0.75, GROUND_DIAMETER + 40, GROUND_DIAMETER + 850);

  // zoom in close to water - zoom out high up in air
  var cameraZoom = 50;
  var cameraZ = normalize(mousePos.y, -0.75, 0.75, cameraStartZ - cameraZoom, cameraStartZ + cameraZoom);

  if (mousePos.isInteractive) {
    dollyCam.position.y += (cameraY - dollyCam.position.y) * cameraSpeed;
    dollyCam.position.z += (cameraZ - dollyCam.position.z) * cameraSpeed;
  }

  // how fast are we changing compass heading
  turnSpeed = rollAngle * planeAcceleration * -1;

  // keep track of current compass heading
  compassHeading += turnSpeed;
}

function normalize(v, vmin, vmax, tmin, tmax) {
  var nv = Math.max(Math.min(v, vmax), vmin);
  var dv = vmax - vmin;
  var pc = (nv - vmin) / dv;
  var dt = tmax - tmin;
  var tv = tmin + pc * dt;
  return tv;
}

var mousePos = { x: 0, y: 0, isInteractive: false };
// now handle the mousemove event
function handleMouseMove(event) {
  // here we are converting the mouse position value received
  // to a normalized value varying between -1 and 1;
  // this is the formula for the horizontal axis:
  var tx = -1 + event.clientX / WIDTH * 2;

  // for the vertical axis, we need to inverse the formula
  // because the 2D y-axis goes the opposite direction of the 3D y-axis
  var ty = 1 - event.clientY / HEIGHT * 2;
  mousePos = { x: tx, y: ty, isInteractive: true };
}

function handleMouseDown() {
  mouseDragging = true;
}

function handleMouseUp() {
  mouseDragging = false;
}

function init() {
  // set up the scene, the camera and the renderer
  createScene();

  // add the lights
  createLights();

  // add the objects
  createPlane();
  createSea();
  createSky();

  // world
  world = new THREE.Object3D();
  world.add(sky.mesh);
  world.add(sea.mesh);
  scene.add(world);

  // // Apply VR headset positional data to camera.
  vrcontrols = new THREE.VRControls(camera);

  // Apply VR stereo rendering to renderer.
  effect = new THREE.VREffect(renderer);
  effect.setSize(window.innerWidth, window.innerHeight);

  // Create a VR manager helper to enter and exit VR mode.
  var params = {
    hideButton: false, // Default: false.
    isUndistorted: false // Default: false.
  };
  manager = new _webvrBoilerplate2.default(renderer, effect, params);

  // The dolly has to be a PerspectiveCamera, as opposed
  // to a simple Object3D, since that's what
  // OrbitControls expects.
  dollyCam = new THREE.PerspectiveCamera();
  dollyCam.position.y = GROUND_DIAMETER + planeStartY * 2;
  dollyCam.position.z = cameraStartZ;
  dollyCam.add(camera);
  scene.add(dollyCam);

  // VIVE CONTROLLER
  if (navigator.getGamepads) {
    viveController = new THREE.ViveController(0);
    viveController.standingMatrix = vrcontrols.getStandingMatrix();
    scene.add(viveController);
  }

  // start a loop that will update the objects' positions
  // and render the scene on each frame
  loop();

  //add the listener
  document.addEventListener('mousemove', handleMouseMove, false);
  document.addEventListener('mousedown', handleMouseDown, false);
  document.addEventListener('mouseup', handleMouseUp, false);
}

window.addEventListener('load', init, false);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./airplane":5,"./sea":9,"./sky":10,"VRControls":2,"VREffect":3,"ViveController":1,"webvr-boilerplate":4}],9:[function(require,module,exports){
(function (global){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _three = (typeof window !== "undefined" ? window['THREE'] : typeof global !== "undefined" ? global['THREE'] : null);

var THREE = _interopRequireWildcard(_three);

var _colors = require('./colors');

var _colors2 = _interopRequireDefault(_colors);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Sea = function () {
  function Sea(GROUND_DIAMETER) {
    _classCallCheck(this, Sea);

    var geom = new THREE.SphereGeometry(GROUND_DIAMETER, 50, 50);

    // important: by merging vertices we ensure the continuity of the waves
    geom.mergeVertices();

    var l = geom.vertices.length;
    this.waves = [];

    for (var i = 0; i < l; i++) {
      var v = geom.vertices[i];

      // store some data associated to it
      this.waves.push({ y: v.y,
        x: v.x,
        z: v.z,
        // a random angle
        ang: Math.random() * Math.PI * 2,
        // a random distance
        amp: 5 + Math.random() * 25,
        // a random speed between 0.016 and 0.048 radians / frame
        speed: 0.016 + Math.random() * 0.032
      });
    }

    var mat = new THREE.MeshPhongMaterial({
      color: _colors2.default.water,
      transparent: true,
      opacity: 1,
      shading: THREE.FlatShading,
      wireframe: false
    });

    this.mesh = new THREE.Mesh(geom, mat);

    // Allow the sea to receive shadows
    this.mesh.receiveShadow = true;
  }

  Sea.prototype.moveWaves = function moveWaves() {
    var verts = this.mesh.geometry.vertices;
    var l = verts.length;

    for (var i = 0; i < l; i++) {
      var v = verts[i];
      var wave = this.waves[i];

      // update the position of the vertex
      v.x = wave.x + Math.cos(wave.ang) * wave.amp;
      v.y = wave.y + Math.sin(wave.ang) * wave.amp;

      // increment the angle for the next frame
      wave.ang += wave.speed;
    }

    // Tell the renderer that the geometry of the sea has changed.
    // In fact, in order to maintain the best level of performance,
    // three.js caches the geometries and ignores any changes
    // unless we add this line
    this.mesh.geometry.verticesNeedUpdate = true;
  };

  return Sea;
}();

exports.default = Sea;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./colors":7}],10:[function(require,module,exports){
(function (global){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _three = (typeof window !== "undefined" ? window['THREE'] : typeof global !== "undefined" ? global['THREE'] : null);

var THREE = _interopRequireWildcard(_three);

var _cloud = require('./cloud');

var _cloud2 = _interopRequireDefault(_cloud);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Sky = function Sky(GROUND_DIAMETER) {
  _classCallCheck(this, Sky);

  // Create an empty container
  this.mesh = new THREE.Object3D();

  // choose a number of clouds to be scattered in the sky
  this.nClouds = 200;

  // To distribute the clouds consistently,
  // we need to place them according to a uniform angle
  var stepAngle = Math.PI * 2 / this.nClouds;

  // create the clouds
  for (var i = 0; i < this.nClouds; i++) {
    var c = new _cloud2.default();

    // Get random altitude of cloud - radius is the distance from the center of the world
    var radius = GROUND_DIAMETER + 150 + Math.random() * 300;

    // Step through the Polar angle Theta around X-axis to spread clouds evenly
    var theta = stepAngle * i;

    // Random azimuthal angle Phi around Z-axis to spread clouds across all of the sphere
    var phi = Math.random() * Math.PI * 2;

    // generate random angle of cloud facing airplane
    var rotY = Math.random() * Math.PI * 2;

    // Rotate and translate to desired height above sphere surface
    var cloudMatrix = c.mesh.matrix.clone();

    var rotateMatrixX = new THREE.Matrix4();
    rotateMatrixX.makeRotationX(theta);

    var rotateMatrixZ = new THREE.Matrix4();
    rotateMatrixZ.makeRotationZ(phi);

    var rotateMatrixY = new THREE.Matrix4();
    rotateMatrixY.makeRotationY(rotY);

    var translateMatrix = new THREE.Matrix4();
    translateMatrix.makeTranslation(0, radius, 0);

    cloudMatrix.multiply(rotateMatrixX);
    cloudMatrix.multiply(rotateMatrixZ);
    cloudMatrix.multiply(translateMatrix);
    cloudMatrix.multiply(rotateMatrixY);
    c.mesh.applyMatrix(cloudMatrix);

    // we also set a random scale for each cloud
    var s = 1 + Math.random() * 2;
    c.mesh.scale.set(s, s, s);

    // do not forget to add the mesh of each cloud in the scene
    this.mesh.add(c.mesh);
  }
};

exports.default = Sky;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./cloud":6}]},{},[8])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvdGhyZWUvZXhhbXBsZXMvanMvVml2ZUNvbnRyb2xsZXIuanMiLCJub2RlX21vZHVsZXMvdGhyZWUvZXhhbXBsZXMvanMvY29udHJvbHMvVlJDb250cm9scy5qcyIsIm5vZGVfbW9kdWxlcy90aHJlZS9leGFtcGxlcy9qcy9lZmZlY3RzL1ZSRWZmZWN0LmpzIiwibm9kZV9tb2R1bGVzL3dlYnZyLWJvaWxlcnBsYXRlL2J1aWxkL3dlYnZyLW1hbmFnZXIuanMiLCJzcmMvanMvYWlycGxhbmUuanMiLCJzcmMvanMvY2xvdWQuanMiLCJzcmMvanMvY29sb3JzLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc2VhLmpzIiwic3JjL2pzL3NreS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3JjQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQzlqQkE7O0lBQVksSzs7QUFDWjs7Ozs7Ozs7OztJQUVNLFEsR0FDSixvQkFBZTtBQUFBOztBQUNiLE9BQUssSUFBTCxHQUFZLElBQUksTUFBTSxRQUFWLEVBQVo7O0FBRUE7QUFDQSxNQUFJLGtCQUFrQixJQUFJLE1BQU0sV0FBVixDQUFzQixHQUF0QixFQUEyQixFQUEzQixFQUErQixFQUEvQixFQUFtQyxDQUFuQyxFQUFzQyxD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TSxPQUFPLEtBQUssTUFBTCxLQUFnQixLQUFLLEVBQXJCLEdBQTBCLENBQXZDOztBQUVBO0FBQ0EsUUFBTSxjQUFjLEVBQUUsSUFBRixDQUFPLE1BQVAsQ0FBYyxLQUFkLEVBQXBCOztBQUVBLFFBQU0sZ0JBQWdCLElBQUksTUFBTSxPQUFWLEVBQXRCO0FBQ0Esa0JBQWMsYUFBZCxDQUE0QixLQUE1Qjs7QUFFQSxRQUFNLGdCQUFnQixJQUFJLE1BQU0sT0FBVixFQUF0QjtBQUNBLGtCQUFjLGFBQWQsQ0FBNEIsR0FBNUI7O0FBRUEsUUFBTSxnQkFBZ0IsSUFBSSxNQUFNLE9BQVYsRUFBdEI7QUFDQSxrQkFBYyxhQUFkLENBQTRCLElBQTVCOztBQUVBLFFBQU0sa0JBQWtCLElBQUksTUFBTSxPQUFWLEVBQXhCO0FBQ0Esb0JBQWdCLGVBQWhCLENBQWdDLENBQWhDLEVBQW1DLE1BQW5DLEVBQTJDLENBQTNDOztBQUVBLGdCQUFZLFFBQVosQ0FBcUIsYUFBckI7QUFDQSxnQkFBWSxRQUFaLENBQXFCLGFBQXJCO0FBQ0EsZ0JBQVksUUFBWixDQUFxQixlQUFyQjtBQUNBLGdCQUFZLFFBQVosQ0FBcUIsYUFBckI7QUFDQSxNQUFFLElBQUYsQ0FBTyxXQUFQLENBQW1CLFdBQW5COztBQUVBO0FBQ0EsUUFBTSxJQUFJLElBQUksS0FBSyxNQUFMLEtBQWdCLENBQTlCO0FBQ0EsTUFBRSxJQUFGLENBQU8sS0FBUCxDQUFhLEdBQWIsQ0FBaUIsQ0FBakIsRUFBb0IsQ0FBcEIsRUFBdUIsQ0FBdkI7O0FBRUE7QUFDQSxTQUFLLElBQUwsQ0FBVSxHQUFWLENBQWMsRUFBRSxJQUFoQjtBQUNEO0FBQ0YsQzs7a0JBR1ksRyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb21cbiAqIEBhdXRob3Igc3Rld2RpbyAvIGh0dHA6Ly9zdGV3ZC5pb1xuICovXG5cblRIUkVFLlZpdmVDb250cm9sbGVyID0gZnVuY3Rpb24gKCBpZCApIHtcblxuXHRUSFJFRS5PYmplY3QzRC5jYWxsKCB0aGlzICk7XG5cblx0dmFyIHNjb3BlID0gdGhpcztcblx0dmFyIGdhbWVwYWQ7XG5cblx0dmFyIGF4ZXMgPSBbIDAsIDAgXTtcblx0dmFyIHRodW1icGFkSXNQcmVzc2VkID0gZmFsc2U7XG5cdHZhciB0cmlnZ2VySXNQcmVzc2VkID0gZmFsc2U7XG5cdHZhciBncmlwc0FyZVByZXNzZWQgPSBmYWxzZTtcblx0dmFyIG1lbnVJc1ByZXNzZWQgPSBmYWxzZTtcblxuXHRmdW5jdGlvbiBmaW5kR2FtZXBhZCggaWQgKSB7XG5cblx0XHQvLyBJdGVyYXRlIGFjcm9zcyBnYW1lcGFkcyBhcyBWaXZlIENvbnRyb2xsZXJzIG1heSBub3QgYmVcblx0XHQvLyBpbiBwb3NpdGlvbiAwIGFuZCAxLlxuXG5cdFx0dmFyIGdhbWVwYWRzID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzKCk7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDAsIGogPSAwOyBpIDwgNDsgaSArKyApIHtcblxuXHRcdFx0dmFyIGdhbWVwYWQgPSBnYW1lcGFkc1sgaSBdO1xuXG5cdFx0XHRpZiAoIGdhbWVwYWQgJiYgZ2FtZXBhZC5pZCA9PT0gJ09wZW5WUiBHYW1lcGFkJyApIHtcblxuXHRcdFx0XHRpZiAoIGogPT09IGlkICkgcmV0dXJuIGdhbWVwYWQ7XG5cblx0XHRcdFx0aiArKztcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH1cblxuXHR0aGlzLm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTtcblx0dGhpcy5zdGFuZGluZ01hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG5cblx0dGhpcy5nZXRHYW1lcGFkID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIGdhbWVwYWQ7XG5cblx0fTtcblxuXHR0aGlzLmdldEJ1dHRvblN0YXRlID0gZnVuY3Rpb24gKCBidXR0b24gKSB7XG5cblx0XHRpZiAoIGJ1dHRvbiA9PT0gJ3RodW1icGFkJyApIHJldHVybiB0aHVtYnBhZElzUHJlc3NlZDtcblx0XHRpZiAoIGJ1dHRvbiA9PT0gJ3RyaWdnZXInICkgcmV0dXJuIHRyaWdnZXJJc1ByZXNzZWQ7XG5cdFx0aWYgKCBidXR0b24gPT09ICdncmlwcycgKSByZXR1cm4gZ3JpcHNBcmVQcmVzc2VkO1xuXHRcdGlmICggYnV0dG9uID09PSAnbWVudScgKSByZXR1cm4gbWVudUlzUHJlc3NlZDtcblxuXHR9O1xuXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0Z2FtZXBhZCA9IGZpbmRHYW1lcGFkKCBpZCApO1xuXG5cdFx0aWYgKCBnYW1lcGFkICE9PSB1bmRlZmluZWQgJiYgZ2FtZXBhZC5wb3NlICE9PSBudWxsICkge1xuXG5cdFx0XHQvLyAgUG9zaXRpb24gYW5kIG9yaWVudGF0aW9uLlxuXG5cdFx0XHR2YXIgcG9zZSA9IGdhbWVwYWQucG9zZTtcblxuXHRcdFx0aWYgKCBwb3NlLnBvc2l0aW9uICE9PSBudWxsICkgc2NvcGUucG9zaXRpb24uZnJvbUFycmF5KCBwb3NlLnBvc2l0aW9uICk7XG5cdFx0XHRpZiAoIHBvc2Uub3JpZW50YXRpb24gIT09IG51bGwgKSBzY29wZS5xdWF0ZXJuaW9uLmZyb21BcnJheSggcG9zZS5vcmllbnRhdGlvbiApO1xuXHRcdFx0c2NvcGUubWF0cml4LmNvbXBvc2UoIHNjb3BlLnBvc2l0aW9uLCBzY29wZS5xdWF0ZXJuaW9uLCBzY29wZS5zY2FsZSApO1xuXHRcdFx0c2NvcGUubWF0cml4Lm11bHRpcGx5TWF0cmljZXMoIHNjb3BlLnN0YW5kaW5nTWF0cml4LCBzY29wZS5tYXRyaXggKTtcblx0XHRcdHNjb3BlLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlO1xuXHRcdFx0c2NvcGUudmlzaWJsZSA9IHRydWU7XG5cblx0XHRcdC8vICBUaHVtYnBhZCBhbmQgQnV0dG9ucy5cblxuXHRcdFx0aWYgKCBheGVzWyAwIF0gIT09IGdhbWVwYWQuYXhlc1sgMCBdIHx8IGF4ZXNbIDEgXSAhPT0gZ2FtZXBhZC5heGVzWyAxIF0gKSB7XG5cblx0XHRcdFx0YXhlc1sgMCBdID0gZ2FtZXBhZC5heGVzWyAwIF07IC8vICBYIGF4aXM6IC0xID0gTGVmdCwgKzEgPSBSaWdodC5cblx0XHRcdFx0YXhlc1sgMSBdID0gZ2FtZXBhZC5heGVzWyAxIF07IC8vICBZIGF4aXM6IC0xID0gQm90dG9tLCArMSA9IFRvcC5cblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiAnYXhpc2NoYW5nZWQnLCBheGVzOiBheGVzIH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRodW1icGFkSXNQcmVzc2VkICE9PSBnYW1lcGFkLmJ1dHRvbnNbIDAgXS5wcmVzc2VkICkge1xuXG5cdFx0XHRcdHRodW1icGFkSXNQcmVzc2VkID0gZ2FtZXBhZC5idXR0b25zWyAwIF0ucHJlc3NlZDtcblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiB0aHVtYnBhZElzUHJlc3NlZCA/ICd0aHVtYnBhZGRvd24nIDogJ3RodW1icGFkdXAnIH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRyaWdnZXJJc1ByZXNzZWQgIT09IGdhbWVwYWQuYnV0dG9uc1sgMSBdLnByZXNzZWQgKSB7XG5cblx0XHRcdFx0dHJpZ2dlcklzUHJlc3NlZCA9IGdhbWVwYWQuYnV0dG9uc1sgMSBdLnByZXNzZWQ7XG5cdFx0XHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIHsgdHlwZTogdHJpZ2dlcklzUHJlc3NlZCA/ICd0cmlnZ2VyZG93bicgOiAndHJpZ2dlcnVwJyB9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBncmlwc0FyZVByZXNzZWQgIT09IGdhbWVwYWQuYnV0dG9uc1sgMiBdLnByZXNzZWQgKSB7XG5cblx0XHRcdFx0Z3JpcHNBcmVQcmVzc2VkID0gZ2FtZXBhZC5idXR0b25zWyAyIF0ucHJlc3NlZDtcblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiBncmlwc0FyZVByZXNzZWQgPyAnZ3JpcHNkb3duJyA6ICdncmlwc3VwJyB9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBtZW51SXNQcmVzc2VkICE9PSBnYW1lcGFkLmJ1dHRvbnNbIDMgXS5wcmVzc2VkICkge1xuXG5cdFx0XHRcdG1lbnVJc1ByZXNzZWQgPSBnYW1lcGFkLmJ1dHRvbnNbIDMgXS5wcmVzc2VkO1xuXHRcdFx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCB7IHR5cGU6IG1lbnVJc1ByZXNzZWQgPyAnbWVudWRvd24nIDogJ21lbnV1cCcgfSApO1xuXG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRzY29wZS52aXNpYmxlID0gZmFsc2U7XG5cblx0XHR9XG5cblx0fTtcblxufTtcblxuVEhSRUUuVml2ZUNvbnRyb2xsZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVEhSRUUuT2JqZWN0M0QucHJvdG90eXBlICk7XG5USFJFRS5WaXZlQ29udHJvbGxlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUSFJFRS5WaXZlQ29udHJvbGxlcjtcbiIsIi8qKlxuICogQGF1dGhvciBkbWFyY29zIC8gaHR0cHM6Ly9naXRodWIuY29tL2RtYXJjb3NcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb21cbiAqL1xuXG5USFJFRS5WUkNvbnRyb2xzID0gZnVuY3Rpb24gKCBvYmplY3QsIG9uRXJyb3IgKSB7XG5cblx0dmFyIHNjb3BlID0gdGhpcztcblxuXHR2YXIgdnJEaXNwbGF5LCB2ckRpc3BsYXlzO1xuXG5cdHZhciBzdGFuZGluZ01hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG5cblx0dmFyIGZyYW1lRGF0YSA9IG51bGw7XG5cdGlmICggJ1ZSRnJhbWVEYXRhJyBpbiB3aW5kb3cgKSB7XG5cdFx0ZnJhbWVEYXRhID0gbmV3IFZSRnJhbWVEYXRhKCk7XG5cdH1cblxuXHRmdW5jdGlvbiBnb3RWUkRpc3BsYXlzKCBkaXNwbGF5cyApIHtcblxuXHRcdHZyRGlzcGxheXMgPSBkaXNwbGF5cztcblxuXHRcdGlmICggZGlzcGxheXMubGVuZ3RoID4gMCApIHtcblxuXHRcdFx0dnJEaXNwbGF5ID0gZGlzcGxheXNbIDAgXTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmICggb25FcnJvciApIG9uRXJyb3IoICdWUiBpbnB1dCBub3QgYXZhaWxhYmxlLicgKTtcblxuXHRcdH1cblxuXHR9XG5cblx0aWYgKCBuYXZpZ2F0b3IuZ2V0VlJEaXNwbGF5cyApIHtcblxuXHRcdG5hdmlnYXRvci5nZXRWUkRpc3BsYXlzKCkudGhlbiggZ290VlJEaXNwbGF5cyApO1xuXG5cdH1cblxuXHQvLyB0aGUgUmlmdCBTREsgcmV0dXJucyB0aGUgcG9zaXRpb24gaW4gbWV0ZXJzXG5cdC8vIHRoaXMgc2NhbGUgZmFjdG9yIGFsbG93cyB0aGUgdXNlciB0byBkZWZpbmUgaG93IG1ldGVyc1xuXHQvLyBhcmUgY29udmVydGVkIHRvIHNjZW5lIHVuaXRzLlxuXG5cdHRoaXMuc2NhbGUgPSAxO1xuXG5cdC8vIElmIHRydWUgd2lsbCB1c2UgXCJzdGFuZGluZyBzcGFjZVwiIGNvb3JkaW5hdGUgc3lzdGVtIHdoZXJlIHk9MCBpcyB0aGVcblx0Ly8gZmxvb3IgYW5kIHg9MCwgej0wIGlzIHRoZSBjZW50ZXIgb2YgdGhlIHJvb20uXG5cdHRoaXMuc3RhbmRpbmcgPSBmYWxzZTtcblxuXHQvLyBEaXN0YW5jZSBmcm9tIHRoZSB1c2VycyBleWVzIHRvIHRoZSBmbG9vciBpbiBtZXRlcnMuIFVzZWQgd2hlblxuXHQvLyBzdGFuZGluZz10cnVlIGJ1dCB0aGUgVlJEaXNwbGF5IGRvZXNuJ3QgcHJvdmlkZSBzdGFnZVBhcmFtZXRlcnMuXG5cdHRoaXMudXNlckhlaWdodCA9IDEuNjtcblxuXHR0aGlzLmdldFZSRGlzcGxheSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiB2ckRpc3BsYXk7XG5cblx0fTtcblxuXHR0aGlzLmdldFZSRGlzcGxheXMgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gdnJEaXNwbGF5cztcblxuXHR9O1xuXG5cdHRoaXMuZ2V0U3RhbmRpbmdNYXRyaXggPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gc3RhbmRpbmdNYXRyaXg7XG5cblx0fTtcblxuXHR0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdGlmICggdnJEaXNwbGF5ICkge1xuXG5cdFx0XHR2YXIgcG9zZTtcblxuXHRcdFx0aWYgKCB2ckRpc3BsYXkuZ2V0RnJhbWVEYXRhICkge1xuXG5cdFx0XHRcdHZyRGlzcGxheS5nZXRGcmFtZURhdGEoIGZyYW1lRGF0YSApO1xuXHRcdFx0XHRwb3NlID0gZnJhbWVEYXRhLnBvc2U7XG5cblx0XHRcdH0gZWxzZSBpZiAoIHZyRGlzcGxheS5nZXRQb3NlICkge1xuXG5cdFx0XHRcdHBvc2UgPSB2ckRpc3BsYXkuZ2V0UG9zZSgpO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggcG9zZS5vcmllbnRhdGlvbiAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRvYmplY3QucXVhdGVybmlvbi5mcm9tQXJyYXkoIHBvc2Uub3JpZW50YXRpb24gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHBvc2UucG9zaXRpb24gIT09IG51bGwgKSB7XG5cblx0XHRcdFx0b2JqZWN0LnBvc2l0aW9uLmZyb21BcnJheSggcG9zZS5wb3NpdGlvbiApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdG9iamVjdC5wb3NpdGlvbi5zZXQoIDAsIDAsIDAgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRoaXMuc3RhbmRpbmcgKSB7XG5cblx0XHRcdFx0aWYgKCB2ckRpc3BsYXkuc3RhZ2VQYXJhbWV0ZXJzICkge1xuXG5cdFx0XHRcdFx0b2JqZWN0LnVwZGF0ZU1hdHJpeCgpO1xuXG5cdFx0XHRcdFx0c3RhbmRpbmdNYXRyaXguZnJvbUFycmF5KCB2ckRpc3BsYXkuc3RhZ2VQYXJhbWV0ZXJzLnNpdHRpbmdUb1N0YW5kaW5nVHJhbnNmb3JtICk7XG5cdFx0XHRcdFx0b2JqZWN0LmFwcGx5TWF0cml4KCBzdGFuZGluZ01hdHJpeCApO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRvYmplY3QucG9zaXRpb24uc2V0WSggb2JqZWN0LnBvc2l0aW9uLnkgKyB0aGlzLnVzZXJIZWlnaHQgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblxuXHRcdFx0b2JqZWN0LnBvc2l0aW9uLm11bHRpcGx5U2NhbGFyKCBzY29wZS5zY2FsZSApO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5yZXNldFBvc2UgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRpZiAoIHZyRGlzcGxheSApIHtcblxuXHRcdFx0dnJEaXNwbGF5LnJlc2V0UG9zZSgpO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5yZXNldFNlbnNvciA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLlZSQ29udHJvbHM6IC5yZXNldFNlbnNvcigpIGlzIG5vdyAucmVzZXRQb3NlKCkuJyApO1xuXHRcdHRoaXMucmVzZXRQb3NlKCk7XG5cblx0fTtcblxuXHR0aGlzLnplcm9TZW5zb3IgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5WUkNvbnRyb2xzOiAuemVyb1NlbnNvcigpIGlzIG5vdyAucmVzZXRQb3NlKCkuJyApO1xuXHRcdHRoaXMucmVzZXRQb3NlKCk7XG5cblx0fTtcblxuXHR0aGlzLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2ckRpc3BsYXkgPSBudWxsO1xuXG5cdH07XG5cbn07XG4iLCIvKipcbiAqIEBhdXRob3IgZG1hcmNvcyAvIGh0dHBzOi8vZ2l0aHViLmNvbS9kbWFyY29zXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tXG4gKlxuICogV2ViVlIgU3BlYzogaHR0cDovL21venZyLmdpdGh1Yi5pby93ZWJ2ci1zcGVjL3dlYnZyLmh0bWxcbiAqXG4gKiBGaXJlZm94OiBodHRwOi8vbW96dnIuY29tL2Rvd25sb2Fkcy9cbiAqIENocm9taXVtOiBodHRwczovL3dlYnZyLmluZm8vZ2V0LWNocm9tZVxuICpcbiAqL1xuXG5USFJFRS5WUkVmZmVjdCA9IGZ1bmN0aW9uICggcmVuZGVyZXIsIG9uRXJyb3IgKSB7XG5cblx0dmFyIHZyRGlzcGxheSwgdnJEaXNwbGF5cztcblx0dmFyIGV5ZVRyYW5zbGF0aW9uTCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdHZhciBleWVUcmFuc2xhdGlvblIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHR2YXIgcmVuZGVyUmVjdEwsIHJlbmRlclJlY3RSO1xuXG5cdHZhciBmcmFtZURhdGEgPSBudWxsO1xuXHRpZiAoICdWUkZyYW1lRGF0YScgaW4gd2luZG93ICkge1xuXG5cdFx0ZnJhbWVEYXRhID0gbmV3IFZSRnJhbWVEYXRhKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGdvdFZSRGlzcGxheXMoIGRpc3BsYXlzICkge1xuXG5cdFx0dnJEaXNwbGF5cyA9IGRpc3BsYXlzO1xuXG5cdFx0aWYgKCBkaXNwbGF5cy5sZW5ndGggPiAwICkge1xuXG5cdFx0XHR2ckRpc3BsYXkgPSBkaXNwbGF5c1sgMCBdO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0aWYgKCBvbkVycm9yICkgb25FcnJvciggJ0hNRCBub3QgYXZhaWxhYmxlJyApO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRpZiAoIG5hdmlnYXRvci5nZXRWUkRpc3BsYXlzICkge1xuXG5cdFx0bmF2aWdhdG9yLmdldFZSRGlzcGxheXMoKS50aGVuKCBnb3RWUkRpc3BsYXlzICk7XG5cblx0fVxuXG5cdC8vXG5cblx0dGhpcy5pc1ByZXNlbnRpbmcgPSBmYWxzZTtcblx0dGhpcy5zY2FsZSA9IDE7XG5cblx0dmFyIHNjb3BlID0gdGhpcztcblxuXHR2YXIgcmVuZGVyZXJTaXplID0gcmVuZGVyZXIuZ2V0U2l6ZSgpO1xuXHR2YXIgcmVuZGVyZXJVcGRhdGVTdHlsZSA9IGZhbHNlO1xuXHR2YXIgcmVuZGVyZXJQaXhlbFJhdGlvID0gcmVuZGVyZXIuZ2V0UGl4ZWxSYXRpbygpO1xuXG5cdHRoaXMuZ2V0VlJEaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIHZyRGlzcGxheTtcblxuXHR9O1xuXG5cdHRoaXMuZ2V0VlJEaXNwbGF5cyA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiB2ckRpc3BsYXlzO1xuXG5cdH07XG5cblx0dGhpcy5zZXRTaXplID0gZnVuY3Rpb24gKCB3aWR0aCwgaGVpZ2h0LCB1cGRhdGVTdHlsZSApIHtcblxuXHRcdHJlbmRlcmVyU2l6ZSA9IHsgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCB9O1xuXHRcdHJlbmRlcmVyVXBkYXRlU3R5bGUgPSB1cGRhdGVTdHlsZTtcblxuXHRcdGlmICggc2NvcGUuaXNQcmVzZW50aW5nICkge1xuXG5cdFx0XHR2YXIgZXllUGFyYW1zTCA9IHZyRGlzcGxheS5nZXRFeWVQYXJhbWV0ZXJzKCAnbGVmdCcgKTtcblx0XHRcdHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIDEgKTtcblx0XHRcdHJlbmRlcmVyLnNldFNpemUoIGV5ZVBhcmFtc0wucmVuZGVyV2lkdGggKiAyLCBleWVQYXJhbXNMLnJlbmRlckhlaWdodCwgZmFsc2UgKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHJlbmRlcmVyUGl4ZWxSYXRpbyApO1xuXHRcdFx0cmVuZGVyZXIuc2V0U2l6ZSggd2lkdGgsIGhlaWdodCwgdXBkYXRlU3R5bGUgKTtcblxuXHRcdH1cblxuXHR9O1xuXG5cdC8vIGZ1bGxzY3JlZW5cblxuXHR2YXIgY2FudmFzID0gcmVuZGVyZXIuZG9tRWxlbWVudDtcblx0dmFyIHJlcXVlc3RGdWxsc2NyZWVuO1xuXHR2YXIgZXhpdEZ1bGxzY3JlZW47XG5cdHZhciBmdWxsc2NyZWVuRWxlbWVudDtcblx0dmFyIGxlZnRCb3VuZHMgPSBbIDAuMCwgMC4wLCAwLjUsIDEuMCBdO1xuXHR2YXIgcmlnaHRCb3VuZHMgPSBbIDAuNSwgMC4wLCAwLjUsIDEuMCBdO1xuXG5cdGZ1bmN0aW9uIG9uRnVsbHNjcmVlbkNoYW5nZSgpIHtcblxuXHRcdHZhciB3YXNQcmVzZW50aW5nID0gc2NvcGUuaXNQcmVzZW50aW5nO1xuXHRcdHNjb3BlLmlzUHJlc2VudGluZyA9IHZyRGlzcGxheSAhPT0gdW5kZWZpbmVkICYmIHZyRGlzcGxheS5pc1ByZXNlbnRpbmc7XG5cblx0XHRpZiAoIHNjb3BlLmlzUHJlc2VudGluZyApIHtcblxuXHRcdFx0dmFyIGV5ZVBhcmFtc0wgPSB2ckRpc3BsYXkuZ2V0RXllUGFyYW1ldGVycyggJ2xlZnQnICk7XG5cdFx0XHR2YXIgZXllV2lkdGggPSBleWVQYXJhbXNMLnJlbmRlcldpZHRoO1xuXHRcdFx0dmFyIGV5ZUhlaWdodCA9IGV5ZVBhcmFtc0wucmVuZGVySGVpZ2h0O1xuXG5cdFx0XHR2YXIgbGF5ZXJzID0gdnJEaXNwbGF5LmdldExheWVycygpO1xuXHRcdFx0aWYgKCBsYXllcnMubGVuZ3RoICkge1xuXG5cdFx0XHRcdHZhciBsYXllciA9IGxheWVyc1swXTtcblxuXHRcdFx0XHRsZWZ0Qm91bmRzID0gbGF5ZXIubGVmdEJvdW5kcyAhPT0gbnVsbCAmJiBsYXllci5sZWZ0Qm91bmRzLmxlbmd0aCA9PT0gNCA/IGxheWVyLmxlZnRCb3VuZHMgOiBbIDAuMCwgMC4wLCAwLjUsIDEuMCBdO1xuXHRcdFx0XHRyaWdodEJvdW5kcyA9IGxheWVyLnJpZ2h0Qm91bmRzICE9PSBudWxsICYmIGxheWVyLnJpZ2h0Qm91bmRzLmxlbmd0aCA9PT0gNCA/IGxheWVyLnJpZ2h0Qm91bmRzIDogWyAwLjUsIDAuMCwgMC41LCAxLjAgXTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoICF3YXNQcmVzZW50aW5nICkge1xuXG5cdFx0XHRcdHJlbmRlcmVyUGl4ZWxSYXRpbyA9IHJlbmRlcmVyLmdldFBpeGVsUmF0aW8oKTtcblx0XHRcdFx0cmVuZGVyZXJTaXplID0gcmVuZGVyZXIuZ2V0U2l6ZSgpO1xuXG5cdFx0XHRcdHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIDEgKTtcblx0XHRcdFx0cmVuZGVyZXIuc2V0U2l6ZSggZXllV2lkdGggKiAyLCBleWVIZWlnaHQsIGZhbHNlICk7XG5cblx0XHRcdH1cblxuXHRcdH0gZWxzZSBpZiAoIHdhc1ByZXNlbnRpbmcgKSB7XG5cblx0XHRcdHJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHJlbmRlcmVyUGl4ZWxSYXRpbyApO1xuXHRcdFx0cmVuZGVyZXIuc2V0U2l6ZSggcmVuZGVyZXJTaXplLndpZHRoLCByZW5kZXJlclNpemUuaGVpZ2h0LCByZW5kZXJlclVwZGF0ZVN0eWxlICk7XG5cblx0XHR9XG5cblx0fVxuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAndnJkaXNwbGF5cHJlc2VudGNoYW5nZScsIG9uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UgKTtcblxuXHR0aGlzLnNldEZ1bGxTY3JlZW4gPSBmdW5jdGlvbiAoIGJvb2xlYW4gKSB7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG5cdFx0XHRpZiAoIHZyRGlzcGxheSA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdHJlamVjdCggbmV3IEVycm9yKCAnTm8gVlIgaGFyZHdhcmUgZm91bmQuJyApICk7XG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHNjb3BlLmlzUHJlc2VudGluZyA9PT0gYm9vbGVhbiApIHtcblxuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGJvb2xlYW4gKSB7XG5cblx0XHRcdFx0cmVzb2x2ZSggdnJEaXNwbGF5LnJlcXVlc3RQcmVzZW50KCBbIHsgc291cmNlOiBjYW52YXMgfSBdICkgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZXNvbHZlKCB2ckRpc3BsYXkuZXhpdFByZXNlbnQoKSApO1xuXG5cdFx0XHR9XG5cblx0XHR9ICk7XG5cblx0fTtcblxuXHR0aGlzLnJlcXVlc3RQcmVzZW50ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIHRoaXMuc2V0RnVsbFNjcmVlbiggdHJ1ZSApO1xuXG5cdH07XG5cblx0dGhpcy5leGl0UHJlc2VudCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiB0aGlzLnNldEZ1bGxTY3JlZW4oIGZhbHNlICk7XG5cblx0fTtcblxuXHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uICggZiApIHtcblxuXHRcdGlmICggdnJEaXNwbGF5ICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdHJldHVybiB2ckRpc3BsYXkucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBmICk7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRyZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSggZiApO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5jYW5jZWxBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uICggaCApIHtcblxuXHRcdGlmICggdnJEaXNwbGF5ICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdHZyRGlzcGxheS5jYW5jZWxBbmltYXRpb25GcmFtZSggaCApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0d2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKCBoICk7XG5cblx0XHR9XG5cblx0fTtcblxuXHR0aGlzLnN1Ym1pdEZyYW1lID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0aWYgKCB2ckRpc3BsYXkgIT09IHVuZGVmaW5lZCAmJiBzY29wZS5pc1ByZXNlbnRpbmcgKSB7XG5cblx0XHRcdHZyRGlzcGxheS5zdWJtaXRGcmFtZSgpO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5hdXRvU3VibWl0RnJhbWUgPSB0cnVlO1xuXG5cdC8vIHJlbmRlclxuXG5cdHZhciBjYW1lcmFMID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCk7XG5cdGNhbWVyYUwubGF5ZXJzLmVuYWJsZSggMSApO1xuXG5cdHZhciBjYW1lcmFSID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCk7XG5cdGNhbWVyYVIubGF5ZXJzLmVuYWJsZSggMiApO1xuXG5cdHRoaXMucmVuZGVyID0gZnVuY3Rpb24gKCBzY2VuZSwgY2FtZXJhLCByZW5kZXJUYXJnZXQsIGZvcmNlQ2xlYXIgKSB7XG5cblx0XHRpZiAoIHZyRGlzcGxheSAmJiBzY29wZS5pc1ByZXNlbnRpbmcgKSB7XG5cblx0XHRcdHZhciBhdXRvVXBkYXRlID0gc2NlbmUuYXV0b1VwZGF0ZTtcblxuXHRcdFx0aWYgKCBhdXRvVXBkYXRlICkge1xuXG5cdFx0XHRcdHNjZW5lLnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG5cdFx0XHRcdHNjZW5lLmF1dG9VcGRhdGUgPSBmYWxzZTtcblxuXHRcdFx0fVxuXG5cdFx0XHR2YXIgZXllUGFyYW1zTCA9IHZyRGlzcGxheS5nZXRFeWVQYXJhbWV0ZXJzKCAnbGVmdCcgKTtcblx0XHRcdHZhciBleWVQYXJhbXNSID0gdnJEaXNwbGF5LmdldEV5ZVBhcmFtZXRlcnMoICdyaWdodCcgKTtcblxuXHRcdFx0ZXllVHJhbnNsYXRpb25MLmZyb21BcnJheSggZXllUGFyYW1zTC5vZmZzZXQgKTtcblx0XHRcdGV5ZVRyYW5zbGF0aW9uUi5mcm9tQXJyYXkoIGV5ZVBhcmFtc1Iub2Zmc2V0ICk7XG5cblx0XHRcdGlmICggQXJyYXkuaXNBcnJheSggc2NlbmUgKSApIHtcblxuXHRcdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5WUkVmZmVjdC5yZW5kZXIoKSBubyBsb25nZXIgc3VwcG9ydHMgYXJyYXlzLiBVc2Ugb2JqZWN0LmxheWVycyBpbnN0ZWFkLicgKTtcblx0XHRcdFx0c2NlbmUgPSBzY2VuZVsgMCBdO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIFdoZW4gcmVuZGVyaW5nIHdlIGRvbid0IGNhcmUgd2hhdCB0aGUgcmVjb21tZW5kZWQgc2l6ZSBpcywgb25seSB3aGF0IHRoZSBhY3R1YWwgc2l6ZVxuXHRcdFx0Ly8gb2YgdGhlIGJhY2tidWZmZXIgaXMuXG5cdFx0XHR2YXIgc2l6ZSA9IHJlbmRlcmVyLmdldFNpemUoKTtcblx0XHRcdHJlbmRlclJlY3RMID0ge1xuXHRcdFx0XHR4OiBNYXRoLnJvdW5kKCBzaXplLndpZHRoICogbGVmdEJvdW5kc1sgMCBdICksXG5cdFx0XHRcdHk6IE1hdGgucm91bmQoIHNpemUuaGVpZ2h0ICogbGVmdEJvdW5kc1sgMSBdICksXG5cdFx0XHRcdHdpZHRoOiBNYXRoLnJvdW5kKCBzaXplLndpZHRoICogbGVmdEJvdW5kc1sgMiBdICksXG5cdFx0XHRcdGhlaWdodDogIE1hdGgucm91bmQoc2l6ZS5oZWlnaHQgKiBsZWZ0Qm91bmRzWyAzIF0gKVxuXHRcdFx0fTtcblx0XHRcdHJlbmRlclJlY3RSID0ge1xuXHRcdFx0XHR4OiBNYXRoLnJvdW5kKCBzaXplLndpZHRoICogcmlnaHRCb3VuZHNbIDAgXSApLFxuXHRcdFx0XHR5OiBNYXRoLnJvdW5kKCBzaXplLmhlaWdodCAqIHJpZ2h0Qm91bmRzWyAxIF0gKSxcblx0XHRcdFx0d2lkdGg6IE1hdGgucm91bmQoIHNpemUud2lkdGggKiByaWdodEJvdW5kc1sgMiBdICksXG5cdFx0XHRcdGhlaWdodDogIE1hdGgucm91bmQoc2l6ZS5oZWlnaHQgKiByaWdodEJvdW5kc1sgMyBdIClcblx0XHRcdH07XG5cblx0XHRcdGlmICggcmVuZGVyVGFyZ2V0ICkge1xuXG5cdFx0XHRcdHJlbmRlcmVyLnNldFJlbmRlclRhcmdldCggcmVuZGVyVGFyZ2V0ICk7XG5cdFx0XHRcdHJlbmRlclRhcmdldC5zY2lzc29yVGVzdCA9IHRydWU7XG5cblx0XHRcdH0gZWxzZSAge1xuXG5cdFx0XHRcdHJlbmRlcmVyLnNldFNjaXNzb3JUZXN0KCB0cnVlICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCByZW5kZXJlci5hdXRvQ2xlYXIgfHwgZm9yY2VDbGVhciApIHJlbmRlcmVyLmNsZWFyKCk7XG5cblx0XHRcdGlmICggY2FtZXJhLnBhcmVudCA9PT0gbnVsbCApIGNhbWVyYS51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXG5cdFx0XHRjYW1lcmEubWF0cml4V29ybGQuZGVjb21wb3NlKCBjYW1lcmFMLnBvc2l0aW9uLCBjYW1lcmFMLnF1YXRlcm5pb24sIGNhbWVyYUwuc2NhbGUgKTtcblx0XHRcdGNhbWVyYS5tYXRyaXhXb3JsZC5kZWNvbXBvc2UoIGNhbWVyYVIucG9zaXRpb24sIGNhbWVyYVIucXVhdGVybmlvbiwgY2FtZXJhUi5zY2FsZSApO1xuXG5cdFx0XHR2YXIgc2NhbGUgPSB0aGlzLnNjYWxlO1xuXHRcdFx0Y2FtZXJhTC50cmFuc2xhdGVPbkF4aXMoIGV5ZVRyYW5zbGF0aW9uTCwgc2NhbGUgKTtcblx0XHRcdGNhbWVyYVIudHJhbnNsYXRlT25BeGlzKCBleWVUcmFuc2xhdGlvblIsIHNjYWxlICk7XG5cblx0XHRcdGlmICggdnJEaXNwbGF5LmdldEZyYW1lRGF0YSApIHtcblxuXHRcdFx0XHR2ckRpc3BsYXkuZGVwdGhOZWFyID0gY2FtZXJhLm5lYXI7XG5cdFx0XHRcdHZyRGlzcGxheS5kZXB0aEZhciA9IGNhbWVyYS5mYXI7XG5cblx0XHRcdFx0dnJEaXNwbGF5LmdldEZyYW1lRGF0YSggZnJhbWVEYXRhICk7XG5cblx0XHRcdFx0Y2FtZXJhTC5wcm9qZWN0aW9uTWF0cml4LmVsZW1lbnRzID0gZnJhbWVEYXRhLmxlZnRQcm9qZWN0aW9uTWF0cml4O1xuXHRcdFx0XHRjYW1lcmFSLnByb2plY3Rpb25NYXRyaXguZWxlbWVudHMgPSBmcmFtZURhdGEucmlnaHRQcm9qZWN0aW9uTWF0cml4O1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGNhbWVyYUwucHJvamVjdGlvbk1hdHJpeCA9IGZvdlRvUHJvamVjdGlvbiggZXllUGFyYW1zTC5maWVsZE9mVmlldywgdHJ1ZSwgY2FtZXJhLm5lYXIsIGNhbWVyYS5mYXIgKTtcblx0XHRcdFx0Y2FtZXJhUi5wcm9qZWN0aW9uTWF0cml4ID0gZm92VG9Qcm9qZWN0aW9uKCBleWVQYXJhbXNSLmZpZWxkT2ZWaWV3LCB0cnVlLCBjYW1lcmEubmVhciwgY2FtZXJhLmZhciApO1xuXG5cdFx0XHRcdFxuXHRcdFx0fVxuXG5cdFx0XHQvLyByZW5kZXIgbGVmdCBleWVcblx0XHRcdGlmICggcmVuZGVyVGFyZ2V0ICkge1xuXG5cdFx0XHRcdHJlbmRlclRhcmdldC52aWV3cG9ydC5zZXQoIHJlbmRlclJlY3RMLngsIHJlbmRlclJlY3RMLnksIHJlbmRlclJlY3RMLndpZHRoLCByZW5kZXJSZWN0TC5oZWlnaHQgKTtcblx0XHRcdFx0cmVuZGVyVGFyZ2V0LnNjaXNzb3Iuc2V0KCByZW5kZXJSZWN0TC54LCByZW5kZXJSZWN0TC55LCByZW5kZXJSZWN0TC53aWR0aCwgcmVuZGVyUmVjdEwuaGVpZ2h0ICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0cmVuZGVyZXIuc2V0Vmlld3BvcnQoIHJlbmRlclJlY3RMLngsIHJlbmRlclJlY3RMLnksIHJlbmRlclJlY3RMLndpZHRoLCByZW5kZXJSZWN0TC5oZWlnaHQgKTtcblx0XHRcdFx0cmVuZGVyZXIuc2V0U2Npc3NvciggcmVuZGVyUmVjdEwueCwgcmVuZGVyUmVjdEwueSwgcmVuZGVyUmVjdEwud2lkdGgsIHJlbmRlclJlY3RMLmhlaWdodCApO1xuXG5cdFx0XHR9XG5cdFx0XHRyZW5kZXJlci5yZW5kZXIoIHNjZW5lLCBjYW1lcmFMLCByZW5kZXJUYXJnZXQsIGZvcmNlQ2xlYXIgKTtcblxuXHRcdFx0Ly8gcmVuZGVyIHJpZ2h0IGV5ZVxuXHRcdFx0aWYgKCByZW5kZXJUYXJnZXQgKSB7XG5cblx0XHRcdFx0cmVuZGVyVGFyZ2V0LnZpZXdwb3J0LnNldCggcmVuZGVyUmVjdFIueCwgcmVuZGVyUmVjdFIueSwgcmVuZGVyUmVjdFIud2lkdGgsIHJlbmRlclJlY3RSLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJUYXJnZXQuc2Npc3Nvci5zZXQoIHJlbmRlclJlY3RSLngsIHJlbmRlclJlY3RSLnksIHJlbmRlclJlY3RSLndpZHRoLCByZW5kZXJSZWN0Ui5oZWlnaHQgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRWaWV3cG9ydCggcmVuZGVyUmVjdFIueCwgcmVuZGVyUmVjdFIueSwgcmVuZGVyUmVjdFIud2lkdGgsIHJlbmRlclJlY3RSLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJlci5zZXRTY2lzc29yKCByZW5kZXJSZWN0Ui54LCByZW5kZXJSZWN0Ui55LCByZW5kZXJSZWN0Ui53aWR0aCwgcmVuZGVyUmVjdFIuaGVpZ2h0ICk7XG5cblx0XHRcdH1cblx0XHRcdHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYVIsIHJlbmRlclRhcmdldCwgZm9yY2VDbGVhciApO1xuXG5cdFx0XHRpZiAoIHJlbmRlclRhcmdldCApIHtcblxuXHRcdFx0XHRyZW5kZXJUYXJnZXQudmlld3BvcnQuc2V0KCAwLCAwLCBzaXplLndpZHRoLCBzaXplLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJUYXJnZXQuc2Npc3Nvci5zZXQoIDAsIDAsIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0ICk7XG5cdFx0XHRcdHJlbmRlclRhcmdldC5zY2lzc29yVGVzdCA9IGZhbHNlO1xuXHRcdFx0XHRyZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQoIG51bGwgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRTY2lzc29yVGVzdCggZmFsc2UgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGF1dG9VcGRhdGUgKSB7XG5cblx0XHRcdFx0c2NlbmUuYXV0b1VwZGF0ZSA9IHRydWU7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBzY29wZS5hdXRvU3VibWl0RnJhbWUgKSB7XG5cblx0XHRcdFx0c2NvcGUuc3VibWl0RnJhbWUoKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm47XG5cblx0XHR9XG5cblx0XHQvLyBSZWd1bGFyIHJlbmRlciBtb2RlIGlmIG5vdCBITURcblxuXHRcdHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYSwgcmVuZGVyVGFyZ2V0LCBmb3JjZUNsZWFyICk7XG5cblx0fTtcblxuXHQvL1xuXG5cdGZ1bmN0aW9uIGZvdlRvTkRDU2NhbGVPZmZzZXQoIGZvdiApIHtcblxuXHRcdHZhciBweHNjYWxlID0gMi4wIC8gKCBmb3YubGVmdFRhbiArIGZvdi5yaWdodFRhbiApO1xuXHRcdHZhciBweG9mZnNldCA9ICggZm92LmxlZnRUYW4gLSBmb3YucmlnaHRUYW4gKSAqIHB4c2NhbGUgKiAwLjU7XG5cdFx0dmFyIHB5c2NhbGUgPSAyLjAgLyAoIGZvdi51cFRhbiArIGZvdi5kb3duVGFuICk7XG5cdFx0dmFyIHB5b2Zmc2V0ID0gKCBmb3YudXBUYW4gLSBmb3YuZG93blRhbiApICogcHlzY2FsZSAqIDAuNTtcblx0XHRyZXR1cm4geyBzY2FsZTogWyBweHNjYWxlLCBweXNjYWxlIF0sIG9mZnNldDogWyBweG9mZnNldCwgcHlvZmZzZXQgXSB9O1xuXG5cdH1cblxuXHRmdW5jdGlvbiBmb3ZQb3J0VG9Qcm9qZWN0aW9uKCBmb3YsIHJpZ2h0SGFuZGVkLCB6TmVhciwgekZhciApIHtcblxuXHRcdHJpZ2h0SGFuZGVkID0gcmlnaHRIYW5kZWQgPT09IHVuZGVmaW5lZCA/IHRydWUgOiByaWdodEhhbmRlZDtcblx0XHR6TmVhciA9IHpOZWFyID09PSB1bmRlZmluZWQgPyAwLjAxIDogek5lYXI7XG5cdFx0ekZhciA9IHpGYXIgPT09IHVuZGVmaW5lZCA/IDEwMDAwLjAgOiB6RmFyO1xuXG5cdFx0dmFyIGhhbmRlZG5lc3NTY2FsZSA9IHJpZ2h0SGFuZGVkID8gLSAxLjAgOiAxLjA7XG5cblx0XHQvLyBzdGFydCB3aXRoIGFuIGlkZW50aXR5IG1hdHJpeFxuXHRcdHZhciBtb2JqID0gbmV3IFRIUkVFLk1hdHJpeDQoKTtcblx0XHR2YXIgbSA9IG1vYmouZWxlbWVudHM7XG5cblx0XHQvLyBhbmQgd2l0aCBzY2FsZS9vZmZzZXQgaW5mbyBmb3Igbm9ybWFsaXplZCBkZXZpY2UgY29vcmRzXG5cdFx0dmFyIHNjYWxlQW5kT2Zmc2V0ID0gZm92VG9ORENTY2FsZU9mZnNldCggZm92ICk7XG5cblx0XHQvLyBYIHJlc3VsdCwgbWFwIGNsaXAgZWRnZXMgdG8gWy13LCt3XVxuXHRcdG1bIDAgKiA0ICsgMCBdID0gc2NhbGVBbmRPZmZzZXQuc2NhbGVbIDAgXTtcblx0XHRtWyAwICogNCArIDEgXSA9IDAuMDtcblx0XHRtWyAwICogNCArIDIgXSA9IHNjYWxlQW5kT2Zmc2V0Lm9mZnNldFsgMCBdICogaGFuZGVkbmVzc1NjYWxlO1xuXHRcdG1bIDAgKiA0ICsgMyBdID0gMC4wO1xuXG5cdFx0Ly8gWSByZXN1bHQsIG1hcCBjbGlwIGVkZ2VzIHRvIFstdywrd11cblx0XHQvLyBZIG9mZnNldCBpcyBuZWdhdGVkIGJlY2F1c2UgdGhpcyBwcm9qIG1hdHJpeCB0cmFuc2Zvcm1zIGZyb20gd29ybGQgY29vcmRzIHdpdGggWT11cCxcblx0XHQvLyBidXQgdGhlIE5EQyBzY2FsaW5nIGhhcyBZPWRvd24gKHRoYW5rcyBEM0Q/KVxuXHRcdG1bIDEgKiA0ICsgMCBdID0gMC4wO1xuXHRcdG1bIDEgKiA0ICsgMSBdID0gc2NhbGVBbmRPZmZzZXQuc2NhbGVbIDEgXTtcblx0XHRtWyAxICogNCArIDIgXSA9IC0gc2NhbGVBbmRPZmZzZXQub2Zmc2V0WyAxIF0gKiBoYW5kZWRuZXNzU2NhbGU7XG5cdFx0bVsgMSAqIDQgKyAzIF0gPSAwLjA7XG5cblx0XHQvLyBaIHJlc3VsdCAodXAgdG8gdGhlIGFwcClcblx0XHRtWyAyICogNCArIDAgXSA9IDAuMDtcblx0XHRtWyAyICogNCArIDEgXSA9IDAuMDtcblx0XHRtWyAyICogNCArIDIgXSA9IHpGYXIgLyAoIHpOZWFyIC0gekZhciApICogLSBoYW5kZWRuZXNzU2NhbGU7XG5cdFx0bVsgMiAqIDQgKyAzIF0gPSAoIHpGYXIgKiB6TmVhciApIC8gKCB6TmVhciAtIHpGYXIgKTtcblxuXHRcdC8vIFcgcmVzdWx0ICg9IFogaW4pXG5cdFx0bVsgMyAqIDQgKyAwIF0gPSAwLjA7XG5cdFx0bVsgMyAqIDQgKyAxIF0gPSAwLjA7XG5cdFx0bVsgMyAqIDQgKyAyIF0gPSBoYW5kZWRuZXNzU2NhbGU7XG5cdFx0bVsgMyAqIDQgKyAzIF0gPSAwLjA7XG5cblx0XHRtb2JqLnRyYW5zcG9zZSgpO1xuXG5cdFx0cmV0dXJuIG1vYmo7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGZvdlRvUHJvamVjdGlvbiggZm92LCByaWdodEhhbmRlZCwgek5lYXIsIHpGYXIgKSB7XG5cblx0XHR2YXIgREVHMlJBRCA9IE1hdGguUEkgLyAxODAuMDtcblxuXHRcdHZhciBmb3ZQb3J0ID0ge1xuXHRcdFx0dXBUYW46IE1hdGgudGFuKCBmb3YudXBEZWdyZWVzICogREVHMlJBRCApLFxuXHRcdFx0ZG93blRhbjogTWF0aC50YW4oIGZvdi5kb3duRGVncmVlcyAqIERFRzJSQUQgKSxcblx0XHRcdGxlZnRUYW46IE1hdGgudGFuKCBmb3YubGVmdERlZ3JlZXMgKiBERUcyUkFEICksXG5cdFx0XHRyaWdodFRhbjogTWF0aC50YW4oIGZvdi5yaWdodERlZ3JlZXMgKiBERUcyUkFEIClcblx0XHR9O1xuXG5cdFx0cmV0dXJuIGZvdlBvcnRUb1Byb2plY3Rpb24oIGZvdlBvcnQsIHJpZ2h0SGFuZGVkLCB6TmVhciwgekZhciApO1xuXG5cdH1cblxufTtcbiIsIihmdW5jdGlvbihmKXtpZih0eXBlb2YgZXhwb3J0cz09PVwib2JqZWN0XCImJnR5cGVvZiBtb2R1bGUhPT1cInVuZGVmaW5lZFwiKXttb2R1bGUuZXhwb3J0cz1mKCl9ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoW10sZil9ZWxzZXt2YXIgZztpZih0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09XCJ1bmRlZmluZWRcIil7Zz1nbG9iYWx9ZWxzZSBpZih0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCIpe2c9c2VsZn1lbHNle2c9dGhpc31nLldlYlZSTWFuYWdlciA9IGYoKX19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8qXG4gKiBDb3B5cmlnaHQgMjAxNSBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbnZhciBFbWl0dGVyID0gX2RlcmVxXygnLi9lbWl0dGVyLmpzJyk7XG52YXIgTW9kZXMgPSBfZGVyZXFfKCcuL21vZGVzLmpzJyk7XG52YXIgVXRpbCA9IF9kZXJlcV8oJy4vdXRpbC5qcycpO1xuXG4vKipcbiAqIEV2ZXJ5dGhpbmcgaGF2aW5nIHRvIGRvIHdpdGggdGhlIFdlYlZSIGJ1dHRvbi5cbiAqIEVtaXRzIGEgJ2NsaWNrJyBldmVudCB3aGVuIGl0J3MgY2xpY2tlZC5cbiAqL1xuZnVuY3Rpb24gQnV0dG9uTWFuYWdlcihvcHRfcm9vdCkge1xuICB2YXIgcm9vdCA9IG9wdF9yb290IHx8IGRvY3VtZW50LmJvZHk7XG4gIHRoaXMubG9hZEljb25zXygpO1xuXG4gIC8vIE1ha2UgdGhlIGZ1bGxzY3JlZW4gYnV0dG9uLlxuICB2YXIgZnNCdXR0b24gPSB0aGlzLmNyZWF0ZUJ1dHRvbigpO1xuICBmc0J1dHRvbi5zcmMgPSB0aGlzLklDT05TLmZ1bGxzY3JlZW47XG4gIGZzQnV0dG9uLnRpdGxlID0gJ0Z1bGxzY3JlZW4gbW9kZSc7XG4gIHZhciBzID0gZnNCdXR0b24uc3R5bGU7XG4gIHMuYm90dG9tID0gMDtcbiAgcy5yaWdodCA9IDA7XG4gIGZzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jcmVhdGVDbGlja0hhbmRsZXJfKCdmcycpKTtcbiAgcm9vdC5hcHBlbmRDaGlsZChmc0J1dHRvbik7XG4gIHRoaXMuZnNCdXR0b24gPSBmc0J1dHRvbjtcblxuICAvLyBNYWtlIHRoZSBWUiBidXR0b24uXG4gIHZhciB2ckJ1dHRvbiA9IHRoaXMuY3JlYXRlQnV0dG9uKCk7XG4gIHZyQnV0dG9uLnNyYyA9IHRoaXMuSUNPTlMuY2FyZGJvYXJkO1xuICB2ckJ1dHRvbi50aXRsZSA9ICdWaXJ0dWFsIHJlYWxpdHkgbW9kZSc7XG4gIHZhciBzID0gdnJCdXR0b24uc3R5bGU7XG4gIHMuYm90dG9tID0gMDtcbiAgcy5yaWdodCA9ICc0OHB4JztcbiAgdnJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNyZWF0ZUNsaWNrSGFuZGxlcl8oJ3ZyJykpO1xuICByb290LmFwcGVuZENoaWxkKHZyQnV0dG9uKTtcbiAgdGhpcy52ckJ1dHRvbiA9IHZyQnV0dG9uO1xuXG4gIHRoaXMuaXNWaXNpYmxlID0gdHJ1ZTtcblxufVxuQnV0dG9uTWFuYWdlci5wcm90b3R5cGUgPSBuZXcgRW1pdHRlcigpO1xuXG5CdXR0b25NYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVCdXR0b24gPSBmdW5jdGlvbigpIHtcbiAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICBidXR0b24uY2xhc3NOYW1lID0gJ3dlYnZyLWJ1dHRvbic7XG4gIHZhciBzID0gYnV0dG9uLnN0eWxlO1xuICBzLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgcy53aWR0aCA9ICcyNHB4J1xuICBzLmhlaWdodCA9ICcyNHB4JztcbiAgcy5iYWNrZ3JvdW5kU2l6ZSA9ICdjb3Zlcic7XG4gIHMuYmFja2dyb3VuZENvbG9yID0gJ3RyYW5zcGFyZW50JztcbiAgcy5ib3JkZXIgPSAwO1xuICBzLnVzZXJTZWxlY3QgPSAnbm9uZSc7XG4gIHMud2Via2l0VXNlclNlbGVjdCA9ICdub25lJztcbiAgcy5Nb3pVc2VyU2VsZWN0ID0gJ25vbmUnO1xuICBzLmN1cnNvciA9ICdwb2ludGVyJztcbiAgcy5wYWRkaW5nID0gJzEycHgnO1xuICBzLnpJbmRleCA9IDE7XG4gIHMuZGlzcGxheSA9ICdub25lJztcbiAgcy5ib3hTaXppbmcgPSAnY29udGVudC1ib3gnO1xuXG4gIC8vIFByZXZlbnQgYnV0dG9uIGZyb20gYmVpbmcgc2VsZWN0ZWQgYW5kIGRyYWdnZWQuXG4gIGJ1dHRvbi5kcmFnZ2FibGUgPSBmYWxzZTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xuXG4gIC8vIFN0eWxlIGl0IG9uIGhvdmVyLlxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGZ1bmN0aW9uKGUpIHtcbiAgICBzLmZpbHRlciA9IHMud2Via2l0RmlsdGVyID0gJ2Ryb3Atc2hhZG93KDAgMCA1cHggcmdiYSgyNTUsMjU1LDI1NSwxKSknO1xuICB9KTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBmdW5jdGlvbihlKSB7XG4gICAgcy5maWx0ZXIgPSBzLndlYmtpdEZpbHRlciA9ICcnO1xuICB9KTtcbiAgcmV0dXJuIGJ1dHRvbjtcbn07XG5cbkJ1dHRvbk1hbmFnZXIucHJvdG90eXBlLnNldE1vZGUgPSBmdW5jdGlvbihtb2RlLCBpc1ZSQ29tcGF0aWJsZSkge1xuICBpc1ZSQ29tcGF0aWJsZSA9IGlzVlJDb21wYXRpYmxlIHx8IFdlYlZSQ29uZmlnLkZPUkNFX0VOQUJMRV9WUjtcbiAgaWYgKCF0aGlzLmlzVmlzaWJsZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBzd2l0Y2ggKG1vZGUpIHtcbiAgICBjYXNlIE1vZGVzLk5PUk1BTDpcbiAgICAgIHRoaXMuZnNCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB0aGlzLmZzQnV0dG9uLnNyYyA9IHRoaXMuSUNPTlMuZnVsbHNjcmVlbjtcbiAgICAgIHRoaXMudnJCdXR0b24uc3R5bGUuZGlzcGxheSA9IChpc1ZSQ29tcGF0aWJsZSA/ICdibG9jaycgOiAnbm9uZScpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBNb2Rlcy5NQUdJQ19XSU5ET1c6XG4gICAgICB0aGlzLmZzQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdGhpcy5mc0J1dHRvbi5zcmMgPSB0aGlzLklDT05TLmV4aXRGdWxsc2NyZWVuO1xuICAgICAgdGhpcy52ckJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBNb2Rlcy5WUjpcbiAgICAgIHRoaXMuZnNCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIHRoaXMudnJCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgLy8gSGFjayBmb3IgU2FmYXJpIE1hYy9pT1MgdG8gZm9yY2UgcmVsYXlvdXQgKHN2Zy1zcGVjaWZpYyBpc3N1ZSlcbiAgLy8gaHR0cDovL2dvby5nbC9oamdSNnJcbiAgdmFyIG9sZFZhbHVlID0gdGhpcy5mc0J1dHRvbi5zdHlsZS5kaXNwbGF5O1xuICB0aGlzLmZzQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgdGhpcy5mc0J1dHRvbi5vZmZzZXRIZWlnaHQ7XG4gIHRoaXMuZnNCdXR0b24uc3R5bGUuZGlzcGxheSA9IG9sZFZhbHVlO1xufTtcblxuQnV0dG9uTWFuYWdlci5wcm90b3R5cGUuc2V0VmlzaWJpbGl0eSA9IGZ1bmN0aW9uKGlzVmlzaWJsZSkge1xuICB0aGlzLmlzVmlzaWJsZSA9IGlzVmlzaWJsZTtcbiAgdGhpcy5mc0J1dHRvbi5zdHlsZS5kaXNwbGF5ID0gaXNWaXNpYmxlID8gJ2Jsb2NrJyA6ICdub25lJztcbiAgdGhpcy52ckJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gaXNWaXNpYmxlID8gJ2Jsb2NrJyA6ICdub25lJztcbn07XG5cbkJ1dHRvbk1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZUNsaWNrSGFuZGxlcl8gPSBmdW5jdGlvbihldmVudE5hbWUpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmVtaXQoZXZlbnROYW1lKTtcbiAgfS5iaW5kKHRoaXMpO1xufTtcblxuQnV0dG9uTWFuYWdlci5wcm90b3R5cGUubG9hZEljb25zXyA9IGZ1bmN0aW9uKCkge1xuICAvLyBQcmVsb2FkIHNvbWUgaGFyZC1jb2RlZCBTVkcuXG4gIHRoaXMuSUNPTlMgPSB7fTtcbiAgdGhpcy5JQ09OUy5jYXJkYm9hcmQgPSBVdGlsLmJhc2U2NCgnaW1hZ2Uvc3ZnK3htbCcsICdQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l5TkhCNElpQm9aV2xuYUhROUlqSTBjSGdpSUhacFpYZENiM2c5SWpBZ01DQXlOQ0F5TkNJZ1ptbHNiRDBpSTBaR1JrWkdSaUkrQ2lBZ0lDQThjR0YwYUNCa1BTSk5NakF1TnpRZ05rZ3pMakl4UXpJdU5UVWdOaUF5SURZdU5UY2dNaUEzTGpJNGRqRXdMalEwWXpBZ0xqY3VOVFVnTVM0eU9DQXhMakl6SURFdU1qaG9OQzQzT1dNdU5USWdNQ0F1T1RZdExqTXpJREV1TVRRdExqYzViREV1TkMwekxqUTRZeTR5TXkwdU5Ua3VOemt0TVM0d01TQXhMalEwTFRFdU1ERnpNUzR5TVM0ME1pQXhMalExSURFdU1ERnNNUzR6T1NBekxqUTRZeTR4T1M0ME5pNDJNeTQzT1NBeExqRXhMamM1YURRdU56bGpMamN4SURBZ01TNHlOaTB1TlRjZ01TNHlOaTB4TGpJNFZqY3VNamhqTUMwdU55MHVOVFV0TVM0eU9DMHhMakkyTFRFdU1qaDZUVGN1TlNBeE5DNDJNbU10TVM0eE55QXdMVEl1TVRNdExqazFMVEl1TVRNdE1pNHhNaUF3TFRFdU1UY3VPVFl0TWk0eE15QXlMakV6TFRJdU1UTWdNUzR4T0NBd0lESXVNVEl1T1RZZ01pNHhNaUF5TGpFemN5MHVPVFVnTWk0eE1pMHlMakV5SURJdU1USjZiVGtnTUdNdE1TNHhOeUF3TFRJdU1UTXRMamsxTFRJdU1UTXRNaTR4TWlBd0xURXVNVGN1T1RZdE1pNHhNeUF5TGpFekxUSXVNVE56TWk0eE1pNDVOaUF5TGpFeUlESXVNVE10TGprMUlESXVNVEl0TWk0eE1pQXlMakV5ZWlJdlBnb2dJQ0FnUEhCaGRHZ2dabWxzYkQwaWJtOXVaU0lnWkQwaVRUQWdNR2d5TkhZeU5FZ3dWakI2SWk4K0Nqd3ZjM1puUGdvPScpO1xuICB0aGlzLklDT05TLmZ1bGxzY3JlZW4gPSBVdGlsLmJhc2U2NCgnaW1hZ2Uvc3ZnK3htbCcsICdQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l5TkhCNElpQm9aV2xuYUhROUlqSTBjSGdpSUhacFpYZENiM2c5SWpBZ01DQXlOQ0F5TkNJZ1ptbHNiRDBpSTBaR1JrWkdSaUkrQ2lBZ0lDQThjR0YwYUNCa1BTSk5NQ0F3YURJMGRqSTBTREI2SWlCbWFXeHNQU0p1YjI1bElpOCtDaUFnSUNBOGNHRjBhQ0JrUFNKTk55QXhORWcxZGpWb05YWXRNa2czZGkwemVtMHRNaTAwYURKV04yZ3pWalZJTlhZMWVtMHhNaUEzYUMwemRqSm9OWFl0TldndE1uWXplazB4TkNBMWRqSm9NM1l6YURKV05XZ3ROWG9pTHo0S1BDOXpkbWMrQ2c9PScpO1xuICB0aGlzLklDT05TLmV4aXRGdWxsc2NyZWVuID0gVXRpbC5iYXNlNjQoJ2ltYWdlL3N2Zyt4bWwnLCAnUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeU5IQjRJaUJvWldsbmFIUTlJakkwY0hnaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdabWxzYkQwaUkwWkdSa1pHUmlJK0NpQWdJQ0E4Y0dGMGFDQmtQU0pOTUNBd2FESTBkakkwU0RCNklpQm1hV3hzUFNKdWIyNWxJaTgrQ2lBZ0lDQThjR0YwYUNCa1BTSk5OU0F4Tm1nemRqTm9Nbll0TlVnMWRqSjZiVE10T0VnMWRqSm9OVlkxU0RoMk0zcHROaUF4TVdneWRpMHphRE4yTFRKb0xUVjJOWHB0TWkweE1WWTFhQzB5ZGpWb05WWTRhQzB6ZWlJdlBnbzhMM04yWno0SycpO1xuICB0aGlzLklDT05TLnNldHRpbmdzID0gVXRpbC5iYXNlNjQoJ2ltYWdlL3N2Zyt4bWwnLCAnUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeU5IQjRJaUJvWldsbmFIUTlJakkwY0hnaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdabWxzYkQwaUkwWkdSa1pHUmlJK0NpQWdJQ0E4Y0dGMGFDQmtQU0pOTUNBd2FESTBkakkwU0RCNklpQm1hV3hzUFNKdWIyNWxJaTgrQ2lBZ0lDQThjR0YwYUNCa1BTSk5NVGt1TkRNZ01USXVPVGhqTGpBMExTNHpNaTR3TnkwdU5qUXVNRGN0TGprNGN5MHVNRE10TGpZMkxTNHdOeTB1T1Roc01pNHhNUzB4TGpZMVl5NHhPUzB1TVRVdU1qUXRMalF5TGpFeUxTNDJOR3d0TWkwekxqUTJZeTB1TVRJdExqSXlMUzR6T1MwdU15MHVOakV0TGpJeWJDMHlMalE1SURGakxTNDFNaTB1TkMweExqQTRMUzQzTXkweExqWTVMUzQ1T0d3dExqTTRMVEl1TmpWRE1UUXVORFlnTWk0eE9DQXhOQzR5TlNBeUlERTBJREpvTFRSakxTNHlOU0F3TFM0ME5pNHhPQzB1TkRrdU5ESnNMUzR6T0NBeUxqWTFZeTB1TmpFdU1qVXRNUzR4Tnk0MU9TMHhMalk1TGprNGJDMHlMalE1TFRGakxTNHlNeTB1TURrdExqUTVJREF0TGpZeExqSXliQzB5SURNdU5EWmpMUzR4TXk0eU1pMHVNRGN1TkRrdU1USXVOalJzTWk0eE1TQXhMalkxWXkwdU1EUXVNekl0TGpBM0xqWTFMUzR3Tnk0NU9ITXVNRE11TmpZdU1EY3VPVGhzTFRJdU1URWdNUzQyTldNdExqRTVMakUxTFM0eU5DNDBNaTB1TVRJdU5qUnNNaUF6TGpRMll5NHhNaTR5TWk0ek9TNHpMall4TGpJeWJESXVORGt0TVdNdU5USXVOQ0F4TGpBNExqY3pJREV1TmprdU9UaHNMak00SURJdU5qVmpMakF6TGpJMExqSTBMalF5TGpRNUxqUXlhRFJqTGpJMUlEQWdMalEyTFM0eE9DNDBPUzB1TkRKc0xqTTRMVEl1TmpWakxqWXhMUzR5TlNBeExqRTNMUzQxT1NBeExqWTVMUzQ1T0d3eUxqUTVJREZqTGpJekxqQTVMalE1SURBZ0xqWXhMUzR5TW13eUxUTXVORFpqTGpFeUxTNHlNaTR3TnkwdU5Ea3RMakV5TFM0Mk5Hd3RNaTR4TVMweExqWTFlazB4TWlBeE5TNDFZeTB4TGpreklEQXRNeTQxTFRFdU5UY3RNeTQxTFRNdU5YTXhMalUzTFRNdU5TQXpMalV0TXk0MUlETXVOU0F4TGpVM0lETXVOU0F6TGpVdE1TNDFOeUF6TGpVdE15NDFJRE11TlhvaUx6NEtQQzl6ZG1jK0NnPT0nKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQnV0dG9uTWFuYWdlcjtcblxufSx7XCIuL2VtaXR0ZXIuanNcIjoyLFwiLi9tb2Rlcy5qc1wiOjMsXCIuL3V0aWwuanNcIjo0fV0sMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4vKlxuICogQ29weXJpZ2h0IDIwMTUgR29vZ2xlIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5mdW5jdGlvbiBFbWl0dGVyKCkge1xuICB0aGlzLmNhbGxiYWNrcyA9IHt9O1xufVxuXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oZXZlbnROYW1lKSB7XG4gIHZhciBjYWxsYmFja3MgPSB0aGlzLmNhbGxiYWNrc1tldmVudE5hbWVdO1xuICBpZiAoIWNhbGxiYWNrcykge1xuICAgIC8vY29uc29sZS5sb2coJ05vIHZhbGlkIGNhbGxiYWNrIHNwZWNpZmllZC4nKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gIC8vIEVsaW1pbmF0ZSB0aGUgZmlyc3QgcGFyYW0gKHRoZSBjYWxsYmFjaykuXG4gIGFyZ3Muc2hpZnQoKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICBjYWxsYmFja3NbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cbn07XG5cbkVtaXR0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24oZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICBpZiAoZXZlbnROYW1lIGluIHRoaXMuY2FsbGJhY2tzKSB7XG4gICAgdGhpcy5jYWxsYmFja3NbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmNhbGxiYWNrc1tldmVudE5hbWVdID0gW2NhbGxiYWNrXTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBFbWl0dGVyO1xuXG59LHt9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8qXG4gKiBDb3B5cmlnaHQgMjAxNSBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbnZhciBNb2RlcyA9IHtcbiAgVU5LTk9XTjogMCxcbiAgLy8gTm90IGZ1bGxzY3JlZW4sIGp1c3QgdHJhY2tpbmcuXG4gIE5PUk1BTDogMSxcbiAgLy8gTWFnaWMgd2luZG93IGltbWVyc2l2ZSBtb2RlLlxuICBNQUdJQ19XSU5ET1c6IDIsXG4gIC8vIEZ1bGwgc2NyZWVuIHNwbGl0IHNjcmVlbiBWUiBtb2RlLlxuICBWUjogMyxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTW9kZXM7XG5cbn0se31dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLypcbiAqIENvcHlyaWdodCAyMDE1IEdvb2dsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxudmFyIFV0aWwgPSB7fTtcblxuVXRpbC5iYXNlNjQgPSBmdW5jdGlvbihtaW1lVHlwZSwgYmFzZTY0KSB7XG4gIHJldHVybiAnZGF0YTonICsgbWltZVR5cGUgKyAnO2Jhc2U2NCwnICsgYmFzZTY0O1xufTtcblxuVXRpbC5pc01vYmlsZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgY2hlY2sgPSBmYWxzZTtcbiAgKGZ1bmN0aW9uKGEpe2lmKC8oYW5kcm9pZHxiYlxcZCt8bWVlZ28pLittb2JpbGV8YXZhbnRnb3xiYWRhXFwvfGJsYWNrYmVycnl8YmxhemVyfGNvbXBhbHxlbGFpbmV8ZmVubmVjfGhpcHRvcHxpZW1vYmlsZXxpcChob25lfG9kKXxpcmlzfGtpbmRsZXxsZ2UgfG1hZW1vfG1pZHB8bW1wfG1vYmlsZS4rZmlyZWZveHxuZXRmcm9udHxvcGVyYSBtKG9ifGluKWl8cGFsbSggb3MpP3xwaG9uZXxwKGl4aXxyZSlcXC98cGx1Y2tlcnxwb2NrZXR8cHNwfHNlcmllcyg0fDYpMHxzeW1iaWFufHRyZW98dXBcXC4oYnJvd3NlcnxsaW5rKXx2b2RhZm9uZXx3YXB8d2luZG93cyBjZXx4ZGF8eGlpbm8vaS50ZXN0KGEpfHwvMTIwN3w2MzEwfDY1OTB8M2dzb3w0dGhwfDUwWzEtNl1pfDc3MHN8ODAyc3xhIHdhfGFiYWN8YWMoZXJ8b298c1xcLSl8YWkoa298cm4pfGFsKGF2fGNhfGNvKXxhbW9pfGFuKGV4fG55fHl3KXxhcHR1fGFyKGNofGdvKXxhcyh0ZXx1cyl8YXR0d3xhdShkaXxcXC1tfHIgfHMgKXxhdmFufGJlKGNrfGxsfG5xKXxiaShsYnxyZCl8YmwoYWN8YXopfGJyKGV8dil3fGJ1bWJ8YndcXC0obnx1KXxjNTVcXC98Y2FwaXxjY3dhfGNkbVxcLXxjZWxsfGNodG18Y2xkY3xjbWRcXC18Y28obXB8bmQpfGNyYXd8ZGEoaXR8bGx8bmcpfGRidGV8ZGNcXC1zfGRldml8ZGljYXxkbW9ifGRvKGN8cClvfGRzKDEyfFxcLWQpfGVsKDQ5fGFpKXxlbShsMnx1bCl8ZXIoaWN8azApfGVzbDh8ZXooWzQtN10wfG9zfHdhfHplKXxmZXRjfGZseShcXC18Xyl8ZzEgdXxnNTYwfGdlbmV8Z2ZcXC01fGdcXC1tb3xnbyhcXC53fG9kKXxncihhZHx1bil8aGFpZXxoY2l0fGhkXFwtKG18cHx0KXxoZWlcXC18aGkocHR8dGEpfGhwKCBpfGlwKXxoc1xcLWN8aHQoYyhcXC18IHxffGF8Z3xwfHN8dCl8dHApfGh1KGF3fHRjKXxpXFwtKDIwfGdvfG1hKXxpMjMwfGlhYyggfFxcLXxcXC8pfGlicm98aWRlYXxpZzAxfGlrb218aW0xa3xpbm5vfGlwYXF8aXJpc3xqYSh0fHYpYXxqYnJvfGplbXV8amlnc3xrZGRpfGtlaml8a2d0KCB8XFwvKXxrbG9ufGtwdCB8a3djXFwtfGt5byhjfGspfGxlKG5vfHhpKXxsZyggZ3xcXC8oa3xsfHUpfDUwfDU0fFxcLVthLXddKXxsaWJ3fGx5bnh8bTFcXC13fG0zZ2F8bTUwXFwvfG1hKHRlfHVpfHhvKXxtYygwMXwyMXxjYSl8bVxcLWNyfG1lKHJjfHJpKXxtaShvOHxvYXx0cyl8bW1lZnxtbygwMXwwMnxiaXxkZXxkb3x0KFxcLXwgfG98dil8enopfG10KDUwfHAxfHYgKXxtd2JwfG15d2F8bjEwWzAtMl18bjIwWzItM118bjMwKDB8Mil8bjUwKDB8Mnw1KXxuNygwKDB8MSl8MTApfG5lKChjfG0pXFwtfG9ufHRmfHdmfHdnfHd0KXxub2soNnxpKXxuenBofG8yaW18b3AodGl8d3YpfG9yYW58b3dnMXxwODAwfHBhbihhfGR8dCl8cGR4Z3xwZygxM3xcXC0oWzEtOF18YykpfHBoaWx8cGlyZXxwbChheXx1Yyl8cG5cXC0yfHBvKGNrfHJ0fHNlKXxwcm94fHBzaW98cHRcXC1nfHFhXFwtYXxxYygwN3wxMnwyMXwzMnw2MHxcXC1bMi03XXxpXFwtKXxxdGVrfHIzODB8cjYwMHxyYWtzfHJpbTl8cm8odmV8em8pfHM1NVxcL3xzYShnZXxtYXxtbXxtc3xueXx2YSl8c2MoMDF8aFxcLXxvb3xwXFwtKXxzZGtcXC98c2UoYyhcXC18MHwxKXw0N3xtY3xuZHxyaSl8c2doXFwtfHNoYXJ8c2llKFxcLXxtKXxza1xcLTB8c2woNDV8aWQpfHNtKGFsfGFyfGIzfGl0fHQ1KXxzbyhmdHxueSl8c3AoMDF8aFxcLXx2XFwtfHYgKXxzeSgwMXxtYil8dDIoMTh8NTApfHQ2KDAwfDEwfDE4KXx0YShndHxsayl8dGNsXFwtfHRkZ1xcLXx0ZWwoaXxtKXx0aW1cXC18dFxcLW1vfHRvKHBsfHNoKXx0cyg3MHxtXFwtfG0zfG01KXx0eFxcLTl8dXAoXFwuYnxnMXxzaSl8dXRzdHx2NDAwfHY3NTB8dmVyaXx2aShyZ3x0ZSl8dmsoNDB8NVswLTNdfFxcLXYpfHZtNDB8dm9kYXx2dWxjfHZ4KDUyfDUzfDYwfDYxfDcwfDgwfDgxfDgzfDg1fDk4KXx3M2MoXFwtfCApfHdlYmN8d2hpdHx3aShnIHxuY3xudyl8d21sYnx3b251fHg3MDB8eWFzXFwtfHlvdXJ8emV0b3x6dGVcXC0vaS50ZXN0KGEuc3Vic3RyKDAsNCkpKWNoZWNrID0gdHJ1ZX0pKG5hdmlnYXRvci51c2VyQWdlbnR8fG5hdmlnYXRvci52ZW5kb3J8fHdpbmRvdy5vcGVyYSk7XG4gIHJldHVybiBjaGVjaztcbn07XG5cblV0aWwuaXNGaXJlZm94ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAvZmlyZWZveC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG59O1xuXG5VdGlsLmlzSU9TID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAvKGlQYWR8aVBob25lfGlQb2QpL2cudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbn07XG5cblV0aWwuaXNJRnJhbWUgPSBmdW5jdGlvbigpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gd2luZG93LnNlbGYgIT09IHdpbmRvdy50b3A7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufTtcblxuVXRpbC5hcHBlbmRRdWVyeVBhcmFtZXRlciA9IGZ1bmN0aW9uKHVybCwga2V5LCB2YWx1ZSkge1xuICAvLyBEZXRlcm1pbmUgZGVsaW1pdGVyIGJhc2VkIG9uIGlmIHRoZSBVUkwgYWxyZWFkeSBHRVQgcGFyYW1ldGVycyBpbiBpdC5cbiAgdmFyIGRlbGltaXRlciA9ICh1cmwuaW5kZXhPZignPycpIDwgMCA/ICc/JyA6ICcmJyk7XG4gIHVybCArPSBkZWxpbWl0ZXIgKyBrZXkgKyAnPScgKyB2YWx1ZTtcbiAgcmV0dXJuIHVybDtcbn07XG5cbi8vIEZyb20gaHR0cDovL2dvby5nbC80V1gzdGdcblV0aWwuZ2V0UXVlcnlQYXJhbWV0ZXIgPSBmdW5jdGlvbihuYW1lKSB7XG4gIHZhciBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXS8sIFwiXFxcXFtcIikucmVwbGFjZSgvW1xcXV0vLCBcIlxcXFxdXCIpO1xuICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiW1xcXFw/Jl1cIiArIG5hbWUgKyBcIj0oW14mI10qKVwiKSxcbiAgICAgIHJlc3VsdHMgPSByZWdleC5leGVjKGxvY2F0aW9uLnNlYXJjaCk7XG4gIHJldHVybiByZXN1bHRzID09PSBudWxsID8gXCJcIiA6IGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzFdLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpO1xufTtcblxuVXRpbC5pc0xhbmRzY2FwZU1vZGUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICh3aW5kb3cub3JpZW50YXRpb24gPT0gOTAgfHwgd2luZG93Lm9yaWVudGF0aW9uID09IC05MCk7XG59O1xuXG5VdGlsLmdldFNjcmVlbldpZHRoID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBNYXRoLm1heCh3aW5kb3cuc2NyZWVuLndpZHRoLCB3aW5kb3cuc2NyZWVuLmhlaWdodCkgKlxuICAgICAgd2luZG93LmRldmljZVBpeGVsUmF0aW87XG59O1xuXG5VdGlsLmdldFNjcmVlbkhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gTWF0aC5taW4od2luZG93LnNjcmVlbi53aWR0aCwgd2luZG93LnNjcmVlbi5oZWlnaHQpICpcbiAgICAgIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlsO1xuXG59LHt9XSw1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8qXG4gKiBDb3B5cmlnaHQgMjAxNSBHb29nbGUgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbnZhciBCdXR0b25NYW5hZ2VyID0gX2RlcmVxXygnLi9idXR0b24tbWFuYWdlci5qcycpO1xudmFyIEVtaXR0ZXIgPSBfZGVyZXFfKCcuL2VtaXR0ZXIuanMnKTtcbnZhciBNb2RlcyA9IF9kZXJlcV8oJy4vbW9kZXMuanMnKTtcbnZhciBVdGlsID0gX2RlcmVxXygnLi91dGlsLmpzJyk7XG5cbi8qKlxuICogSGVscGVyIGZvciBnZXR0aW5nIGluIGFuZCBvdXQgb2YgVlIgbW9kZS5cbiAqL1xuZnVuY3Rpb24gV2ViVlJNYW5hZ2VyKHJlbmRlcmVyLCBlZmZlY3QsIHBhcmFtcykge1xuICB0aGlzLnBhcmFtcyA9IHBhcmFtcyB8fCB7fTtcblxuICB0aGlzLm1vZGUgPSBNb2Rlcy5VTktOT1dOO1xuXG4gIC8vIFNldCBvcHRpb24gdG8gaGlkZSB0aGUgYnV0dG9uLlxuICB0aGlzLmhpZGVCdXR0b24gPSB0aGlzLnBhcmFtcy5oaWRlQnV0dG9uIHx8IGZhbHNlO1xuICAvLyBXaGV0aGVyIG9yIG5vdCB0aGUgRk9WIHNob3VsZCBiZSBkaXN0b3J0ZWQgb3IgdW4tZGlzdG9ydGVkLiBCeSBkZWZhdWx0LCBpdFxuICAvLyBzaG91bGQgYmUgZGlzdG9ydGVkLCBidXQgaW4gdGhlIGNhc2Ugb2YgdmVydGV4IHNoYWRlciBiYXNlZCBkaXN0b3J0aW9uLFxuICAvLyBlbnN1cmUgdGhhdCB3ZSB1c2UgdW5kaXN0b3J0ZWQgcGFyYW1ldGVycy5cbiAgdGhpcy5wcmVkaXN0b3J0ZWQgPSAhIXRoaXMucGFyYW1zLnByZWRpc3RvcnRlZDtcblxuICAvLyBTYXZlIHRoZSBUSFJFRS5qcyByZW5kZXJlciBhbmQgZWZmZWN0IGZvciBsYXRlci5cbiAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB0aGlzLmVmZmVjdCA9IGVmZmVjdDtcbiAgdmFyIHBvbHlmaWxsV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWJ2ci1wb2x5ZmlsbC1mdWxsc2NyZWVuLXdyYXBwZXInKTtcbiAgdGhpcy5idXR0b24gPSBuZXcgQnV0dG9uTWFuYWdlcihwb2x5ZmlsbFdyYXBwZXIpO1xuXG4gIHRoaXMuaXNGdWxsc2NyZWVuRGlzYWJsZWQgPSAhIVV0aWwuZ2V0UXVlcnlQYXJhbWV0ZXIoJ25vX2Z1bGxzY3JlZW4nKTtcbiAgdGhpcy5zdGFydE1vZGUgPSBNb2Rlcy5OT1JNQUw7XG4gIHZhciBzdGFydE1vZGVQYXJhbSA9IHBhcnNlSW50KFV0aWwuZ2V0UXVlcnlQYXJhbWV0ZXIoJ3N0YXJ0X21vZGUnKSk7XG4gIGlmICghaXNOYU4oc3RhcnRNb2RlUGFyYW0pKSB7XG4gICAgdGhpcy5zdGFydE1vZGUgPSBzdGFydE1vZGVQYXJhbTtcbiAgfVxuXG4gIGlmICh0aGlzLmhpZGVCdXR0b24pIHtcbiAgICB0aGlzLmJ1dHRvbi5zZXRWaXNpYmlsaXR5KGZhbHNlKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIHRoZSBicm93c2VyIGlzIGNvbXBhdGlibGUgd2l0aCBXZWJWUi5cbiAgdGhpcy5nZXREZXZpY2VCeVR5cGVfKFZSRGlzcGxheSkudGhlbihmdW5jdGlvbihobWQpIHtcbiAgICB0aGlzLmhtZCA9IGhtZDtcblxuICAgIC8vIE9ubHkgZW5hYmxlIFZSIG1vZGUgaWYgdGhlcmUncyBhIFZSIGRldmljZSBhdHRhY2hlZCBvciB3ZSBhcmUgcnVubmluZyB0aGVcbiAgICAvLyBwb2x5ZmlsbCBvbiBtb2JpbGUuXG4gICAgaWYgKCF0aGlzLmlzVlJDb21wYXRpYmxlT3ZlcnJpZGUpIHtcbiAgICAgIHRoaXMuaXNWUkNvbXBhdGlibGUgPSAgIWhtZC5pc1BvbHlmaWxsZWQgfHwgVXRpbC5pc01vYmlsZSgpO1xuICAgIH1cblxuICAgIHN3aXRjaCAodGhpcy5zdGFydE1vZGUpIHtcbiAgICAgIGNhc2UgTW9kZXMuTUFHSUNfV0lORE9XOlxuICAgICAgICB0aGlzLnNldE1vZGVfKE1vZGVzLk1BR0lDX1dJTkRPVyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBNb2Rlcy5WUjpcbiAgICAgICAgdGhpcy5lbnRlclZSTW9kZV8oKTtcbiAgICAgICAgdGhpcy5zZXRNb2RlXyhNb2Rlcy5WUik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhpcy5zZXRNb2RlXyhNb2Rlcy5OT1JNQUwpO1xuICAgIH1cblxuICAgIHRoaXMuZW1pdCgnaW5pdGlhbGl6ZWQnKTtcbiAgfS5iaW5kKHRoaXMpKTtcblxuICAvLyBIb29rIHVwIGJ1dHRvbiBsaXN0ZW5lcnMuXG4gIHRoaXMuYnV0dG9uLm9uKCdmcycsIHRoaXMub25GU0NsaWNrXy5iaW5kKHRoaXMpKTtcbiAgdGhpcy5idXR0b24ub24oJ3ZyJywgdGhpcy5vblZSQ2xpY2tfLmJpbmQodGhpcykpO1xuXG4gIC8vIEJpbmQgdG8gZnVsbHNjcmVlbiBldmVudHMuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLFxuICAgICAgdGhpcy5vbkZ1bGxzY3JlZW5DaGFuZ2VfLmJpbmQodGhpcykpO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3pmdWxsc2NyZWVuY2hhbmdlJyxcbiAgICAgIHRoaXMub25GdWxsc2NyZWVuQ2hhbmdlXy5iaW5kKHRoaXMpKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbXNmdWxsc2NyZWVuY2hhbmdlJyxcbiAgICAgIHRoaXMub25GdWxsc2NyZWVuQ2hhbmdlXy5iaW5kKHRoaXMpKTtcblxuICAvLyBCaW5kIHRvIFZSKiBzcGVjaWZpYyBldmVudHMuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd2cmRpc3BsYXlwcmVzZW50Y2hhbmdlJyxcbiAgICAgIHRoaXMub25WUkRpc3BsYXlQcmVzZW50Q2hhbmdlXy5iaW5kKHRoaXMpKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3ZyZGlzcGxheWRldmljZXBhcmFtc2NoYW5nZScsXG4gICAgICB0aGlzLm9uVlJEaXNwbGF5RGV2aWNlUGFyYW1zQ2hhbmdlXy5iaW5kKHRoaXMpKTtcbn1cblxuV2ViVlJNYW5hZ2VyLnByb3RvdHlwZSA9IG5ldyBFbWl0dGVyKCk7XG5cbi8vIEV4cG9zZSB0aGVzZSB2YWx1ZXMgZXh0ZXJuYWxseS5cbldlYlZSTWFuYWdlci5Nb2RlcyA9IE1vZGVzO1xuXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKHNjZW5lLCBjYW1lcmEsIHRpbWVzdGFtcCkge1xuICAvLyBTY2VuZSBtYXkgYmUgYW4gYXJyYXkgb2YgdHdvIHNjZW5lcywgb25lIGZvciBlYWNoIGV5ZS5cbiAgaWYgKHNjZW5lIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICB0aGlzLmVmZmVjdC5yZW5kZXIoc2NlbmVbMF0sIGNhbWVyYSk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5lZmZlY3QucmVuZGVyKHNjZW5lLCBjYW1lcmEpO1xuICB9XG59O1xuXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLnNldFZSQ29tcGF0aWJsZU92ZXJyaWRlID0gZnVuY3Rpb24oaXNWUkNvbXBhdGlibGUpIHtcbiAgdGhpcy5pc1ZSQ29tcGF0aWJsZSA9IGlzVlJDb21wYXRpYmxlO1xuICB0aGlzLmlzVlJDb21wYXRpYmxlT3ZlcnJpZGUgPSB0cnVlO1xuXG4gIC8vIERvbid0IGFjdHVhbGx5IGNoYW5nZSBtb2RlcywganVzdCB1cGRhdGUgdGhlIGJ1dHRvbnMuXG4gIHRoaXMuYnV0dG9uLnNldE1vZGUodGhpcy5tb2RlLCB0aGlzLmlzVlJDb21wYXRpYmxlKTtcbn07XG5cbldlYlZSTWFuYWdlci5wcm90b3R5cGUuc2V0RnVsbHNjcmVlbkNhbGxiYWNrID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgdGhpcy5mdWxsc2NyZWVuQ2FsbGJhY2sgPSBjYWxsYmFjaztcbn07XG5cbldlYlZSTWFuYWdlci5wcm90b3R5cGUuc2V0VlJDYWxsYmFjayA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gIHRoaXMudnJDYWxsYmFjayA9IGNhbGxiYWNrO1xufTtcblxuV2ViVlJNYW5hZ2VyLnByb3RvdHlwZS5zZXRFeGl0RnVsbHNjcmVlbkNhbGxiYWNrID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgdGhpcy5leGl0RnVsbHNjcmVlbkNhbGxiYWNrID0gY2FsbGJhY2s7XG59XG5cbi8qKlxuICogUHJvbWlzZSByZXR1cm5zIHRydWUgaWYgdGhlcmUgaXMgYXQgbGVhc3Qgb25lIEhNRCBkZXZpY2UgYXZhaWxhYmxlLlxuICovXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLmdldERldmljZUJ5VHlwZV8gPSBmdW5jdGlvbih0eXBlKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBuYXZpZ2F0b3IuZ2V0VlJEaXNwbGF5cygpLnRoZW4oZnVuY3Rpb24oZGlzcGxheXMpIHtcbiAgICAgIC8vIFByb21pc2Ugc3VjY2VlZHMsIGJ1dCBjaGVjayBpZiB0aGVyZSBhcmUgYW55IGRpc3BsYXlzIGFjdHVhbGx5LlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkaXNwbGF5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZGlzcGxheXNbaV0gaW5zdGFuY2VvZiB0eXBlKSB7XG4gICAgICAgICAgcmVzb2x2ZShkaXNwbGF5c1tpXSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAvLyBObyBkaXNwbGF5cyBhcmUgZm91bmQuXG4gICAgICByZXNvbHZlKG51bGwpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbi8qKlxuICogSGVscGVyIGZvciBlbnRlcmluZyBWUiBtb2RlLlxuICovXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLmVudGVyVlJNb2RlXyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmhtZC5yZXF1ZXN0UHJlc2VudChbe1xuICAgIHNvdXJjZTogdGhpcy5yZW5kZXJlci5kb21FbGVtZW50LFxuICAgIHByZWRpc3RvcnRlZDogdGhpcy5wcmVkaXN0b3J0ZWRcbiAgfV0pO1xufTtcblxuV2ViVlJNYW5hZ2VyLnByb3RvdHlwZS5zZXRNb2RlXyA9IGZ1bmN0aW9uKG1vZGUpIHtcbiAgdmFyIG9sZE1vZGUgPSB0aGlzLm1vZGU7XG4gIGlmIChtb2RlID09IHRoaXMubW9kZSkge1xuICAgIGNvbnNvbGUud2FybignTm90IGNoYW5naW5nIG1vZGVzLCBhbHJlYWR5IGluICVzJywgbW9kZSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIGNvbnNvbGUubG9nKCdNb2RlIGNoYW5nZTogJXMgPT4gJXMnLCB0aGlzLm1vZGUsIG1vZGUpO1xuICB0aGlzLm1vZGUgPSBtb2RlO1xuICB0aGlzLmJ1dHRvbi5zZXRNb2RlKG1vZGUsIHRoaXMuaXNWUkNvbXBhdGlibGUpO1xuXG4gIC8vIEVtaXQgYW4gZXZlbnQgaW5kaWNhdGluZyB0aGUgbW9kZSBjaGFuZ2VkLlxuICB0aGlzLmVtaXQoJ21vZGVjaGFuZ2UnLCBtb2RlLCBvbGRNb2RlKTtcbn07XG5cbi8qKlxuICogTWFpbiBidXR0b24gd2FzIGNsaWNrZWQuXG4gKi9cbldlYlZSTWFuYWdlci5wcm90b3R5cGUub25GU0NsaWNrXyA9IGZ1bmN0aW9uKCkge1xuICBzd2l0Y2ggKHRoaXMubW9kZSkge1xuICAgIGNhc2UgTW9kZXMuTk9STUFMOlxuICAgICAgLy8gVE9ETzogUmVtb3ZlIHRoaXMgaGFjayBpZi93aGVuIGlPUyBnZXRzIHJlYWwgZnVsbHNjcmVlbiBtb2RlLlxuICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpZnJhbWUgb24gaU9TLCBicmVhayBvdXQgYW5kIG9wZW4gaW4gbm9fZnVsbHNjcmVlbiBtb2RlLlxuICAgICAgaWYgKFV0aWwuaXNJT1MoKSAmJiBVdGlsLmlzSUZyYW1lKCkpIHtcbiAgICAgICAgaWYgKHRoaXMuZnVsbHNjcmVlbkNhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy5mdWxsc2NyZWVuQ2FsbGJhY2soKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgICAgdXJsID0gVXRpbC5hcHBlbmRRdWVyeVBhcmFtZXRlcih1cmwsICdub19mdWxsc2NyZWVuJywgJ3RydWUnKTtcbiAgICAgICAgICB1cmwgPSBVdGlsLmFwcGVuZFF1ZXJ5UGFyYW1ldGVyKHVybCwgJ3N0YXJ0X21vZGUnLCBNb2Rlcy5NQUdJQ19XSU5ET1cpO1xuICAgICAgICAgIHRvcC5sb2NhdGlvbi5ocmVmID0gdXJsO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zZXRNb2RlXyhNb2Rlcy5NQUdJQ19XSU5ET1cpO1xuICAgICAgdGhpcy5yZXF1ZXN0RnVsbHNjcmVlbl8oKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgTW9kZXMuTUFHSUNfV0lORE9XOlxuICAgICAgaWYgKHRoaXMuaXNGdWxsc2NyZWVuRGlzYWJsZWQpIHtcbiAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5leGl0RnVsbHNjcmVlbkNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZXhpdEZ1bGxzY3JlZW5DYWxsYmFjaygpO1xuICAgICAgfVxuICAgICAgdGhpcy5zZXRNb2RlXyhNb2Rlcy5OT1JNQUwpO1xuICAgICAgdGhpcy5leGl0RnVsbHNjcmVlbl8oKTtcbiAgICAgIGJyZWFrO1xuICB9XG59O1xuXG4vKipcbiAqIFRoZSBWUiBidXR0b24gd2FzIGNsaWNrZWQuXG4gKi9cbldlYlZSTWFuYWdlci5wcm90b3R5cGUub25WUkNsaWNrXyA9IGZ1bmN0aW9uKCkge1xuICAvLyBUT0RPOiBSZW1vdmUgdGhpcyBoYWNrIHdoZW4gaU9TIGhhcyBmdWxsc2NyZWVuIG1vZGUuXG4gIC8vIElmIHRoaXMgaXMgYW4gaWZyYW1lIG9uIGlPUywgYnJlYWsgb3V0IGFuZCBvcGVuIGluIG5vX2Z1bGxzY3JlZW4gbW9kZS5cbiAgaWYgKHRoaXMubW9kZSA9PSBNb2Rlcy5OT1JNQUwgJiYgVXRpbC5pc0lPUygpICYmIFV0aWwuaXNJRnJhbWUoKSkge1xuICAgIGlmICh0aGlzLnZyQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMudnJDYWxsYmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG4gICAgICB1cmwgPSBVdGlsLmFwcGVuZFF1ZXJ5UGFyYW1ldGVyKHVybCwgJ25vX2Z1bGxzY3JlZW4nLCAndHJ1ZScpO1xuICAgICAgdXJsID0gVXRpbC5hcHBlbmRRdWVyeVBhcmFtZXRlcih1cmwsICdzdGFydF9tb2RlJywgTW9kZXMuVlIpO1xuICAgICAgdG9wLmxvY2F0aW9uLmhyZWYgPSB1cmw7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIHRoaXMuZW50ZXJWUk1vZGVfKCk7XG59O1xuXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLnJlcXVlc3RGdWxsc2NyZWVuXyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgY2FudmFzID0gZG9jdW1lbnQuYm9keTtcbiAgLy92YXIgY2FudmFzID0gdGhpcy5yZW5kZXJlci5kb21FbGVtZW50O1xuICBpZiAoY2FudmFzLnJlcXVlc3RGdWxsc2NyZWVuKSB7XG4gICAgY2FudmFzLnJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gIH0gZWxzZSBpZiAoY2FudmFzLm1velJlcXVlc3RGdWxsU2NyZWVuKSB7XG4gICAgY2FudmFzLm1velJlcXVlc3RGdWxsU2NyZWVuKCk7XG4gIH0gZWxzZSBpZiAoY2FudmFzLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKSB7XG4gICAgY2FudmFzLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gIH0gZWxzZSBpZiAoY2FudmFzLm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICBjYW52YXMubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xuICB9XG59O1xuXG5XZWJWUk1hbmFnZXIucHJvdG90eXBlLmV4aXRGdWxsc2NyZWVuXyA9IGZ1bmN0aW9uKCkge1xuICBpZiAoZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pIHtcbiAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xuICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcbiAgICBkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKCk7XG4gIH0gZWxzZSBpZiAoZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4pIHtcbiAgICBkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbigpO1xuICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4pIHtcbiAgICBkb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuKCk7XG4gIH1cbn07XG5cbldlYlZSTWFuYWdlci5wcm90b3R5cGUub25WUkRpc3BsYXlQcmVzZW50Q2hhbmdlXyA9IGZ1bmN0aW9uKGUpIHtcbiAgY29uc29sZS5sb2coJ29uVlJEaXNwbGF5UHJlc2VudENoYW5nZV8nLCBlKTtcbiAgaWYgKHRoaXMuaG1kLmlzUHJlc2VudGluZykge1xuICAgIHRoaXMuc2V0TW9kZV8oTW9kZXMuVlIpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuc2V0TW9kZV8oTW9kZXMuTk9STUFMKTtcbiAgfVxufTtcblxuV2ViVlJNYW5hZ2VyLnByb3RvdHlwZS5vblZSRGlzcGxheURldmljZVBhcmFtc0NoYW5nZV8gPSBmdW5jdGlvbihlKSB7XG4gIGNvbnNvbGUubG9nKCdvblZSRGlzcGxheURldmljZVBhcmFtc0NoYW5nZV8nLCBlKTtcbn07XG5cbldlYlZSTWFuYWdlci5wcm90b3R5cGUub25GdWxsc2NyZWVuQ2hhbmdlXyA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gSWYgd2UgbGVhdmUgZnVsbC1zY3JlZW4sIGdvIGJhY2sgdG8gbm9ybWFsIG1vZGUuXG4gIGlmIChkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCA9PT0gbnVsbCB8fFxuICAgICAgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgPT09IG51bGwpIHtcbiAgICB0aGlzLnNldE1vZGVfKE1vZGVzLk5PUk1BTCk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gV2ViVlJNYW5hZ2VyO1xuXG59LHtcIi4vYnV0dG9uLW1hbmFnZXIuanNcIjoxLFwiLi9lbWl0dGVyLmpzXCI6MixcIi4vbW9kZXMuanNcIjozLFwiLi91dGlsLmpzXCI6NH1dfSx7fSxbNV0pKDUpXG59KTsiLCJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSdcbmltcG9ydCBDb2xvcnMgZnJvbSAnLi9jb2xvcnMnXG5cbmNsYXNzIEFpclBsYW5lIHtcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHRoaXMubWVzaCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpXG5cbiAgICAvLyBDcmVhdGUgdGhlIGNhYmluXG4gICAgdmFyIGdlb21Db2NrcGl0VGFpbCA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSgxMzAsIDQwLCA0MCwgMSwgMSwgMSlcbiAgICB2YXIgbWF0Q29ja3BpdFRhaWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe2NvbG9yOiBDb2xvcnMuYWlycGxhbmUsIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nfSlcblxuICAgIC8vIHdlIGNhbiBhY2Nlc3MgYSBzcGVjaWZpYyB2ZXJ0ZXggb2YgYSBzaGFwZSB0aHJvdWdoXG4gICAgLy8gdGhlIHZlcnRpY2VzIGFycmF5LCBhbmQgdGhlbiBtb3ZlIGl0cyB4LCB5IGFuZCB6IHByb3BlcnR5OlxuICAgIGdlb21Db2NrcGl0VGFpbC52ZXJ0aWNlc1s0XS55IC09IDEwXG4gICAgZ2VvbUNvY2twaXRUYWlsLnZlcnRpY2VzWzRdLnogKz0gMjBcbiAgICBnZW9tQ29ja3BpdFRhaWwudmVydGljZXNbNV0ueSAtPSAxMFxuICAgIGdlb21Db2NrcGl0VGFpbC52ZXJ0aWNlc1s1XS56IC09IDIwXG4gICAgZ2VvbUNvY2twaXRUYWlsLnZlcnRpY2VzWzZdLnkgKz0gMzBcbiAgICBnZW9tQ29ja3BpdFRhaWwudmVydGljZXNbNl0ueiArPSAyMFxuICAgIGdlb21Db2NrcGl0VGFpbC52ZXJ0aWNlc1s3XS55ICs9IDMwXG4gICAgZ2VvbUNvY2twaXRUYWlsLnZlcnRpY2VzWzddLnogLT0gMjBcblxuICAgIHZhciBjb2NrcGl0VGFpbCA9IG5ldyBUSFJFRS5NZXNoKGdlb21Db2NrcGl0VGFpbCwgbWF0Q29ja3BpdFRhaWwpXG4gICAgY29ja3BpdFRhaWwuY2FzdFNoYWRvdyA9IHRydWVcbiAgICBjb2NrcGl0VGFpbC5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuICAgIGNvY2twaXRUYWlsLnBvc2l0aW9uLnNldCgtNzUsIDAsIDApXG4gICAgdGhpcy5tZXNoLmFkZChjb2NrcGl0VGFpbClcblxuICAgIHZhciBnZW9tQ29ja3BpdCA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSg0MCwgNDAsIDQwLCAxLCAxLCAxKVxuICAgIHZhciBtYXRDb2NrcGl0ID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtjb2xvcjogQ29sb3JzLmFpcnBsYW5lLCBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZ30pXG4gICAgdmFyIGNvY2twaXQgPSBuZXcgVEhSRUUuTWVzaChnZW9tQ29ja3BpdCwgbWF0Q29ja3BpdClcbiAgICBjb2NrcGl0LmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgY29ja3BpdC5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuICAgIGNvY2twaXQucG9zaXRpb24uc2V0KDEwLCAwLCAwKVxuICAgIHRoaXMubWVzaC5hZGQoY29ja3BpdClcblxuICAgIC8vIENyZWF0ZSB0aGUgZW5naW5lXG4gICAgdmFyIGdlb21FbmdpbmUgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMjAsIDQwLCA0MCwgMSwgMSwgMSlcbiAgICB2YXIgbWF0RW5naW5lID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtjb2xvcjogQ29sb3JzLndoaXRlLCBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZ30pXG4gICAgdmFyIGVuZ2luZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21FbmdpbmUsIG1hdEVuZ2luZSlcbiAgICBlbmdpbmUucG9zaXRpb24ueCA9IDQwXG4gICAgZW5naW5lLmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgZW5naW5lLnJlY2VpdmVTaGFkb3cgPSB0cnVlXG4gICAgdGhpcy5tZXNoLmFkZChlbmdpbmUpXG5cbiAgICAvLyBDcmVhdGUgdG9wIHdpbmdcbiAgICB2YXIgZ2VvbVRvcFdpbmcgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoNDAsIDIsIDIwMCwgMSwgMSwgMSlcbiAgICB2YXIgbWF0VG9wV2luZyA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7Y29sb3I6IENvbG9ycy5haXJwbGFuZSwgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmd9KVxuICAgIHZhciB0b3BXaW5nID0gbmV3IFRIUkVFLk1lc2goZ2VvbVRvcFdpbmcsIG1hdFRvcFdpbmcpXG4gICAgdG9wV2luZy5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgIHRvcFdpbmcucmVjZWl2ZVNoYWRvdyA9IHRydWVcbiAgICB0b3BXaW5nLnBvc2l0aW9uLnNldCgyMCwgNTAsIDApXG4gICAgdGhpcy5tZXNoLmFkZCh0b3BXaW5nKVxuXG4gICAgLy8gQ3JlYXRlIGJvdHRvbSB3aW5nXG4gICAgdmFyIGdlb21Cb3R0b21XaW5nID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDQwLCAyLCAyMDAsIDEsIDEsIDEpXG4gICAgdmFyIG1hdEJvdHRvbVdpbmcgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe2NvbG9yOiBDb2xvcnMuYWlycGxhbmUsIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nfSlcbiAgICB2YXIgYm90dG9tV2luZyA9IG5ldyBUSFJFRS5NZXNoKGdlb21Cb3R0b21XaW5nLCBtYXRCb3R0b21XaW5nKVxuICAgIGJvdHRvbVdpbmcuY2FzdFNoYWRvdyA9IHRydWVcbiAgICBib3R0b21XaW5nLnJlY2VpdmVTaGFkb3cgPSB0cnVlXG4gICAgYm90dG9tV2luZy5wb3NpdGlvbi5zZXQoMTAsIC0xMCwgMClcbiAgICB0aGlzLm1lc2guYWRkKGJvdHRvbVdpbmcpXG5cbiAgICAvLyBXaW5nIHN1cHBvcnQgMVxuICAgIHZhciBnZW9tV2luZ1N1cHBvcnQgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMiwgNjAsIDIsIDEsIDEsIDEpXG4gICAgdmFyIG1hdFdpbmdTdXBwb3J0ID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtjb2xvcjogQ29sb3JzLmFpcnBsYW5lLCBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZ30pXG4gICAgdmFyIHdpbmdTdXBwb3J0TGVmdCA9IG5ldyBUSFJFRS5NZXNoKGdlb21XaW5nU3VwcG9ydCwgbWF0V2luZ1N1cHBvcnQpXG4gICAgd2luZ1N1cHBvcnRMZWZ0LmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgd2luZ1N1cHBvcnRMZWZ0LnJlY2VpdmVTaGFkb3cgPSB0cnVlXG4gICAgd2luZ1N1cHBvcnRMZWZ0LnBvc2l0aW9uLnNldCgxNSwgMjAsIC04MClcbiAgICB0aGlzLm1lc2guYWRkKHdpbmdTdXBwb3J0TGVmdClcbiAgICB2YXIgd2luZ1N1cHBvcnRSaWdodCA9IG5ldyBUSFJFRS5NZXNoKGdlb21XaW5nU3VwcG9ydCwgbWF0V2luZ1N1cHBvcnQpXG4gICAgd2luZ1N1cHBvcnRSaWdodC5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgIHdpbmdTdXBwb3J0UmlnaHQucmVjZWl2ZVNoYWRvdyA9IHRydWVcbiAgICB3aW5nU3VwcG9ydFJpZ2h0LnBvc2l0aW9uLnNldCgxNSwgMjAsIDgwKVxuICAgIHRoaXMubWVzaC5hZGQod2luZ1N1cHBvcnRSaWdodClcblxuICAgIC8vIENyZWF0ZSB0aGUgdGFpbFxuICAgIHZhciBnZW9tVGFpbFBsYW5lID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDMwLCAyNSwgMiwgMSwgMSwgMSlcbiAgICB2YXIgbWF0VGFpbFBsYW5lID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtjb2xvcjogQ29sb3JzLmFpcnBsYW5lLCBzaGFkaW5nOiBUSFJFRS5GbGF0U2hhZGluZ30pXG4gICAgdmFyIHRhaWxQbGFuZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21UYWlsUGxhbmUsIG1hdFRhaWxQbGFuZSlcbiAgICB0YWlsUGxhbmUucG9zaXRpb24uc2V0KC0xMTUsIDIwLCAwKVxuICAgIHRhaWxQbGFuZS5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgIHRhaWxQbGFuZS5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuICAgIHRoaXMubWVzaC5hZGQodGFpbFBsYW5lKVxuXG4gICAgLy8gQ3JlYXRlIHRoZSB0YWlsIHdpbmdcbiAgICB2YXIgZ2VvbVRhaWxXaW5nID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDIwLCAyLCA2MCwgMSwgMSwgMSlcbiAgICB2YXIgbWF0VGFpbFdpbmcgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe2NvbG9yOiBDb2xvcnMuYWlycGxhbmUsIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nfSlcbiAgICB2YXIgdGFpbFdpbmcgPSBuZXcgVEhSRUUuTWVzaChnZW9tVGFpbFdpbmcsIG1hdFRhaWxXaW5nKVxuICAgIHRhaWxXaW5nLmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgdGFpbFdpbmcucmVjZWl2ZVNoYWRvdyA9IHRydWVcbiAgICB0YWlsV2luZy5wb3NpdGlvbi5zZXQoLTExMCwgMTEsIDApXG4gICAgdGhpcy5tZXNoLmFkZCh0YWlsV2luZylcblxuICAgIC8vIHByb3BlbGxlclxuICAgIHZhciBnZW9tUHJvcGVsbGVyID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDIwLCAxMCwgMTAsIDEsIDEsIDEpXG4gICAgZ2VvbVByb3BlbGxlci52ZXJ0aWNlc1s0XS55IC09IDVcbiAgICBnZW9tUHJvcGVsbGVyLnZlcnRpY2VzWzRdLnogKz0gNVxuICAgIGdlb21Qcm9wZWxsZXIudmVydGljZXNbNV0ueSAtPSA1XG4gICAgZ2VvbVByb3BlbGxlci52ZXJ0aWNlc1s1XS56IC09IDVcbiAgICBnZW9tUHJvcGVsbGVyLnZlcnRpY2VzWzZdLnkgKz0gNVxuICAgIGdlb21Qcm9wZWxsZXIudmVydGljZXNbNl0ueiArPSA1XG4gICAgZ2VvbVByb3BlbGxlci52ZXJ0aWNlc1s3XS55ICs9IDVcbiAgICBnZW9tUHJvcGVsbGVyLnZlcnRpY2VzWzddLnogLT0gNVxuICAgIHZhciBtYXRQcm9wZWxsZXIgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoe2NvbG9yOiBDb2xvcnMuYnJvd24sIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nfSlcbiAgICB0aGlzLnByb3BlbGxlciA9IG5ldyBUSFJFRS5NZXNoKGdlb21Qcm9wZWxsZXIsIG1hdFByb3BlbGxlcilcblxuICAgIHRoaXMucHJvcGVsbGVyLmNhc3RTaGFkb3cgPSB0cnVlXG4gICAgdGhpcy5wcm9wZWxsZXIucmVjZWl2ZVNoYWRvdyA9IHRydWVcblxuICAgIHZhciBnZW9tQmxhZGUgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoMSwgODAsIDEwLCAxLCAxLCAxKVxuICAgIHZhciBtYXRCbGFkZSA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7Y29sb3I6IENvbG9ycy5icm93bkRhcmssIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nfSlcbiAgICB2YXIgYmxhZGUxID0gbmV3IFRIUkVFLk1lc2goZ2VvbUJsYWRlLCBtYXRCbGFkZSlcbiAgICBibGFkZTEucG9zaXRpb24uc2V0KDgsIDAsIDApXG5cbiAgICBibGFkZTEuY2FzdFNoYWRvdyA9IHRydWVcbiAgICBibGFkZTEucmVjZWl2ZVNoYWRvdyA9IHRydWVcblxuICAgIHZhciBibGFkZTIgPSBibGFkZTEuY2xvbmUoKVxuICAgIGJsYWRlMi5yb3RhdGlvbi54ID0gTWF0aC5QSSAvIDJcblxuICAgIGJsYWRlMi5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgIGJsYWRlMi5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuXG4gICAgdGhpcy5wcm9wZWxsZXIuYWRkKGJsYWRlMSlcbiAgICB0aGlzLnByb3BlbGxlci5hZGQoYmxhZGUyKVxuICAgIHRoaXMucHJvcGVsbGVyLnBvc2l0aW9uLnNldCg1MCwgMCwgMClcbiAgICB0aGlzLm1lc2guYWRkKHRoaXMucHJvcGVsbGVyKVxuXG4gICAgLy8gcm90YXRlIHRoZSBnZW9tZXRyeSBvbiB0aGUgWSBheGlzIGF3YXkgZnJvbSB0aGUgY2FtZXJhXG4gICAgdGhpcy5tZXNoLmFwcGx5TWF0cml4KG5ldyBUSFJFRS5NYXRyaXg0KCkubWFrZVJvdGF0aW9uWShNYXRoLlBJIC8gMikpXG5cbiAgICAvLyBjaGFuZ2Ugcm90YXRpb24gb3JkZXIgdG8gYXZvaWQgZ2ltYmFsIGxvY2tcbiAgICB0aGlzLm1lc2gucm90YXRpb24ub3JkZXIgPSAnWlhZJ1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFpclBsYW5lXG4iLCJpbXBvcnQgKiBhcyBUSFJFRSBmcm9tICd0aHJlZSdcbmltcG9ydCBDb2xvcnMgZnJvbSAnLi9jb2xvcnMnXG5cbmNsYXNzIENsb3VkIHtcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIC8vIENyZWF0ZSBhbiBlbXB0eSBjb250YWluZXIgdGhhdCB3aWxsIGhvbGQgdGhlIGRpZmZlcmVudCBwYXJ0cyBvZiB0aGUgY2xvdWRcbiAgICB0aGlzLm1lc2ggPSBuZXcgVEhSRUUuT2JqZWN0M0QoKVxuXG4gICAgLy8gY3JlYXRlIGEgY3ViZSBnZW9tZXRyeVxuICAgIC8vIHRoaXMgc2hhcGUgd2lsbCBiZSBkdXBsaWNhdGVkIHRvIGNyZWF0ZSB0aGUgY2xvdWRcbiAgICAvLyBjb25zdCBnZW9tID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDIwLCAyMCwgMjApXG4gICAgY29uc3QgZ2VvbSA9IG5ldyBUSFJFRS5TcGhlcmVHZW9tZXRyeSgyMCwgNiwgNilcblxuICAgIC8vIGNyZWF0ZSBhIG1hdGVyaWFsIGEgc2ltcGxlIHdoaXRlIG1hdGVyaWFsIHdpbGwgZG8gdGhlIHRyaWNrXG4gICAgY29uc3QgbWF0ID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKHtcbiAgICAgIGNvbG9yOiBDb2xvcnMud2hpdGUsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIG9wYWNpdHk6IDAuOSxcbiAgICAgIHNoYWRpbmc6IFRIUkVFLkZsYXRTaGFkaW5nXG4gICAgfSlcblxuICAgIC8vIGR1cGxpY2F0ZSB0aGUgZ2VvbWV0cnkgYSByYW5kb20gbnVtYmVyIG9mIHRpbWVzXG4gICAgY29uc3QgbkJsb2NzID0gNSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIwKVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbkJsb2NzOyBpKyspIHtcbiAgICAgIC8vIGNyZWF0ZSB0aGUgbWVzaCBieSBjbG9uaW5nIHRoZSBnZW9tZXRyeVxuICAgICAgY29uc3QgbSA9IG5ldyBUSFJFRS5NZXNoKGdlb20sIG1hdClcblxuICAgICAgLy8gc2V0IHRoZSBwb3NpdGlvbiBhbmQgdGhlIHJvdGF0aW9uIG9mIGVhY2ggY3ViZSByYW5kb21seVxuICAgICAgbS5wb3NpdGlvbi54ID0gaSAqICgxNSAqIE1hdGgucmFuZG9tKCkpXG4gICAgICBtLnBvc2l0aW9uLnkgPSBNYXRoLnJhbmRvbSgpICogMTBcbiAgICAgIG0ucG9zaXRpb24ueiA9IE1hdGgucmFuZG9tKCkgKiAyMFxuICAgICAgbS5yb3RhdGlvbi56ID0gTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyXG4gICAgICBtLnJvdGF0aW9uLnkgPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDJcblxuICAgICAgLy8gc2V0IHRoZSBzaXplIG9mIHRoZSBjdWJlIHJhbmRvbWx5XG4gICAgICBjb25zdCBzID0gMC4yICsgTWF0aC5yYW5kb20oKSAqIDAuOFxuICAgICAgbS5zY2FsZS5zZXQocywgcywgcylcblxuICAgICAgLy8gYWxsb3cgZWFjaCBjdWJlIHRvIGNhc3QgYW5kIHRvIHJlY2VpdmUgc2hhZG93c1xuICAgICAgbS5jYXN0U2hhZG93ID0gdHJ1ZVxuICAgICAgbS5yZWNlaXZlU2hhZG93ID0gdHJ1ZVxuXG4gICAgICAvLyBhZGQgdGhlIGN1YmUgdG8gdGhlIGNvbnRhaW5lciB3ZSBmaXJzdCBjcmVhdGVkXG4gICAgICB0aGlzLm1lc2guYWRkKG0pXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENsb3VkXG4iLCJjb25zdCBDb2xvcnMgPSB7XG4gIGFpcnBsYW5lOiAweGI3ZDAyZSxcbiAgd2hpdGU6IDB4ZThlMGUxLFxuICBicm93bjogMHg1OTMzMmUsXG4gIGJyb3duRGFyazogMHgyMzE5MGYsXG4gIHdhdGVyOiAweDAwNjQ1N1xufVxuXG5leHBvcnQgZGVmYXVsdCBDb2xvcnNcbiIsImltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJ1xuaW1wb3J0IFNreSBmcm9tICcuL3NreSdcbmltcG9ydCBBaXJQbGFuZSBmcm9tICcuL2FpcnBsYW5lJ1xuaW1wb3J0IFNlYSBmcm9tICcuL3NlYSdcblxuLy8gbG9hZCBzaGltbWVkIHBsdWdpbnMgLSBhY2Nlc3Mgb24gVEhSRUUgbmFtZXNwYWNlXG5pbXBvcnQgX1ZSQ29udHJvbHMgZnJvbSAnVlJDb250cm9scydcbmltcG9ydCBfVlJFZmZlY3QgZnJvbSAnVlJFZmZlY3QnXG5pbXBvcnQgX1ZpdmVDb250cm9sbGVyIGZyb20gJ1ZpdmVDb250cm9sbGVyJ1xuXG5pbXBvcnQgV2ViVlJNYW5hZ2VyLCB7TW9kZXN9IGZyb20gJ3dlYnZyLWJvaWxlcnBsYXRlJ1xuXG5sZXQgc2NlbmUsXG4gIGNhbWVyYSwgZmllbGRPZlZpZXcsIGFzcGVjdFJhdGlvLCBuZWFyUGxhbmUsIGZhclBsYW5lLCBIRUlHSFQsIFdJRFRILFxuICByZW5kZXJlciwgY29udGFpbmVyLCBzZWEsIGNvbnRyb2xzLCB2cmNvbnRyb2xzLCBza3ksIGFpcnBsYW5lLCBlZmZlY3QsIG1hbmFnZXIsIGRvbGx5Q2FtLCB2aXZlQ29udHJvbGxlciwgd29ybGRcblxubGV0IHR1cm5TcGVlZCA9IDBcbmxldCBjb21wYXNzSGVhZGluZyA9IDBcblxubGV0IG1vdXNlRHJhZ2dpbmcgPSBmYWxzZVxuXG5jb25zdCBjbG9jayA9IG5ldyBUSFJFRS5DbG9jaygpXG5cbmNvbnN0IHBsYW5lU3RhcnRZID0gMjAwXG5jb25zdCBwbGFuZVN0YXJ0WiA9IDBcbmNvbnN0IGNhbWVyYVN0YXJ0WiA9IDEwMFxuXG5jb25zdCBHUk9VTkRfRElBTUVURVIgPSAyMDAwXG5cbmZ1bmN0aW9uIGNyZWF0ZVNjZW5lICgpIHtcbiAgLy8gR2V0IHRoZSB3aWR0aCBhbmQgdGhlIGhlaWdodCBvZiB0aGUgc2NyZWVuLFxuICAvLyB1c2UgdGhlbSB0byBzZXQgdXAgdGhlIGFzcGVjdCByYXRpbyBvZiB0aGUgY2FtZXJhXG4gIC8vIGFuZCB0aGUgc2l6ZSBvZiB0aGUgcmVuZGVyZXIuXG4gIEhFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodFxuICBXSURUSCA9IHdpbmRvdy5pbm5lcldpZHRoXG5cbiAgLy8gQ3JlYXRlIHRoZSBzY2VuZVxuICBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpXG5cbiAgLy8gQWRkIGEgZm9nIGVmZmVjdCB0byB0aGUgc2NlbmUgdXNpbmcgc2ltaWxhciBjb2xvciBhcyBiYWNrZ3JvdW5kXG4gIHNjZW5lLmZvZyA9IG5ldyBUSFJFRS5Gb2coMHhjNmNjZWIsIDIwMCwgR1JPVU5EX0RJQU1FVEVSIC8gMilcblxuICAvLyBDcmVhdGUgdGhlIGNhbWVyYVxuICBhc3BlY3RSYXRpbyA9IFdJRFRIIC8gSEVJR0hUXG4gIGZpZWxkT2ZWaWV3ID0gNjBcbiAgbmVhclBsYW5lID0gMVxuICBmYXJQbGFuZSA9IDEwMDAwXG4gIGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYShcbiAgICBmaWVsZE9mVmlldyxcbiAgICBhc3BlY3RSYXRpbyxcbiAgICBuZWFyUGxhbmUsXG4gICAgZmFyUGxhbmVcbiAgKVxuXG4gIC8vIENyZWF0ZSB0aGUgcmVuZGVyZXJcbiAgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7XG4gICAgLy8gQWxsb3cgdHJhbnNwYXJlbmN5IHRvIHNob3cgdGhlIGdyYWRpZW50IGJhY2tncm91bmRcbiAgICAvLyB3ZSBkZWZpbmVkIGluIHRoZSBDU1NcbiAgICBhbHBoYTogdHJ1ZSxcbiAgICAvLyBBY3RpdmF0ZSB0aGUgYW50aS1hbGlhc2luZyB0aGlzIGlzIGxlc3MgcGVyZm9ybWFudCxcbiAgICAvLyBidXQsIGFzIG91ciBwcm9qZWN0IGlzIGxvdy1wb2x5IGJhc2VkLCBpdCBzaG91bGQgYmUgZmluZSA6KVxuICAgIGFudGlhbGlhczogdHJ1ZVxuICB9KVxuXG4gIC8vIERlZmluZSB0aGUgc2l6ZSBvZiB0aGUgcmVuZGVyZXIgaW4gdGhpcyBjYXNlLFxuICAvLyBpdCB3aWxsIGZpbGwgdGhlIGVudGlyZSBzY3JlZW5cbiAgcmVuZGVyZXIuc2V0U2l6ZShXSURUSCwgSEVJR0hUKVxuXG4gIC8vIEVuYWJsZSBzaGFkb3cgcmVuZGVyaW5nXG4gIHJlbmRlcmVyLnNoYWRvd01hcC5lbmFibGVkID0gdHJ1ZVxuXG4gIC8vIEFkZCB0aGUgRE9NIGVsZW1lbnQgb2YgdGhlIHJlbmRlcmVyIHRvIHRoZVxuICAvLyBjb250YWluZXIgd2UgY3JlYXRlZCBpbiB0aGUgSFRNTFxuICBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd29ybGQnKVxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmVuZGVyZXIuZG9tRWxlbWVudClcblxuICAvLyBMaXN0ZW4gdG8gdGhlIHNjcmVlbjogaWYgdGhlIHVzZXIgcmVzaXplcyBpdFxuICAvLyB3ZSBoYXZlIHRvIHVwZGF0ZSB0aGUgY2FtZXJhIGFuZCB0aGUgcmVuZGVyZXIgc2l6ZVxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgaGFuZGxlV2luZG93UmVzaXplLCBmYWxzZSlcbn1cblxuZnVuY3Rpb24gaGFuZGxlV2luZG93UmVzaXplICgpIHtcbiAgLy8gdXBkYXRlIGhlaWdodCBhbmQgd2lkdGggb2YgdGhlIHJlbmRlcmVyIGFuZCB0aGUgY2FtZXJhXG4gIEhFSUdIVCA9IHdpbmRvdy5pbm5lckhlaWdodFxuICBXSURUSCA9IHdpbmRvdy5pbm5lcldpZHRoXG4gIGVmZmVjdC5zZXRTaXplKFdJRFRILCBIRUlHSFQpXG4gIHJlbmRlcmVyLnNldFNpemUoV0lEVEgsIEhFSUdIVClcbiAgY2FtZXJhLmFzcGVjdCA9IFdJRFRIIC8gSEVJR0hUXG4gIGNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KClcbn1cblxuZnVuY3Rpb24gY3JlYXRlTGlnaHRzICgpIHtcbiAgbGV0IGhlbWlzcGhlcmVMaWdodCwgc2hhZG93TGlnaHQsIGFtYmllbnRMaWdodFxuXG4gIC8vIEEgaGVtaXNwaGVyZSBsaWdodCBpcyBhIGdyYWRpZW50IGNvbG9yZWQgbGlnaHRcbiAgLy8gdGhlIGZpcnN0IHBhcmFtZXRlciBpcyB0aGUgc2t5IGNvbG9yLCB0aGUgc2Vjb25kIHBhcmFtZXRlciBpcyB0aGUgZ3JvdW5kIGNvbG9yLFxuICAvLyB0aGUgdGhpcmQgcGFyYW1ldGVyIGlzIHRoZSBpbnRlbnNpdHkgb2YgdGhlIGxpZ2h0XG4gIGhlbWlzcGhlcmVMaWdodCA9IG5ldyBUSFJFRS5IZW1pc3BoZXJlTGlnaHQoMHhlOGNhZjQsIDB4YmJlOGY3LCAwLjUpXG5cbiAgLy8gQSBkaXJlY3Rpb25hbCBsaWdodCBzaGluZXMgZnJvbSBhIHNwZWNpZmljIGRpcmVjdGlvbi5cbiAgLy8gSXQgYWN0cyBsaWtlIHRoZSBzdW4sIHRoYXQgbWVhbnMgdGhhdCBhbGwgdGhlIHJheXMgcHJvZHVjZWQgYXJlIHBhcmFsbGVsLlxuICBzaGFkb3dMaWdodCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KDB4ZmZmZmZmLCAwLjEpXG5cbiAgLy8gU2V0IHRoZSBkaXJlY3Rpb24gb2YgdGhlIGxpZ2h0XG4gIHNoYWRvd0xpZ2h0LnBvc2l0aW9uLnNldCgtMTUwLCBHUk9VTkRfRElBTUVURVIsIDE1MClcblxuICAvLyBBbGxvdyBzaGFkb3cgY2FzdGluZ1xuICBzaGFkb3dMaWdodC5jYXN0U2hhZG93ID0gdHJ1ZVxuXG4gIC8vIGRlZmluZSB0aGUgdmlzaWJsZSBhcmVhIG9mIHRoZSBwcm9qZWN0ZWQgc2hhZG93XG4gIHNoYWRvd0xpZ2h0LnNoYWRvdy5jYW1lcmEubGVmdCA9IC0xMDAwXG4gIHNoYWRvd0xpZ2h0LnNoYWRvdy5jYW1lcmEucmlnaHQgPSAxMDAwXG4gIHNoYWRvd0xpZ2h0LnNoYWRvdy5jYW1lcmEudG9wID0gMTAwMFxuICBzaGFkb3dMaWdodC5zaGFkb3cuY2FtZXJhLmJvdHRvbSA9IC01MDBcbiAgc2hhZG93TGlnaHQuc2hhZG93LmNhbWVyYS5uZWFyID0gLTEwMDBcbiAgc2hhZG93TGlnaHQuc2hhZG93LmNhbWVyYS5mYXIgPSAxMDAwXG4gIC8vIGRlYnVnIGxpZ2h0XG4gIC8vIHNjZW5lLmFkZChuZXcgVEhSRUUuQ2FtZXJhSGVscGVyKHNoYWRvd0xpZ2h0LnNoYWRvdy5jYW1lcmEpKVxuXG4gIC8vIGRlZmluZSB0aGUgcmVzb2x1dGlvbiBvZiB0aGUgc2hhZG93IHRoZSBoaWdoZXIgdGhlIGJldHRlcixcbiAgLy8gYnV0IGFsc28gdGhlIG1vcmUgZXhwZW5zaXZlIGFuZCBsZXNzIHBlcmZvcm1hbnRcbiAgc2hhZG93TGlnaHQuc2hhZG93Lm1hcFNpemUud2lkdGggPSAyMDQ4XG4gIHNoYWRvd0xpZ2h0LnNoYWRvdy5tYXBTaXplLmhlaWdodCA9IDIwNDhcblxuICAvLyBhbiBhbWJpZW50IGxpZ2h0IG1vZGlmaWVzIHRoZSBnbG9iYWwgY29sb3Igb2YgYSBzY2VuZSBhbmQgbWFrZXMgdGhlIHNoYWRvd3Mgc29mdGVyXG4gIGFtYmllbnRMaWdodCA9IG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHhlOGNhZjQsIDAuNylcbiAgLy8gYW1iaWVudExpZ2h0ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCgweGFhZThmNywgMSlcbiAgc2NlbmUuYWRkKGFtYmllbnRMaWdodClcblxuICAvLyB0byBhY3RpdmF0ZSB0aGUgbGlnaHRzLCBqdXN0IGFkZCB0aGVtIHRvIHRoZSBzY2VuZVxuICBzY2VuZS5hZGQoaGVtaXNwaGVyZUxpZ2h0KVxuICBzY2VuZS5hZGQoc2hhZG93TGlnaHQpXG59XG5cbi8vIEluc3RhbnRpYXRlIHRoZSBzZWEgYW5kIGFkZCBpdCB0byB0aGUgc2NlbmU6XG5mdW5jdGlvbiBjcmVhdGVTZWEgKCkge1xuICBzZWEgPSBuZXcgU2VhKEdST1VORF9ESUFNRVRFUilcblxuICAvLyBwdXNoIGl0IGEgbGl0dGxlIGJpdCBhdCB0aGUgYm90dG9tIG9mIHRoZSBzY2VuZVxuICAvLyBzZWEubWVzaC5wb3NpdGlvbi55ID0gLUdST1VORF9ESUFNRVRFUlxuICBzZWEubWVzaC5yb3RhdGlvbi56ID0gTWF0aC5QSSAvIDJcblxuICAvLyBhZGQgdGhlIG1lc2ggb2YgdGhlIHNlYSB0byB0aGUgc2NlbmVcbiAgcmV0dXJuIHNlYVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTa3kgKCkge1xuICBza3kgPSBuZXcgU2t5KEdST1VORF9ESUFNRVRFUilcbiAgLy8gc2t5Lm1lc2gucG9zaXRpb24ueSA9IC1HUk9VTkRfRElBTUVURVJcbiAgcmV0dXJuIHNreVxufVxuXG5mdW5jdGlvbiBjcmVhdGVQbGFuZSAoKSB7XG4gIGFpcnBsYW5lID0gbmV3IEFpclBsYW5lKClcbiAgYWlycGxhbmUubWVzaC5zY2FsZS5zZXQoMC4yNSwgMC4yNSwgMC4yNSlcbiAgYWlycGxhbmUubWVzaC5wb3NpdGlvbi55ID0gR1JPVU5EX0RJQU1FVEVSICsgcGxhbmVTdGFydFlcbiAgYWlycGxhbmUubWVzaC5wb3NpdGlvbi56ID0gcGxhbmVTdGFydFpcbiAgc2NlbmUuYWRkKGFpcnBsYW5lLm1lc2gpXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNvbnRyb2xsZXIgKGNvbnRyb2xsZXIsIGlkKSB7XG4gIGNvbnRyb2xsZXIudXBkYXRlKClcbiAgaWYgKGNvbnRyb2xsZXIudmlzaWJsZSkge1xuICAgIC8vIGhlcmUgd2UgYXJlIGNvbnZlcnRpbmcgdGhlIFZpdmUgY29udHJvbGxlciBwb3NpdGlvblxuICAgIC8vIHRvIGEgbm9ybWFsaXplZCB2YWx1ZSB2YXJ5aW5nIGJldHdlZW4gLTEgYW5kIDE7XG4gICAgLy8gdmFyIHR4ID0gY29udHJvbGxlci5yb3RhdGlvbi56XG4gICAgLy8gdmFyIHR5ID0gY29udHJvbGxlci5yb3RhdGlvbi54XG4gICAgdmFyIHR4ID0gY29udHJvbGxlci5wb3NpdGlvbi54IC8gMC41XG4gICAgdmFyIHR5ID0gY29udHJvbGxlci5wb3NpdGlvbi55IC8gMC41XG4gICAgbW91c2VQb3MgPSB7eDogdHgsIHk6IHR5LCBpc0ludGVyYWN0aXZlOiB0cnVlfVxuICB9XG59XG5cbmZ1bmN0aW9uIGxvb3AgKHQpIHtcbiAgaWYgKHZpdmVDb250cm9sbGVyKSB7XG4gICAgLy8gVVBEQVRFIENPTlRST0xMRVJcbiAgICB1cGRhdGVDb250cm9sbGVyKHZpdmVDb250cm9sbGVyLCAwKVxuICB9XG5cbiAgaWYgKGNvbnRyb2xzKSB7XG4gICAgY29udHJvbHMudXBkYXRlKGNsb2NrLmdldERlbHRhKCkpXG4gIH1cbiAgaWYgKHZyY29udHJvbHMpIHtcbiAgICB2cmNvbnRyb2xzLnVwZGF0ZShjbG9jay5nZXREZWx0YSgpKVxuICB9XG5cbiAgLy8gdXBkYXRlIHRoZSBwbGFuZSBvbiBlYWNoIGZyYW1lXG4gIHVwZGF0ZVBsYW5lKClcblxuICAvLyBtb3ZlIHdhdmVzXG4gIHNlYS5tb3ZlV2F2ZXMoKVxuXG4gIC8vIFJvdGF0ZSB3b3JsZCBhcm91bmQgWSBheGlzIC0gaW4gZGlyZWN0aW9uIChoZWFkaW5nKSB3ZSBhcmUgZmx5aW5nXG4gIGNvbnN0IHdvcmxkSGVhZGluZ01hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KClcbiAgd29ybGRIZWFkaW5nTWF0cml4Lm1ha2VSb3RhdGlvbkF4aXMobmV3IFRIUkVFLlZlY3RvcjMoMCwgMSwgMCksIHR1cm5TcGVlZClcblxuICAvLyBXb3JsZCBzcGVlZCByb3RhdGlvbiBtYXRyaXhcbiAgY29uc3Qgd29ybGRTcGVlZE1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KClcbiAgd29ybGRTcGVlZE1hdHJpeC5tYWtlUm90YXRpb25BeGlzKG5ldyBUSFJFRS5WZWN0b3IzKDEsIDAsIDApLCAwLjAwMilcblxuICAvLyBhcHBseSByb3RhdGlvbiBtYXRyaXhlcyB0byBjdXJyZW50IHdvcmxkIHJvYXRpb24gYW5kIHVwZGF0ZVxuICBjb25zdCBuZXdXb3JsZE1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KClcbiAgbmV3V29ybGRNYXRyaXgubXVsdGlwbHkod29ybGRIZWFkaW5nTWF0cml4KVxuICBuZXdXb3JsZE1hdHJpeC5tdWx0aXBseSh3b3JsZFNwZWVkTWF0cml4KVxuICBuZXdXb3JsZE1hdHJpeC5tdWx0aXBseSh3b3JsZC5tYXRyaXgpXG4gIHdvcmxkLm1hdHJpeCA9IG5ld1dvcmxkTWF0cml4XG4gIHdvcmxkLnJvdGF0aW9uLnNldEZyb21Sb3RhdGlvbk1hdHJpeCh3b3JsZC5tYXRyaXgpXG5cbiAgLy8gcG9zaXRpb24gY2FtZXJhIGluc2lkZSBjb2NrcGl0XG4gIC8vIGZvY3VzIGNhbWVyYSBvbiBhaXJwbGFuZSBpZiBub3QgaW4gVlIgbW9kZVxuICBpZiAobWFuYWdlci5tb2RlID09PSBNb2Rlcy5OT1JNQUwgfHwgbWFuYWdlci5tb2RlID09PSBNb2Rlcy5VTktOT1dOKSB7XG4gICAgLy8gY2FtZXJhIHBvc2l0aW9uIGlzIHNldCBieSBjb250cm9sbGVyIGhhbmRsZXJcbiAgICBkb2xseUNhbS5sb29rQXQoYWlycGxhbmUubWVzaC5wb3NpdGlvbilcbiAgLy8gQ2FyZGJvYXJkIG9yIFZSIG1vZGVcbiAgfSBlbHNlIHtcbiAgICBjb25zdCB7eCwgeSwgen0gPSBhaXJwbGFuZS5tZXNoLnBvc2l0aW9uXG4gICAgZG9sbHlDYW0ucG9zaXRpb24ueCA9IHhcbiAgICBkb2xseUNhbS5sb29rQXQoZG9sbHlDYW0ucG9zaXRpb24pXG4gICAgZG9sbHlDYW0ucG9zaXRpb24ueSA9IHkgKyAxMFxuICAgIGRvbGx5Q2FtLnBvc2l0aW9uLnogPSB6ICsgNVxuICB9XG5cbiAgLy8gcmVuZGVyIHRoZSBzY2VuZVxuICAvLyByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYSlcblxuICAvLyBSZW5kZXIgdGhlIHNjZW5lIHRocm91Z2ggdGhlIG1hbmFnZXIuXG4gIG1hbmFnZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEsIHQpXG5cbiAgLy8gY2FsbCB0aGUgbG9vcCBmdW5jdGlvbiBhZ2FpblxuICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApXG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVBsYW5lICgpIHtcbiAgY29uc3QgcGxhbmVBY2NlbGVyYXRpb24gPSAwLjAyNVxuICBjb25zdCBjYW1lcmFTcGVlZCA9IDAuMDIgLy8gbW92ZSBjYW1lcmEgc2xvd2VyIHRoYW4gYWx0aXR1ZGUgc28gd2Ugc2VlIHBsYW5lIGRpdmVcblxuICAvLyByb3RhdGUgcHJvcGVsbGVyXG4gIGFpcnBsYW5lLnByb3BlbGxlci5yb3RhdGlvbi54ICs9IDAuM1xuXG4gIC8vIGFib3J0IGZseWluZyBjb250cm9sbCBpZiBkcmFnZ2luZyBjYW1lcmFcbiAgaWYgKG1vdXNlRHJhZ2dpbmcpIHJldHVyblxuXG4gIGNvbnN0IE1BWF9QSVRDSCA9IE1hdGguUEkgLyAyXG4gIGNvbnN0IE1JTl9IRUlHSFQgPSBHUk9VTkRfRElBTUVURVIgKyAyMFxuICBjb25zdCBNQVhfSEVJR0hUID0gR1JPVU5EX0RJQU1FVEVSICsgODAwXG4gIGNvbnN0IE1BWF9ERUxUQSA9IE1BWF9IRUlHSFQgLSBNSU5fSEVJR0hUXG5cbiAgLy8gTW9kaWZ5IHRoZSBwbGFuZSBhbHRpdHVkZSBhdCBlYWNoIGZyYW1lIGJ5IGFkZGluZyBhIGZyYWN0aW9uIG9mIHRoZSByZW1haW5pbmcgZGlzdGFuY2VcbiAgY29uc3QgdGFyZ2V0WSA9IG5vcm1hbGl6ZShtb3VzZVBvcy55LCAtMC43NSwgMC43NSwgTUlOX0hFSUdIVCwgTUFYX0hFSUdIVCkgLy8gTUlOX0hFSUdIVCBzaG91bGQgYmUgaGlnaGVyIHRoYW4gd2F2ZXNcbiAgY29uc3QgeURlbHRhID0gdGFyZ2V0WSAtIGFpcnBsYW5lLm1lc2gucG9zaXRpb24ueVxuICBhaXJwbGFuZS5tZXNoLnBvc2l0aW9uLnkgKz0geURlbHRhICogcGxhbmVBY2NlbGVyYXRpb25cblxuICAvLyBQaXRjaCB0aGUgcGxhbmUgcHJvcG9ydGlvbmFsbHkgdG8gdGhlIHJlbWFpbmluZyBkaXN0YW5jZVxuICBjb25zdCBwaXRjaEFuZ2xlID0gTUFYX1BJVENIICogbm9ybWFsaXplKHlEZWx0YSwgLU1BWF9ERUxUQSAvIDIsIE1BWF9ERUxUQSAvIDIsIC0xLCAxKVxuICBhaXJwbGFuZS5tZXNoLnJvdGF0aW9uLnggKz0gKHBpdGNoQW5nbGUgLSBhaXJwbGFuZS5tZXNoLnJvdGF0aW9uLngpICogMC4wNVxuXG4gIC8vIFJvbGwgdG93YXJkcyB0YXJnZXRcbiAgY29uc3Qgcm9sbEFuZ2xlID0gbm9ybWFsaXplKG1vdXNlUG9zLngsIC0wLjc1LCAwLjc1LCBNYXRoLlBJIC8gNCwgLU1hdGguUEkgLyA0KVxuICBhaXJwbGFuZS5tZXNoLnJvdGF0aW9uLnogPSAocm9sbEFuZ2xlICsgYWlycGxhbmUubWVzaC5yb3RhdGlvbi56KSAqIDAuNVxuXG4gIC8vIE1vdmUgY2FtZXJhIHRvIGZvbGxvdyBwbGFuZVxuICBjb25zdCBjYW1lcmFZID0gbm9ybWFsaXplKG1vdXNlUG9zLnksIC0wLjc1LCAwLjc1LCBHUk9VTkRfRElBTUVURVIgKyA0MCwgR1JPVU5EX0RJQU1FVEVSICsgODUwKVxuXG4gIC8vIHpvb20gaW4gY2xvc2UgdG8gd2F0ZXIgLSB6b29tIG91dCBoaWdoIHVwIGluIGFpclxuICBjb25zdCBjYW1lcmFab29tID0gNTBcbiAgY29uc3QgY2FtZXJhWiA9IG5vcm1hbGl6ZShtb3VzZVBvcy55LCAtMC43NSwgMC43NSwgY2FtZXJhU3RhcnRaIC0gY2FtZXJhWm9vbSwgY2FtZXJhU3RhcnRaICsgY2FtZXJhWm9vbSlcblxuICBpZiAobW91c2VQb3MuaXNJbnRlcmFjdGl2ZSkge1xuICAgIGRvbGx5Q2FtLnBvc2l0aW9uLnkgKz0gKGNhbWVyYVkgLSBkb2xseUNhbS5wb3NpdGlvbi55KSAqIGNhbWVyYVNwZWVkXG4gICAgZG9sbHlDYW0ucG9zaXRpb24ueiArPSAoY2FtZXJhWiAtIGRvbGx5Q2FtLnBvc2l0aW9uLnopICogY2FtZXJhU3BlZWRcbiAgfVxuXG4gIC8vIGhvdyBmYXN0IGFyZSB3ZSBjaGFuZ2luZyBjb21wYXNzIGhlYWRpbmdcbiAgdHVyblNwZWVkID0gcm9sbEFuZ2xlICogcGxhbmVBY2NlbGVyYXRpb24gKiAtMVxuXG4gIC8vIGtlZXAgdHJhY2sgb2YgY3VycmVudCBjb21wYXNzIGhlYWRpbmdcbiAgY29tcGFzc0hlYWRpbmcgKz0gdHVyblNwZWVkXG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZSAodiwgdm1pbiwgdm1heCwgdG1pbiwgdG1heCkge1xuICB2YXIgbnYgPSBNYXRoLm1heChNYXRoLm1pbih2LCB2bWF4KSwgdm1pbilcbiAgdmFyIGR2ID0gdm1heCAtIHZtaW5cbiAgdmFyIHBjID0gKG52IC0gdm1pbikgLyBkdlxuICB2YXIgZHQgPSB0bWF4IC0gdG1pblxuICB2YXIgdHYgPSB0bWluICsgKHBjICogZHQpXG4gIHJldHVybiB0dlxufVxuXG5sZXQgbW91c2VQb3MgPSB7eDogMCwgeTogMCwgaXNJbnRlcmFjdGl2ZTogZmFsc2V9XG4vLyBub3cgaGFuZGxlIHRoZSBtb3VzZW1vdmUgZXZlbnRcbmZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZSAoZXZlbnQpIHtcbiAgLy8gaGVyZSB3ZSBhcmUgY29udmVydGluZyB0aGUgbW91c2UgcG9zaXRpb24gdmFsdWUgcmVjZWl2ZWRcbiAgLy8gdG8gYSBub3JtYWxpemVkIHZhbHVlIHZhcnlpbmcgYmV0d2VlbiAtMSBhbmQgMTtcbiAgLy8gdGhpcyBpcyB0aGUgZm9ybXVsYSBmb3IgdGhlIGhvcml6b250YWwgYXhpczpcbiAgdmFyIHR4ID0gLTEgKyAoZXZlbnQuY2xpZW50WCAvIFdJRFRIKSAqIDJcblxuICAvLyBmb3IgdGhlIHZlcnRpY2FsIGF4aXMsIHdlIG5lZWQgdG8gaW52ZXJzZSB0aGUgZm9ybXVsYVxuICAvLyBiZWNhdXNlIHRoZSAyRCB5LWF4aXMgZ29lcyB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uIG9mIHRoZSAzRCB5LWF4aXNcbiAgdmFyIHR5ID0gMSAtIChldmVudC5jbGllbnRZIC8gSEVJR0hUKSAqIDJcbiAgbW91c2VQb3MgPSB7eDogdHgsIHk6IHR5LCBpc0ludGVyYWN0aXZlOiB0cnVlfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVNb3VzZURvd24gKCkge1xuICBtb3VzZURyYWdnaW5nID0gdHJ1ZVxufVxuXG5mdW5jdGlvbiBoYW5kbGVNb3VzZVVwICgpIHtcbiAgbW91c2VEcmFnZ2luZyA9IGZhbHNlXG59XG5cbmZ1bmN0aW9uIGluaXQgKCkge1xuICAvLyBzZXQgdXAgdGhlIHNjZW5lLCB0aGUgY2FtZXJhIGFuZCB0aGUgcmVuZGVyZXJcbiAgY3JlYXRlU2NlbmUoKVxuXG4gIC8vIGFkZCB0aGUgbGlnaHRzXG4gIGNyZWF0ZUxpZ2h0cygpXG5cbiAgLy8gYWRkIHRoZSBvYmplY3RzXG4gIGNyZWF0ZVBsYW5lKClcbiAgY3JlYXRlU2VhKClcbiAgY3JlYXRlU2t5KClcblxuICAvLyB3b3JsZFxuICB3b3JsZCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpXG4gIHdvcmxkLmFkZChza3kubWVzaClcbiAgd29ybGQuYWRkKHNlYS5tZXNoKVxuICBzY2VuZS5hZGQod29ybGQpXG5cbiAgLy8gLy8gQXBwbHkgVlIgaGVhZHNldCBwb3NpdGlvbmFsIGRhdGEgdG8gY2FtZXJhLlxuICB2cmNvbnRyb2xzID0gbmV3IFRIUkVFLlZSQ29udHJvbHMoY2FtZXJhKVxuXG4gIC8vIEFwcGx5IFZSIHN0ZXJlbyByZW5kZXJpbmcgdG8gcmVuZGVyZXIuXG4gIGVmZmVjdCA9IG5ldyBUSFJFRS5WUkVmZmVjdChyZW5kZXJlcilcbiAgZWZmZWN0LnNldFNpemUod2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodClcblxuICAvLyBDcmVhdGUgYSBWUiBtYW5hZ2VyIGhlbHBlciB0byBlbnRlciBhbmQgZXhpdCBWUiBtb2RlLlxuICB2YXIgcGFyYW1zID0ge1xuICAgIGhpZGVCdXR0b246IGZhbHNlLCAvLyBEZWZhdWx0OiBmYWxzZS5cbiAgICBpc1VuZGlzdG9ydGVkOiBmYWxzZSAvLyBEZWZhdWx0OiBmYWxzZS5cbiAgfVxuICBtYW5hZ2VyID0gbmV3IFdlYlZSTWFuYWdlcihyZW5kZXJlciwgZWZmZWN0LCBwYXJhbXMpXG5cbiAgLy8gVGhlIGRvbGx5IGhhcyB0byBiZSBhIFBlcnNwZWN0aXZlQ2FtZXJhLCBhcyBvcHBvc2VkXG4gIC8vIHRvIGEgc2ltcGxlIE9iamVjdDNELCBzaW5jZSB0aGF0J3Mgd2hhdFxuICAvLyBPcmJpdENvbnRyb2xzIGV4cGVjdHMuXG4gIGRvbGx5Q2FtID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKClcbiAgZG9sbHlDYW0ucG9zaXRpb24ueSA9IEdST1VORF9ESUFNRVRFUiArIHBsYW5lU3RhcnRZICogMlxuICBkb2xseUNhbS5wb3NpdGlvbi56ID0gY2FtZXJhU3RhcnRaXG4gIGRvbGx5Q2FtLmFkZChjYW1lcmEpXG4gIHNjZW5lLmFkZChkb2xseUNhbSlcblxuICAvLyBWSVZFIENPTlRST0xMRVJcbiAgaWYgKG5hdmlnYXRvci5nZXRHYW1lcGFkcykge1xuICAgIHZpdmVDb250cm9sbGVyID0gbmV3IFRIUkVFLlZpdmVDb250cm9sbGVyKDApXG4gICAgdml2ZUNvbnRyb2xsZXIuc3RhbmRpbmdNYXRyaXggPSB2cmNvbnRyb2xzLmdldFN0YW5kaW5nTWF0cml4KClcbiAgICBzY2VuZS5hZGQodml2ZUNvbnRyb2xsZXIpXG4gIH1cblxuICAvLyBzdGFydCBhIGxvb3AgdGhhdCB3aWxsIHVwZGF0ZSB0aGUgb2JqZWN0cycgcG9zaXRpb25zXG4gIC8vIGFuZCByZW5kZXIgdGhlIHNjZW5lIG9uIGVhY2ggZnJhbWVcbiAgbG9vcCgpXG5cbiAgLy9hZGQgdGhlIGxpc3RlbmVyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGhhbmRsZU1vdXNlTW92ZSwgZmFsc2UpXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZU1vdXNlRG93biwgZmFsc2UpXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBoYW5kbGVNb3VzZVVwLCBmYWxzZSlcbn1cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBpbml0LCBmYWxzZSlcbiIsImltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJ1xuaW1wb3J0IENvbG9ycyBmcm9tICcuL2NvbG9ycydcblxuY2xhc3MgU2VhIHtcbiAgY29uc3RydWN0b3IgKEdST1VORF9ESUFNRVRFUikge1xuICAgIGNvbnN0IGdlb20gPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoR1JPVU5EX0RJQU1FVEVSLCA1MCwgNTApXG5cbiAgICAvLyBpbXBvcnRhbnQ6IGJ5IG1lcmdpbmcgdmVydGljZXMgd2UgZW5zdXJlIHRoZSBjb250aW51aXR5IG9mIHRoZSB3YXZlc1xuICAgIGdlb20ubWVyZ2VWZXJ0aWNlcygpXG5cbiAgICBjb25zdCBsID0gZ2VvbS52ZXJ0aWNlcy5sZW5ndGhcbiAgICB0aGlzLndhdmVzID0gW11cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XG4gICAgICBjb25zdCB2ID0gZ2VvbS52ZXJ0aWNlc1tpXVxuXG4gICAgICAvLyBzdG9yZSBzb21lIGRhdGEgYXNzb2NpYXRlZCB0byBpdFxuICAgICAgdGhpcy53YXZlcy5wdXNoKHt5OiB2LnksXG4gICAgICAgICAgICAgICAgICAgICAgIHg6IHYueCxcbiAgICAgICAgICAgICAgICAgICAgICAgejogdi56LFxuICAgICAgICAgICAgICAgICAgICAgICAvLyBhIHJhbmRvbSBhbmdsZVxuICAgICAgICAgICAgICAgICAgICAgICBhbmc6IE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJICogMixcbiAgICAgICAgICAgICAgICAgICAgICAgLy8gYSByYW5kb20gZGlzdGFuY2VcbiAgICAgICAgICAgICAgICAgICAgICAgYW1wOiA1ICsgTWF0aC5yYW5kb20oKSAqIDI1LFxuICAgICAgICAgICAgICAgICAgICAgICAvLyBhIHJhbmRvbSBzcGVlZCBiZXR3ZWVuIDAuMDE2IGFuZCAwLjA0OCByYWRpYW5zIC8gZnJhbWVcbiAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IDAuMDE2ICsgTWF0aC5yYW5kb20oKSAqIDAuMDMyXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IG1hdCA9IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCh7XG4gICAgICBjb2xvcjogQ29sb3JzLndhdGVyLFxuICAgICAgdHJhbnNwYXJlbnQ6IHRydWUsXG4gICAgICBvcGFjaXR5OiAxLFxuICAgICAgc2hhZGluZzogVEhSRUUuRmxhdFNoYWRpbmcsXG4gICAgICB3aXJlZnJhbWU6IGZhbHNlXG4gICAgfSlcblxuICAgIHRoaXMubWVzaCA9IG5ldyBUSFJFRS5NZXNoKGdlb20sIG1hdClcblxuICAgIC8vIEFsbG93IHRoZSBzZWEgdG8gcmVjZWl2ZSBzaGFkb3dzXG4gICAgdGhpcy5tZXNoLnJlY2VpdmVTaGFkb3cgPSB0cnVlXG4gIH1cblxuICBtb3ZlV2F2ZXMgKCkge1xuICAgIGNvbnN0IHZlcnRzID0gdGhpcy5tZXNoLmdlb21ldHJ5LnZlcnRpY2VzXG4gICAgY29uc3QgbCA9IHZlcnRzLmxlbmd0aFxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgIGNvbnN0IHYgPSB2ZXJ0c1tpXVxuICAgICAgY29uc3Qgd2F2ZSA9IHRoaXMud2F2ZXNbaV1cblxuICAgICAgLy8gdXBkYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgdmVydGV4XG4gICAgICB2LnggPSB3YXZlLnggKyBNYXRoLmNvcyh3YXZlLmFuZykgKiB3YXZlLmFtcFxuICAgICAgdi55ID0gd2F2ZS55ICsgTWF0aC5zaW4od2F2ZS5hbmcpICogd2F2ZS5hbXBcblxuICAgICAgLy8gaW5jcmVtZW50IHRoZSBhbmdsZSBmb3IgdGhlIG5leHQgZnJhbWVcbiAgICAgIHdhdmUuYW5nICs9IHdhdmUuc3BlZWRcbiAgICB9XG5cbiAgICAvLyBUZWxsIHRoZSByZW5kZXJlciB0aGF0IHRoZSBnZW9tZXRyeSBvZiB0aGUgc2VhIGhhcyBjaGFuZ2VkLlxuICAgIC8vIEluIGZhY3QsIGluIG9yZGVyIHRvIG1haW50YWluIHRoZSBiZXN0IGxldmVsIG9mIHBlcmZvcm1hbmNlLFxuICAgIC8vIHRocmVlLmpzIGNhY2hlcyB0aGUgZ2VvbWV0cmllcyBhbmQgaWdub3JlcyBhbnkgY2hhbmdlc1xuICAgIC8vIHVubGVzcyB3ZSBhZGQgdGhpcyBsaW5lXG4gICAgdGhpcy5tZXNoLmdlb21ldHJ5LnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWVcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWFcbiIsImltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJ1xuaW1wb3J0IENsb3VkIGZyb20gJy4vY2xvdWQnXG5cbmNsYXNzIFNreSB7XG4gIGNvbnN0cnVjdG9yIChHUk9VTkRfRElBTUVURVIpIHtcbiAgICAvLyBDcmVhdGUgYW4gZW1wdHkgY29udGFpbmVyXG4gICAgdGhpcy5tZXNoID0gbmV3IFRIUkVFLk9iamVjdDNEKClcblxuICAgIC8vIGNob29zZSBhIG51bWJlciBvZiBjbG91ZHMgdG8gYmUgc2NhdHRlcmVkIGluIHRoZSBza3lcbiAgICB0aGlzLm5DbG91ZHMgPSAyMDBcblxuICAgIC8vIFRvIGRpc3RyaWJ1dGUgdGhlIGNsb3VkcyBjb25zaXN0ZW50bHksXG4gICAgLy8gd2UgbmVlZCB0byBwbGFjZSB0aGVtIGFjY29yZGluZyB0byBhIHVuaWZvcm0gYW5nbGVcbiAgICB2YXIgc3RlcEFuZ2xlID0gTWF0aC5QSSAqIDIgLyB0aGlzLm5DbG91ZHNcblxuICAgIC8vIGNyZWF0ZSB0aGUgY2xvdWRzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm5DbG91ZHM7IGkrKykge1xuICAgICAgY29uc3QgYyA9IG5ldyBDbG91ZCgpXG5cbiAgICAgIC8vIEdldCByYW5kb20gYWx0aXR1ZGUgb2YgY2xvdWQgLSByYWRpdXMgaXMgdGhlIGRpc3RhbmNlIGZyb20gdGhlIGNlbnRlciBvZiB0aGUgd29ybGRcbiAgICAgIGNvbnN0IHJhZGl1cyA9IEdST1VORF9ESUFNRVRFUiArIDE1MCArIE1hdGgucmFuZG9tKCkgKiAzMDBcblxuICAgICAgLy8gU3RlcCB0aHJvdWdoIHRoZSBQb2xhciBhbmdsZSBUaGV0YSBhcm91bmQgWC1heGlzIHRvIHNwcmVhZCBjbG91ZHMgZXZlbmx5XG4gICAgICBjb25zdCB0aGV0YSA9IHN0ZXBBbmdsZSAqIGlcblxuICAgICAgLy8gUmFuZG9tIGF6aW11dGhhbCBhbmdsZSBQaGkgYXJvdW5kIFotYXhpcyB0byBzcHJlYWQgY2xvdWRzIGFjcm9zcyBhbGwgb2YgdGhlIHNwaGVyZVxuICAgICAgY29uc3QgcGhpID0gTWF0aC5yYW5kb20oKSAqIE1hdGguUEkgKiAyXG5cbiAgICAgIC8vIGdlbmVyYXRlIHJhbmRvbSBhbmdsZSBvZiBjbG91ZCBmYWNpbmcgYWlycGxhbmVcbiAgICAgIGNvbnN0IHJvdFkgPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDJcblxuICAgICAgLy8gUm90YXRlIGFuZCB0cmFuc2xhdGUgdG8gZGVzaXJlZCBoZWlnaHQgYWJvdmUgc3BoZXJlIHN1cmZhY2VcbiAgICAgIGNvbnN0IGNsb3VkTWF0cml4ID0gYy5tZXNoLm1hdHJpeC5jbG9uZSgpXG5cbiAgICAgIGNvbnN0IHJvdGF0ZU1hdHJpeFggPSBuZXcgVEhSRUUuTWF0cml4NCgpXG4gICAgICByb3RhdGVNYXRyaXhYLm1ha2VSb3RhdGlvblgodGhldGEpXG5cbiAgICAgIGNvbnN0IHJvdGF0ZU1hdHJpeFogPSBuZXcgVEhSRUUuTWF0cml4NCgpXG4gICAgICByb3RhdGVNYXRyaXhaLm1ha2VSb3RhdGlvbloocGhpKVxuXG4gICAgICBjb25zdCByb3RhdGVNYXRyaXhZID0gbmV3IFRIUkVFLk1hdHJpeDQoKVxuICAgICAgcm90YXRlTWF0cml4WS5tYWtlUm90YXRpb25ZKHJvdFkpXG5cbiAgICAgIGNvbnN0IHRyYW5zbGF0ZU1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KClcbiAgICAgIHRyYW5zbGF0ZU1hdHJpeC5tYWtlVHJhbnNsYXRpb24oMCwgcmFkaXVzLCAwKVxuXG4gICAgICBjbG91ZE1hdHJpeC5tdWx0aXBseShyb3RhdGVNYXRyaXhYKVxuICAgICAgY2xvdWRNYXRyaXgubXVsdGlwbHkocm90YXRlTWF0cml4WilcbiAgICAgIGNsb3VkTWF0cml4Lm11bHRpcGx5KHRyYW5zbGF0ZU1hdHJpeClcbiAgICAgIGNsb3VkTWF0cml4Lm11bHRpcGx5KHJvdGF0ZU1hdHJpeFkpXG4gICAgICBjLm1lc2guYXBwbHlNYXRyaXgoY2xvdWRNYXRyaXgpXG5cbiAgICAgIC8vIHdlIGFsc28gc2V0IGEgcmFuZG9tIHNjYWxlIGZvciBlYWNoIGNsb3VkXG4gICAgICBjb25zdCBzID0gMSArIE1hdGgucmFuZG9tKCkgKiAyXG4gICAgICBjLm1lc2guc2NhbGUuc2V0KHMsIHMsIHMpXG5cbiAgICAgIC8vIGRvIG5vdCBmb3JnZXQgdG8gYWRkIHRoZSBtZXNoIG9mIGVhY2ggY2xvdWQgaW4gdGhlIHNjZW5lXG4gICAgICB0aGlzLm1lc2guYWRkKGMubWVzaClcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2t5XG4iXX0=
